<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" charset="utf-8">
    <title>Waigo - next-gen web framework</title><!--[if IE]><link rel="shortcut icon" href="img/logo_32x32.ico" /><![endif]-->
    <link rel="shortcut icon" href="/img/logo_114x114.png">
    <meta name="msapplication-TileColor" content="#fff">
    <meta name="msapplication-TileImage" content="/img/logo_144x144.png">
    <link rel="stylesheet" media="screen" href="/style.css">
  </head>
  <body>
    <header id="top">
      <nav role="banner" class="navbar navbar-fixed-top">
        <div class="navbar-header">
          <button type="button" data-toggle="collapse" data-target="#topmenu-navbar-collapse" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Waigo</a>
        </div>
        <div id="topmenu-navbar-collapse" role="navigation" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/guide.html">Guide</a></li>
            <li class="active"><a href="/api">API</a></li>
            <li><a href="/examples/index.html">Examples</a></li>
            <li><a href="/sites.html">Sites</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/waigo/waigo">Github</a></li>
          </ul>
        </div>
      </nav>
    </header>
    <main id="content">
      <div id="api">
        <div class="container">
          <div class="row">
            <div role="complementary" class="col-md-3 waigo-api-index">
              <ul class="nav hidden-sm hidden-xs">
                <li><a href="../../index.html">Main</a></li>
                <li><a href="../../application.js.html">application.js</a></li>
                <li><a href="../../cli/init.js.html">cli/init.js</a></li>
                <li><a href="../../config/base.js.html">config/base.js</a></li>
                <li><a href="../../config/development.js.html">config/development.js</a></li>
                <li><a href="../../config/index.js.html">config/index.js</a></li>
                <li><a href="../../loader.js.html">loader.js</a></li>
                <li><a href="../../routes.js.html">routes.js</a></li>
                <li><a href="../../support/cliCommand.js.html">support/cliCommand.js</a></li>
                <li><a href="../../support/errors.js.html">support/errors.js</a></li>
                <li><a href="../../support/forms/field.js.html">support/forms/field.js</a></li>
                <li><a href="../../support/forms/fields/select.js.html">support/forms/fields/select.js</a></li>
                <li><a href="../../support/forms/fields/text.js.html">support/forms/fields/text.js</a></li>
                <li class="active"><a href="../../support/forms/form.js.html">support/forms/form.js</a></li>
                <li><a href="../../support/forms/sanitizers/trim.js.html">support/forms/sanitizers/trim.js</a></li>
                <li><a href="../../support/forms/validators/isEmailAddress.js.html">support/forms/validators/isEmailAddress.js</a></li>
                <li><a href="../../support/forms/validators/notEmpty.js.html">support/forms/validators/notEmpty.js</a></li>
                <li><a href="../../support/logging/winston.js.html">support/logging/winston.js</a></li>
                <li><a href="../../support/middleware/bodyParser.js.html">support/middleware/bodyParser.js</a></li>
                <li><a href="../../support/middleware/errorHandler.js.html">support/middleware/errorHandler.js</a></li>
                <li><a href="../../support/middleware/outputFormats.js.html">support/middleware/outputFormats.js</a></li>
                <li><a href="../../support/middleware/sessions.js.html">support/middleware/sessions.js</a></li>
                <li><a href="../../support/middleware/staticResources.js.html">support/middleware/staticResources.js</a></li>
                <li><a href="../../support/mixins.js.html">support/mixins.js</a></li>
                <li><a href="../../support/outputFormats/html.js.html">support/outputFormats/html.js</a></li>
                <li><a href="../../support/outputFormats/json.js.html">support/outputFormats/json.js</a></li>
                <li><a href="../../support/routeMapper.js.html">support/routeMapper.js</a></li>
                <li><a href="../../support/session/store/cookie.js.html">support/session/store/cookie.js</a></li>
                <li><a href="../../support/shutdown/listener.js.html">support/shutdown/listener.js</a></li>
                <li><a href="../../support/startup/database.js.html">support/startup/database.js</a></li>
                <li><a href="../../support/startup/listener.js.html">support/startup/listener.js</a></li>
                <li><a href="../../support/startup/logging.js.html">support/startup/logging.js</a></li>
                <li><a href="../../support/startup/middleware.js.html">support/startup/middleware.js</a></li>
                <li><a href="../../support/startup/routes.js.html">support/startup/routes.js</a></li>
                <li><a href="../../support/underscore.js.html">support/underscore.js</a></li>
              </ul>
              <div class="visible-sm visible-xs">
                <button type="button" data-toggle="collapse" data-target="#api-index-xs" class="btn btn-info">Show/hide API index</button>
                <div id="api-index-xs" class="collapse">
                  <ul class="nav">
                    <li><a href="../../index.html">Main</a></li>
                    <li><a href="../../application.js.html">application.js</a></li>
                    <li><a href="../../cli/init.js.html">cli/init.js</a></li>
                    <li><a href="../../config/base.js.html">config/base.js</a></li>
                    <li><a href="../../config/development.js.html">config/development.js</a></li>
                    <li><a href="../../config/index.js.html">config/index.js</a></li>
                    <li><a href="../../loader.js.html">loader.js</a></li>
                    <li><a href="../../routes.js.html">routes.js</a></li>
                    <li><a href="../../support/cliCommand.js.html">support/cliCommand.js</a></li>
                    <li><a href="../../support/errors.js.html">support/errors.js</a></li>
                    <li><a href="../../support/forms/field.js.html">support/forms/field.js</a></li>
                    <li><a href="../../support/forms/fields/select.js.html">support/forms/fields/select.js</a></li>
                    <li><a href="../../support/forms/fields/text.js.html">support/forms/fields/text.js</a></li>
                    <li class="active"><a href="../../support/forms/form.js.html">support/forms/form.js</a></li>
                    <li><a href="../../support/forms/sanitizers/trim.js.html">support/forms/sanitizers/trim.js</a></li>
                    <li><a href="../../support/forms/validators/isEmailAddress.js.html">support/forms/validators/isEmailAddress.js</a></li>
                    <li><a href="../../support/forms/validators/notEmpty.js.html">support/forms/validators/notEmpty.js</a></li>
                    <li><a href="../../support/logging/winston.js.html">support/logging/winston.js</a></li>
                    <li><a href="../../support/middleware/bodyParser.js.html">support/middleware/bodyParser.js</a></li>
                    <li><a href="../../support/middleware/errorHandler.js.html">support/middleware/errorHandler.js</a></li>
                    <li><a href="../../support/middleware/outputFormats.js.html">support/middleware/outputFormats.js</a></li>
                    <li><a href="../../support/middleware/sessions.js.html">support/middleware/sessions.js</a></li>
                    <li><a href="../../support/middleware/staticResources.js.html">support/middleware/staticResources.js</a></li>
                    <li><a href="../../support/mixins.js.html">support/mixins.js</a></li>
                    <li><a href="../../support/outputFormats/html.js.html">support/outputFormats/html.js</a></li>
                    <li><a href="../../support/outputFormats/json.js.html">support/outputFormats/json.js</a></li>
                    <li><a href="../../support/routeMapper.js.html">support/routeMapper.js</a></li>
                    <li><a href="../../support/session/store/cookie.js.html">support/session/store/cookie.js</a></li>
                    <li><a href="../../support/shutdown/listener.js.html">support/shutdown/listener.js</a></li>
                    <li><a href="../../support/startup/database.js.html">support/startup/database.js</a></li>
                    <li><a href="../../support/startup/listener.js.html">support/startup/listener.js</a></li>
                    <li><a href="../../support/startup/logging.js.html">support/startup/logging.js</a></li>
                    <li><a href="../../support/startup/middleware.js.html">support/startup/middleware.js</a></li>
                    <li><a href="../../support/startup/routes.js.html">support/startup/routes.js</a></li>
                    <li><a href="../../support/underscore.js.html">support/underscore.js</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div role="main" class="col-md-7 waigo-api-content">
              <section id="FormValidationError">
                <h1>FormValidationError</h1>
                <div class="description"><p>Form validation error.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-success radius ctx-type">declaration</div>
                </p>
              </section>
              <pre><code class="language-javascript">var FormValidationError = exports.FormValidationError = errors.define('FormValidationError', errors.MultipleError);</code></pre>
              <section id="toViewObject">
                <h1>toViewObject</h1>
                <div class="description"><p>Get view object representation of form validation error.</p><p>This checks the <code>leanErrors</code> request flag. If set then the<br />resulting view object will be simpler to analyse and iterate over.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <pre><code class="language-javascript">FormValidationError.prototype.toViewObject = function*(ctx) {
  if (!_.get(ctx, 'request.leanErrors')) {
    return yield errors.MultipleError.prototype.toViewObject.call(this, ctx);
  } else {
    var ret = yield errors.RuntimeError.prototype.toViewObject.call(this, ctx);
    ret.fields = {};

    for (let id in this.errors) {
      let fieldErrors = (yield this.errors[id].toViewObject(ctx)).errors;

      ret.fields[id] = [];

      for (let feId in fieldErrors) {
        ret.fields[id].push(fieldErrors[feId].msg)
      }
    }

    return ret;
  }
};</code></pre>
              <section id="Form">
                <h1>Form</h1>
                <div class="description"><p>Construct a form.</p><p>Form field values get stored in an internal state object which can be retrieved<br />and set at any time, thus allowing you to share state between <code>Form</code> instances<br />as well as quickly restore a <code>Form</code> to a previously set state.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-success radius ctx-type">declaration</div>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">ctx</td>
                    <td class="type">Object</td>
                    <td class="description">Current request context.</td>
                  </tr>
                  <tr>
                    <td class="name">config</td>
                    <td class="type">Object,Form</td>
                    <td class="description">form configuration or an existing `Form` instance.</td>
                  </tr>
                  <tr>
                    <td class="name">[state]</td>
                    <td class="type">Object</td>
                    <td class="description">The internal state to set for this form.</td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">var Form = exports.Form = function(config, state) {
  if (config instanceof Form) {
    // passed-in state overrides existing form's state
    state = state || config.state;  
    config = config.config;
  }

  this.config = config;

  this._fields = {};
  for (let idx in this.config.fields) {
    let def = this.config.fields[idx];
    this._fields[def.name] = Field.new(this, def);
  }

  this.state = _.extend({}, state);
};
mixins.applyTo(Form, mixins.HasViewObject);




Object.defineProperty(Form.prototype, 'fields', {
  get: function() {
    return this._fields;
  }
});




Object.defineProperty(Form.prototype, 'state', {
  get: function() {
    return this._state;
  },
  set: function(state) {
    this._state = state || {};

    for (let fieldName in this.fields) {
      this._state[fieldName] = this._state[fieldName] || {
        value: null
      };
    }
  }
});</code></pre>
              <section id="setValues">
                <h1>setValues</h1>
                <div class="description"><p>Set values.</p><p>This will sanitize each value prior to setting it.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">values</td>
                    <td class="type">Object</td>
                    <td class="description">Mapping from field name to field value.</td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">Form.prototype.setValues = function*(values) {
  values = values || {};

  for (let fieldName in this.fields) {
    yield this.fields[fieldName].setSanitizedValue(values[fieldName]);
  }
};</code></pre>
              <section id="setOriginalValues">
                <h1>setOriginalValues</h1>
                <div class="description"><p>Set original values.</p><p><em>Note: unlike when setting the current field values these values do not<br />get sanitized</em></p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">values</td>
                    <td class="type">Object</td>
                    <td class="description">Mapping from field name to field original value.</td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">Form.prototype.setOriginalValues = function*(values) {
  values = values || {};

  for (let fieldName in this.fields) {
    this.fields[fieldName].originalValue = values[fieldName];
  }
};</code></pre>
              <section id="isDirty">
                <h1>isDirty</h1>
                <div class="description"><p>Get whether this form is dirty.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div><span class="symbolReturns">-> Boolean</span>
                </p>
              </section>
              <pre><code class="language-javascript">Form.prototype.isDirty = function() {
  for (let fieldName in this.fields) {
    if (this.fields[fieldName].isDirty()) {
      return true;
    }
  }

  return false;
};</code></pre>
              <section id="validate">
                <h1>validate</h1>
                <div class="description"><p>Validate the contents of this form.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <pre><code class="language-javascript">Form.prototype.validate = function*() {
  var fields = this.fields,
    errors = null;

  for (let fieldName in fields) {
    let field = fields[fieldName];

    try {
      yield field.validate();
    } catch (err) {
      if (!errors) {
        errors = {};
      }

      errors[fieldName] = err;
    }
  }

  if (errors) {
    throw new FormValidationError('Form validation failed', 400, errors);
  }
};</code></pre>
              <section id="toViewObject">
                <h1>toViewObject</h1>
                <div class="description"><p>Get renderable representation of this form.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div><span class="symbolReturns">-> Object</span>
                </p>
              </section>
              <pre><code class="language-javascript">Form.prototype.toViewObject = function*(ctx) {
  var fields = this.fields,
    fieldViewObjects = {},
    fieldOrder = [];

  for (let idx in this.config.fields) {
    let def = this.config.fields[idx],
      field = fields[def.name];
      
    fieldViewObjects[def.name] = yield field.toViewObject(ctx);
    fieldOrder.push(def.name);
  }

  var ret = {
    fields: fieldViewObjects,
    order: fieldOrder
  }

  if (this.config.id) {
    ret.id = this.config.id
  }

  return ret;
};



// the form spec cache
var cache = {};</code></pre>
              <section id="new">
                <h1>new</h1>
                <div class="description"><p>Create an instance of the given form.</p><p>Although you can create and use <code>Form</code> objects directly it is better to use<br />this static method as it handles the loading of form configuration from<br />the <code>forms</code> module file path.</p><p>An optional initial internal state can also be provided. This is useful to<br />e.g. restore the from and its fields to a previous state. If not provided<br />then the form will be set to the default internal state of a newly<br />constructed instance.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div><span class="symbolReturns">-> Form</span>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">id</td>
                    <td class="type">String</td>
                    <td class="description">The id of the form to load.</td>
                  </tr>
                  <tr>
                    <td class="name">[state]</td>
                    <td class="type">Object</td>
                    <td class="description">The internal state to set for this form. </td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">Form.new = function(id, state) {
  var cachedSpec = cache[id];

  if (!cachedSpec) {
    cache[id]  = cachedSpec = waigo.load('forms/' + id);
    cachedSpec.id = id;
  }

  return new Form(cachedSpec, state);
};</code></pre>
            </div>
            <div class="col-md-2">
              <div role="complementary" class="waigo-content-menu hidden-print">
                <ul class="nav">
                  <li><a href="#FormValidationError"><span>FormValidationError</span></a></li>
                  <li><a href="#toViewObject"><span>toViewObject()</span></a></li>
                  <li><a href="#Form"><span>Form</span></a></li>
                  <li><a href="#setValues"><span>setValues()</span></a></li>
                  <li><a href="#setOriginalValues"><span>setOriginalValues()</span></a></li>
                  <li><a href="#isDirty"><span>isDirty()</span></a></li>
                  <li><a href="#validate"><span>validate()</span></a></li>
                  <li><a href="#toViewObject"><span>toViewObject()</span></a></li>
                  <li><a href="#new"><span>new()</span></a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer role="contentinfo">
      <div><p>Waigo &copy; <a href="https://github.com/hiddentao">Ramesh Nair</a>. Page <a href="https://github.com/waigo/waigo.github.io">generated</a> on Thu, 31 Jul 2014 08:15:25 GMT</p>

      </div>
    </footer>
    <script type="text/javascript" src="/scripts.js"></script>
    <script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(["setDomains", ["*.waigojs.com","*.waigo.github.io"]]);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.hiddentao.com/";
        _paq.push(["setTrackerUrl", u+"piwik.php"]);
        _paq.push(["setSiteId", "3"]);
        var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
        g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
      })();
      
    </script>
  </body>
</html>