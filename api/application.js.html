<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" charset="utf-8">
    <title>Waigo - next-gen web framework</title><!--[if IE]><link rel="shortcut icon" href="img/logo_32x32.ico" /><![endif]-->
    <link rel="shortcut icon" href="/img/logo_114x114.png">
    <meta name="msapplication-TileColor" content="#fff">
    <meta name="msapplication-TileImage" content="/img/logo_144x144.png">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" media="screen" href="/style.css">
  </head>
  <body>
    <header id="top" class="clearfix">
      <nav role="banner" class="navbar navbar-fixed-top">
        <div class="navbar-header">
          <button type="button" data-toggle="collapse" data-target="#topmenu-navbar-collapse" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Waigo</a>
        </div>
        <div id="topmenu-navbar-collapse" role="navigation" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/guide.html">Guide</a></li>
            <li class="active"><a href="/api">API</a></li>
            <li><a href="/examples/index.html">Examples</a></li>
            <li><a href="/projects.html">Projects</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/waigo/waigo">Github</a></li>
          </ul>
        </div>
      </nav>
    </header>
    <main id="content">
      <div id="api">
        <div class="container">
          <div class="row">
            <div role="complementary" class="col-md-3 waigo-api-index">
              <ul class="nav hidden-sm hidden-xs">
                <li><a href="index.html">Introduction</a></li>
                <li class="active"><a href="application.js.html">application.js</a></li>
                <li><a href="cli/init.js.html">cli/init.js</a></li>
                <li><a href="config/base.js.html">config/base.js</a></li>
                <li><a href="config/development.js.html">config/development.js</a></li>
                <li><a href="config/index.js.html">config/index.js</a></li>
                <li><a href="loader.js.html">loader.js</a></li>
                <li><a href="routes.js.html">routes.js</a></li>
                <li><a href="support/cliCommand.js.html">support/cliCommand.js</a></li>
                <li><a href="support/errors.js.html">support/errors.js</a></li>
                <li><a href="support/forms/field.js.html">support/forms/field.js</a></li>
                <li><a href="support/forms/fields/select.js.html">support/forms/fields/select.js</a></li>
                <li><a href="support/forms/fields/text.js.html">support/forms/fields/text.js</a></li>
                <li><a href="support/forms/form.js.html">support/forms/form.js</a></li>
                <li><a href="support/forms/sanitizers/trim.js.html">support/forms/sanitizers/trim.js</a></li>
                <li><a href="support/forms/validators/isEmailAddress.js.html">support/forms/validators/isEmailAddress.js</a></li>
                <li><a href="support/forms/validators/notEmpty.js.html">support/forms/validators/notEmpty.js</a></li>
                <li><a href="support/logging/winston.js.html">support/logging/winston.js</a></li>
                <li><a href="support/middleware/bodyParser.js.html">support/middleware/bodyParser.js</a></li>
                <li><a href="support/middleware/errorHandler.js.html">support/middleware/errorHandler.js</a></li>
                <li><a href="support/middleware/outputFormats.js.html">support/middleware/outputFormats.js</a></li>
                <li><a href="support/middleware/sessions.js.html">support/middleware/sessions.js</a></li>
                <li><a href="support/middleware/staticResources.js.html">support/middleware/staticResources.js</a></li>
                <li><a href="support/mixins.js.html">support/mixins.js</a></li>
                <li><a href="support/outputFormats/html.js.html">support/outputFormats/html.js</a></li>
                <li><a href="support/outputFormats/json.js.html">support/outputFormats/json.js</a></li>
                <li><a href="support/routeMapper.js.html">support/routeMapper.js</a></li>
                <li><a href="support/session/store/cookie.js.html">support/session/store/cookie.js</a></li>
                <li><a href="support/shutdown/listener.js.html">support/shutdown/listener.js</a></li>
                <li><a href="support/startup/database.js.html">support/startup/database.js</a></li>
                <li><a href="support/startup/listener.js.html">support/startup/listener.js</a></li>
                <li><a href="support/startup/logging.js.html">support/startup/logging.js</a></li>
                <li><a href="support/startup/middleware.js.html">support/startup/middleware.js</a></li>
                <li><a href="support/startup/models.js.html">support/startup/models.js</a></li>
                <li><a href="support/startup/routes.js.html">support/startup/routes.js</a></li>
                <li><a href="support/underscore.js.html">support/underscore.js</a></li>
              </ul>
              <div class="visible-sm visible-xs">
                <button type="button" data-toggle="collapse" data-target="#api-index-xs" class="btn btn-info">Show/hide API index</button>
                <div id="api-index-xs" class="collapse">
                  <ul class="nav">
                    <li><a href="index.html">Introduction</a></li>
                    <li class="active"><a href="application.js.html">application.js</a></li>
                    <li><a href="cli/init.js.html">cli/init.js</a></li>
                    <li><a href="config/base.js.html">config/base.js</a></li>
                    <li><a href="config/development.js.html">config/development.js</a></li>
                    <li><a href="config/index.js.html">config/index.js</a></li>
                    <li><a href="loader.js.html">loader.js</a></li>
                    <li><a href="routes.js.html">routes.js</a></li>
                    <li><a href="support/cliCommand.js.html">support/cliCommand.js</a></li>
                    <li><a href="support/errors.js.html">support/errors.js</a></li>
                    <li><a href="support/forms/field.js.html">support/forms/field.js</a></li>
                    <li><a href="support/forms/fields/select.js.html">support/forms/fields/select.js</a></li>
                    <li><a href="support/forms/fields/text.js.html">support/forms/fields/text.js</a></li>
                    <li><a href="support/forms/form.js.html">support/forms/form.js</a></li>
                    <li><a href="support/forms/sanitizers/trim.js.html">support/forms/sanitizers/trim.js</a></li>
                    <li><a href="support/forms/validators/isEmailAddress.js.html">support/forms/validators/isEmailAddress.js</a></li>
                    <li><a href="support/forms/validators/notEmpty.js.html">support/forms/validators/notEmpty.js</a></li>
                    <li><a href="support/logging/winston.js.html">support/logging/winston.js</a></li>
                    <li><a href="support/middleware/bodyParser.js.html">support/middleware/bodyParser.js</a></li>
                    <li><a href="support/middleware/errorHandler.js.html">support/middleware/errorHandler.js</a></li>
                    <li><a href="support/middleware/outputFormats.js.html">support/middleware/outputFormats.js</a></li>
                    <li><a href="support/middleware/sessions.js.html">support/middleware/sessions.js</a></li>
                    <li><a href="support/middleware/staticResources.js.html">support/middleware/staticResources.js</a></li>
                    <li><a href="support/mixins.js.html">support/mixins.js</a></li>
                    <li><a href="support/outputFormats/html.js.html">support/outputFormats/html.js</a></li>
                    <li><a href="support/outputFormats/json.js.html">support/outputFormats/json.js</a></li>
                    <li><a href="support/routeMapper.js.html">support/routeMapper.js</a></li>
                    <li><a href="support/session/store/cookie.js.html">support/session/store/cookie.js</a></li>
                    <li><a href="support/shutdown/listener.js.html">support/shutdown/listener.js</a></li>
                    <li><a href="support/startup/database.js.html">support/startup/database.js</a></li>
                    <li><a href="support/startup/listener.js.html">support/startup/listener.js</a></li>
                    <li><a href="support/startup/logging.js.html">support/startup/logging.js</a></li>
                    <li><a href="support/startup/middleware.js.html">support/startup/middleware.js</a></li>
                    <li><a href="support/startup/models.js.html">support/startup/models.js</a></li>
                    <li><a href="support/startup/routes.js.html">support/startup/routes.js</a></li>
                    <li><a href="support/underscore.js.html">support/underscore.js</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div role="main" class="col-md-7 waigo-api-content">
              <section id="Application">
                <h1>Application</h1>
                <div class="description"><p>The application object is the main entry point for all Waigo applications.</p><p>It is responsible for constructing the Koa <code>app</code> object and initialising<br />logging, database connections, sessions and the various middleware<br />components amongst other things.</p><p>Internally it holds a reference to the Koa <code>app</code> object.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-success radius ctx-type">declaration</div>
                </p>
              </section>
              <pre><code class="language-javascript">var Application = module.exports = {
  app: koa()
};</code></pre>
              <section id="loadConfig">
                <h1>loadConfig</h1>
                <div class="description"><p>Load in the application configuration.</p><p>This gets called automatically from <code>start()</code> and should not be called<br />directly.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">[options]</td>
                    <td class="type">Object</td>
                    <td class="description">Additional options.</td>
                  </tr>
                  <tr>
                    <td class="name">[options.postConfig]</td>
                    <td class="type">Function</td>
                    <td class="description">Function to pass configuration object to once loaded. Useful for performing dynamic runtime configuration. </td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">Application.loadConfig = function*(options) {
  options = options || {};

  debug('Loading configuration');
  Application.app.config = waigo.load('config/index')();

  if (options.postConfig) {
    debug('Executing dynamic configuration');
    options.postConfig.call(null, Application.app.config);
  }
};</code></pre>
              <section id="start">
                <h1>start</h1>
                <div class="description"><p>Start the Koa application.</p><p>This is a convenience method for initialising the various parts of the app and setting up the general middleware chain.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div><span class="symbolReturns">-> Object</span>
                </p>
              </section>
              <table class="params table table-bordered table-striped">
                <thead>
                  <tr>
                    <th style="width:20%">Option</th>
                    <th style="width:20%">Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="name">[options]</td>
                    <td class="type">Object</td>
                    <td class="description">Additional options.</td>
                  </tr>
                  <tr>
                    <td class="name">[options.postConfig]</td>
                    <td class="type">Function</td>
                    <td class="description">see `loadConfig()`. </td>
                  </tr>
                </tbody>
              </table>
              <pre><code class="language-javascript">Application.start = function*(options) {
  // load config</code></pre>
              <pre><code class="language-javascript">yield* Application.loadConfig(options);

  // run startup steps
  for (let idx in Application.app.config.startupSteps) {
    let stepName = Application.app.config.startupSteps[idx];
    debug('Running startup step: ' + stepName);</code></pre>
              <pre><code class="language-javascript">yield* waigo.load('support/startup/' + stepName)(Application.app);
  }
};</code></pre>
              <section id="shutdown">
                <h1>shutdown</h1>
                <div class="description"><p>Stop the currently running application.</p><p>This will reset the internal Koa <code>app</code> object.</p> </div>
                <h5 class="subheader"></h5>
                <p>
                  <div class="label label-info radius ctx-type">method</div>
                </p>
              </section>
              <pre><code class="language-javascript">Application.shutdown = function*() {
  // run shutdown steps
  var shutdownSteps = _.get(Application.app, 'config.shutdownSteps', []);
  for (let idx in shutdownSteps) {
    let stepName = shutdownSteps[idx];
    debug('Running shutdown step: ' + stepName);</code></pre>
              <pre><code class="language-javascript">yield* waigo.load('support/shutdown/' + stepName)(Application.app);
  }

  // prepare the koa app for a restart
  debug('Resetting koa app');
  Application.app = koa();
};</code></pre>
            </div>
            <div class="col-md-2">
              <div role="complementary" class="waigo-content-menu hidden-print">
                <ul class="nav">
                  <li><a href="#Application"><span>Application</span></a></li>
                  <li><a href="#loadConfig"><span>loadConfig()</span></a></li>
                  <li><a href="#start"><span>start()</span></a></li>
                  <li><a href="#shutdown"><span>shutdown()</span></a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer role="contentinfo">
      <div><p>Waigo &copy; <a href="https://github.com/hiddentao">Ramesh Nair</a>. Page <a href="https://github.com/waigo/waigo.github.io">generated</a> on Wed, 20 Aug 2014 16:10:37 GMT</p>

      </div>
    </footer>
    <script type="text/javascript" src="/scripts.js"></script>
    <script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(["setDomains", ["*.waigojs.com","*.waigo.github.io"]]);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);
      (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.hiddentao.com/";
        _paq.push(["setTrackerUrl", u+"piwik.php"]);
        _paq.push(["setSiteId", "3"]);
        var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
        g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
      })();
      
    </script>
  </body>
</html>