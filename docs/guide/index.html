<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/><link rel="shortcut icon" href="/img/logo.ico"/><link rel="shortcut icon" href="/img/logo.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/img/logo.png"/><title>What is Waigo? | Waigo.js</title><style>@import url('https://fonts.googleapis.com/css?family=Roboto Mono:300|Open Sans:300,400|Raleway:100,300,500');a,abbr,acronym,address,applet,big,blockquote,body,caption,cite,code,dd,del,dfn,div,dl,dt,em,fieldset,form,h1,h2,h3,h4,h5,h6,html,iframe,img,ins,kbd,label,legend,li,object,ol,p,pre,q,s,samp,small,span,strike,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,tt,ul,var{margin:0;padding:0;border:0;outline:0;font-weight:inherit;font-style:inherit;font-family:inherit;font-size:100%;vertical-align:baseline}body{line-height:1;color:#000;background:#fff}ol,ul{list-style:none}table{border-collapse:separate;border-spacing:0}caption,table,td,th{vertical-align:middle}caption,td,th{text-align:left;font-weight:400}a img{border:none}*{box-sizing:border-box}@font-face{font-family:FontAwesome;src:url("/fonts/fontawesome-webfont.eot?v=4.6.1");src:url("/fonts/fontawesome-webfont.eot?#iefix&v=4.6.1") format('embedded-opentype'),url("/fonts/fontawesome-webfont.woff?v=4.6.1") format('woff'),url("/fonts/fontawesome-webfont.woff2?v=4.6.1") format('woff2'),url("/fonts/fontawesome-webfont.ttf?v=4.6.1") format('truetype'),url("/fonts/fontawesome-webfont.svg?v=4.6.1#fontawesomeregular") format('svg');font-weight:400;font-style:normal}.fa,.page.docs section.content a.github-edit-link:before,i.arrow.left:before,i.arrow.right:before,i.changelog:before,i.discuss:before,i.github:before,i.menu.open:before,i.menu:before,i.twitter:before{display:inline-block;font-family:FontAwesome;font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.333333333333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.285714285714286em;text-align:center}.fa-ul{padding-left:0;margin-left:2.142857142857143em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.142857142857143em;width:2.142857142857143em;top:.142857142857143em;text-align:center}.fa-li.fa-lg{left:-1.857142857142857em}.fa-border{padding:.2em .25em .15em;border:.08em solid #eee;border-radius:.1em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left,.page.docs section.content a.github-edit-link:before.pull-left,i.arrow.left:before.pull-left,i.arrow.right:before.pull-left,i.changelog:before.pull-left,i.discuss:before.pull-left,i.github:before.pull-left,i.menu.open:before.pull-left,i.menu:before.pull-left,i.twitter:before.pull-left{margin-right:.3em}.fa.pull-right,.page.docs section.content a.github-edit-link:before.pull-right,i.arrow.left:before.pull-right,i.arrow.right:before.pull-right,i.changelog:before.pull-right,i.discuss:before.pull-right,i.github:before.pull-right,i.menu.open:before.pull-right,i.menu:before.pull-right,i.twitter:before.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:spin 2s infinite linear;animation:spin 2s infinite linear}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2);-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=0,mirror=1);-webkit-transform:scaleX(-1);transform:scaleX(-1)}.fa-flip-vertical{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2,mirror=1);-webkit-transform:scaleY(-1);transform:scaleY(-1)}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.page.docs button.nav.mobile,.page.home section.features-1 ul li .title,.page.home section.next-links>div a,.page.home section.quick-start h2,.page.home section.splash .actions a,.page.home section.splash p.tagline,footer .social a,footer .tagline,h1,h2,h3,header,header button.mobile-toggle{font-family:Raleway,Arial,sans-serif;font-weight:100;letter-spacing:1px}.page.docs button.nav.mobile,.page.home section.features-1 ul li .title,.page.home section.next-links>div a,.page.home section.splash .actions a,header button.mobile-toggle{font-weight:300}.page.docs aside,.page.docs aside li.active>a,.page.home section.features-1 .intro,body{font-family:Open Sans,Arial,sans-serif;font-weight:300}.page.docs aside li.active>a{font-weight:400}.page.docs section.content code,.page.home section.quick-start pre,.page.home section.splash .install{font-family:Roboto Mono,monospace;font-weight:300}mixin standard-box-shadow(){box-shadow:0 7px 26px -1px rgba(0,0,0,.53)}html{font-size:16px}body{background-color:#fff;margin:0;padding:0}a{color:#3498db;text-decoration:none;border-bottom:1px solid #3498db;-webkit-transition:all .2s linear;transition:all .2s linear}a:hover{color:#fff;background-color:#3498db}.page{position:relative;min-height:100vh;width:100%}.page main{background-color:#fff;min-height:calc(100vh - 64px);padding:1em 1.5em 0}@media only screen and (max-width:500px){.page main{padding:1em}}strong{font-weight:bolder}i{display:inline-block;-webkit-transition:all .2s linear;transition:all .2s linear}i.twitter{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.twitter:before{content:"\F099"}i.github{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.github:before{content:"\F09B"}i.discuss{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.discuss:before{content:"\F086"}i.menu{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.menu:before{content:"\F0C9"}i.menu.open{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.menu.open:before{content:"\F0C9"}i.changelog{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.changelog:before{content:"\F126"}i.arrow.right{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}i.arrow.right:before{content:"\F101"}i.arrow.left{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(180deg);transform:rotate(180deg)}i.arrow.left:before{content:"\F101"}.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}header{position:relative;width:100%;height:64px;margin-bottom:1.5em;-webkit-transition:all .3s linear;transition:all .3s linear;background-color:#2c3e50;color:#fff}.page.home .headroom--unfixed header{background-color:#3498db;color:#fff;box-shadow:none}.page.home .headroom--pinned header{background-color:#2c3e50;color:#fff}header .brand{position:absolute;height:64px}header .brand a{text-decoration:none;padding:0 .5em;line-height:64px;font-size:1.5rem}header .brand a,header .brand a:hover{color:inherit;background-color:inherit;border-bottom:none}header .brand a:hover{border-radius:0}header ul.nav{position:absolute;height:64px;right:15px;list-style:none;display:-webkit-box;display:-ms-flexbox;display:box;display:flex;-webkit-box-orient:horizontal;-moz-box-orient:horizontal;-o-box-orient:horizontal;-webkit-box-lines:single;-moz-box-lines:single;-o-box-lines:single;-ms-flex-flow:row nowrap;flex-flow:row;-webkit-box-pack:center;-o-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-o-box-align:center;-ms-flex-align:center;align-items:center}header ul.nav li{display:inline-block;margin-right:1.3em}@media only screen and (max-width:800px){header ul.nav li{margin-right:1em}}header ul.nav li:last-child{margin-right:0}header ul.nav li a{color:#fff;text-decoration:none;border:1px solid transparent;-webkit-transition:all .2s linear;transition:all .2s linear;padding:0 .5em;border-radius:5px;font-size:1.2em;display:inline-block;height:100%;line-height:48px}header ul.nav li a.active,header ul.nav li a:hover{color:#fff;background-color:transparent;border:1px solid #fff}header ul.nav li.social{margin-right:.3em}header ul.nav li.social a{font-size:1em}@media only screen and (max-width:500px){header ul.nav{opacity:0;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";filter:alpha(opacity=0);z-index:10;pointer-events:none;-webkit-transition:opacity .3s linear;transition:opacity .3s linear;display:block;top:48px;height:auto;border-radius:10px;border:1px solid #2980b9;background-color:#2980b9}header ul.nav li{display:block;background-color:transparent;margin:0;border-bottom:1px solid #3498db}header ul.nav li.social{margin:0}header ul.nav li:last-child{border-bottom:none}header ul.nav li a{color:#fff;text-decoration:none;border:1px solid transparent;-webkit-transition:all .2s linear;transition:all .2s linear;padding:0 .5em;border-radius:5px;font-size:1em;display:block;border-radius:0;text-align:center;font-weight:bolder}header ul.nav li a.active,header ul.nav li a:hover{color:#2980b9;background-color:#fff;border:1px solid transparent}header ul.nav.active{opacity:1;-ms-filter:none;filter:none;pointer-events:auto}}header button.mobile-toggle{border-radius:10px;border:1px solid #fff;padding:.7em 1em;-webkit-transition:all .2s linear;transition:all .2s linear;color:#fff;background-color:transparent;display:none;position:absolute;right:15px;top:16px;width:32px;height:32px;padding:0;cursor:pointer}header button.mobile-toggle:hover{border-radius:10px;border:1px solid #fff;color:#3498db;background-color:#fff}header button.mobile-toggle i{display:block}@media only screen and (max-width:500px){header button.mobile-toggle{display:block}}footer{width:100%;height:50px;border-top:1px solid #ccc;padding:1em;margin-top:60px;color:#666;text-align:center}footer .tagline{margin:0 0 1em}footer .credits{font-size:50%}footer .social{margin-top:1em}footer .social a{text-decoration:none;display:inline-block;margin:0 .2em;width:24px;height:24px;opacity:.5;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";filter:alpha(opacity=50);-webkit-transition:all .3s linear;transition:all .3s linear}footer .social a,footer .social a:hover{color:inherit;background-color:inherit;border-bottom:none}footer .social a:hover{border-radius:0;opacity:1;-ms-filter:none;filter:none}.page.home{position:relative}.page.home .headroom-wrapper{background-color:#3498db}@media only screen and (max-width:500px){.page.home .headroom-wrapper{height:64px!important}}.page.home main{padding:0;margin-top:-1px}.page.home section.splash{height:calc(100vh - 64px);background-color:#3498db;display:-webkit-box;display:-ms-flexbox;display:box;display:flex;-webkit-box-orient:vertical;-moz-box-orient:vertical;-o-box-orient:vertical;-webkit-box-lines:single;-moz-box-lines:single;-o-box-lines:single;-ms-flex-flow:column nowrap;flex-flow:column;-webkit-box-pack:center;-o-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-o-box-align:center;-ms-flex-align:center;align-items:center;color:#fff;font-size:1.7rem;text-align:center}@media only screen and (max-width:500px){.page.home section.splash{font-size:1.3rem}}.page.home section.splash .logo{display:block;-webkit-transition:all .3s linear;transition:all .3s linear;width:144px;height:144px;margin:0 0 .5em;background-image:url("/img/logo.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.splash .logo{background-image:url("/img/logo@2x.png");background-size:contain}}@media only screen and (max-width:500px){.page.home section.splash .logo{width:96px;height:96px}}.page.home section.splash p.tagline{margin:.7em 0;font-size:120%;line-height:1.2em;width:50%}@media only screen and (max-width:800px){.page.home section.splash p.tagline{width:80%;margin-bottom:0}}.page.home section.splash .actions{margin:1em 0 2em}@media only screen and (max-width:500px){.page.home section.splash .actions{margin-bottom:1em}}.page.home section.splash .actions a{border-radius:10px;border:1px solid #fff;padding:.7em 1em;-webkit-transition:all .2s linear;transition:all .2s linear;color:#fff;background-color:transparent;cursor:pointer;font-size:80%;margin:0 .5em}.page.home section.splash .actions a:hover{border-radius:10px;border:1px solid #fff;color:#3498db;background-color:#fff}@media only screen and (max-width:500px){.page.home section.splash .actions a{display:block;margin:.5em auto;font-size:100%}}.page.home section.splash .install{font-size:60%;padding:.3em .4em;background-color:#2c3e50;border-radius:5px}.page.home section.splash .meta{margin-top:1.2em}.page.home section.splash .meta a{text-decoration:none;border:1px solid transparent;-webkit-transition:all .2s linear;transition:all .2s linear;padding:0 .5em;border-radius:5px;font-size:50%;color:#fff;margin:0 .5em}.page.home section.splash .meta a.active,.page.home section.splash .meta a:hover{color:#000;background-color:#fff;border:1px solid transparent}.page.home section.splash .meta a i+span{margin-left:.3em}.page.home section.features-1{padding:1em}.page.home section.features-1 .intro{width:80%;font-size:2.2rem;text-align:center;margin:1em auto 1.5em;line-height:1.5em}@media only screen and (max-width:500px){.page.home section.features-1 .intro{font-size:1.8rem}}.page.home section.features-1 ul{display:-webkit-box;display:-ms-flexbox;display:box;display:flex;-webkit-box-orient:horizontal;-moz-box-orient:horizontal;-o-box-orient:horizontal;-webkit-box-lines:multiple;-moz-box-lines:multiple;-o-box-lines:multiple;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:justify;-o-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:start;-o-box-align:start;-ms-flex-align:start;align-items:flex-start;margin:0 auto;width:90%}@media only screen and (max-width:800px){.page.home section.features-1 ul{width:100%}}@media only screen and (max-width:500px){.page.home section.features-1 ul{-webkit-box-orient:vertical;-moz-box-orient:vertical;-o-box-orient:vertical;-webkit-box-lines:single;-moz-box-lines:single;-o-box-lines:single;-ms-flex-flow:column nowrap;flex-flow:column}}.page.home section.features-1 ul li{display:block;width:30%;font-size:1rem;margin:1.5em auto}@media only screen and (max-width:800px){.page.home section.features-1 ul li{width:40%}}@media only screen and (max-width:500px){.page.home section.features-1 ul li{display:block;width:100%}}.page.home section.features-1 ul li .title{display:inline-block;font-size:140%}.page.home section.features-1 ul li .title:before{display:inline-block;vertical-align:top;margin:0 .5em .3em 0;content:" ";width:32px;height:32px}.page.home section.features-1 ul li .description{margin-top:1em;line-height:1.4em}.page.home section.features-1 ul li:nth-child(1) .title:before{background-image:url("/img/icon-rocket.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(1) .title:before{background-image:url("/img/icon-rocket@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(2) .title:before{background-image:url("/img/icon-plugin.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(2) .title:before{background-image:url("/img/icon-plugin@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(3) .title:before{background-image:url("/img/icon-text-field.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(3) .title:before{background-image:url("/img/icon-text-field@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(4) .title:before{background-image:url("/img/icon-routing.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(4) .title:before{background-image:url("/img/icon-routing@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(5) .title:before{background-image:url("/img/icon-template.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(5) .title:before{background-image:url("/img/icon-template@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(6) .title:before{background-image:url("/img/icon-users.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(6) .title:before{background-image:url("/img/icon-users@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(7) .title:before{background-image:url("/img/icon-email.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(7) .title:before{background-image:url("/img/icon-email@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(8) .title:before{background-image:url("/img/icon-cron.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(8) .title:before{background-image:url("/img/icon-cron@2x.png");background-size:contain}}.page.home section.features-1 ul li:nth-child(9) .title:before{background-image:url("/img/icon-setup.png");background-size:contain;background-repeat:no-repeat;background-position:50%}@media (min--moz-device-pixel-ratio:1.5),(min-device-pixel-ratio:1.5),(min-resolution:1.5dppx),(min-resolution:138dpi),all and (-webkit-min-device-pixel-ratio:1.5){.page.home section.features-1 ul li:nth-child(9) .title:before{background-image:url("/img/icon-setup@2x.png");background-size:contain}}.page.home section.quick-start{margin:2em 0;background-color:#2c3e50;padding:3em 1em;color:#fff;text-align:center;font-size:1rem}@media only screen and (max-width:500px){.page.home section.quick-start{padding:1em;font-size:.8rem}}.page.home section.quick-start .wrapper{display:inline-block;width:80%;text-align:left}@media only screen and (max-width:500px){.page.home section.quick-start .wrapper{width:100%}}.page.home section.quick-start h2{display:block;font-size:200%;margin-bottom:.8em}.page.home section.quick-start div,.page.home section.quick-start pre{display:inline-block}.page.home section.quick-start pre{line-height:1.5em;background-color:#000;width:40%;padding:1em;margin-right:2em}.page.home section.quick-start div{vertical-align:top;width:50%;font-size:110%;line-height:1.3em}.page.home section.quick-start div p{margin-bottom:1em}@media only screen and (max-width:800px){.page.home section.quick-start pre{display:block;width:100%}.page.home section.quick-start div{display:block;margin-top:1.5em;line-height:1.5em;width:100%}}.page.home section.next-links{margin-top:2em;display:-webkit-box;display:-ms-flexbox;display:box;display:flex;-webkit-box-orient:horizontal;-moz-box-orient:horizontal;-o-box-orient:horizontal;-webkit-box-lines:multiple;-moz-box-lines:multiple;-o-box-lines:multiple;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:center;-o-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-o-box-align:center;-ms-flex-align:center;align-items:center;font-size:1rem}.page.home section.next-links>div{margin:2em 0;text-align:center}@media only screen and (max-width:500px){.page.home section.next-links>div{margin:1em 0}}.page.home section.next-links>div a{border-radius:10px;border:1px solid #3498db;padding:.7em 1em;-webkit-transition:all .2s linear;transition:all .2s linear;color:#3498db;background-color:transparent;cursor:pointer;display:inline-block;margin:0 .5em;font-size:140%}.page.home section.next-links>div a:hover{border-radius:10px;border:1px solid #3498db;color:#fff;background-color:#3498db}.page.home section.next-links>div p{width:70%;margin:1em auto 0;line-height:1.2em}.page.docs section.content code[class*=hljs],.page.docs section.content img{max-width:100%;box-shadow:0 0 11px 0 rgba(0,0,0,.5)}.page.docs{position:relative}.page.docs main{padding-top:2em}.page.docs section.content{position:relative;display:inline-block;vertical-align:top;width:79%;padding-left:20px;font-size:1rem;line-height:1.5em;word-wrap:break-word}@media only screen and (max-width:500px){.page.docs section.content{width:100%;padding:0 1em}}.page.docs section.content h1{font-size:250%;margin:0 0 1em;line-height:1em}.page.docs section.content h2{font-size:160%;margin:1.5em 0 1em;line-height:1em}.page.docs section.content h3{font-size:130%;margin:1.5em 0 1em;line-height:1em}.page.docs section.content p{margin:1em 0}.page.docs section.content em{font-style:italic;font-size:90%}.page.docs section.content ol{list-style:decimal}.page.docs section.content ul{list-style:disc}.page.docs section.content ol,.page.docs section.content ul{margin:1em 0 1em 3em}.page.docs section.content ol li,.page.docs section.content ul li{padding:.2em 0}.page.docs section.content code[class*=hljs]{display:block;border-radius:5px;word-wrap:normal;margin-bottom:1.7em}.page.docs section.content code:not([class*=hljs]){display:inline;font-size:110%;padding:.1em .2em;background-color:#ecf0f1;border-radius:5px}.page.docs section.content a.github-edit-link{border-bottom:none;position:absolute;font-size:70%;text-transform:lowercase;top:0;right:0;filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(0deg);transform:rotate(0deg)}.page.docs section.content a.github-edit-link:before{content:"\F044";margin-right:.2em}.page.docs section.content .prev-next{display:-webkit-box;display:-ms-flexbox;display:box;display:flex;-webkit-box-orient:horizontal;-moz-box-orient:horizontal;-o-box-orient:horizontal;-webkit-box-lines:multiple;-moz-box-lines:multiple;-o-box-lines:multiple;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:justify;-o-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-o-box-align:center;-ms-flex-align:center;align-items:center;margin-top:4em;font-size:75%;width:100%}.page.docs aside{display:inline-block;vertical-align:top;padding:0 20px 0 0;border-right:1px solid #ecf0f1;font-size:1rem;width:20%;overflow:hidden}.page.docs aside a{border-bottom:none}.page.docs aside a:hover,.page.docs aside li.active>a{border-bottom:1px dashed #000}.page.docs aside li.active>a{font-size:140%;color:#000}.page.docs aside li.active>a:hover{color:#fff}.page.docs aside>ul>li{line-height:2em}.page.docs aside>ul>li>ul{display:none}.page.docs aside>ul>li.active>ul{color:#000;display:block;font-size:80%;margin:.7em 0 0 2em}.page.docs aside>ul>li.active>ul>li{line-height:1.8em}@media only screen and (max-width:500px){.page.docs aside{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:2;left:-100vw;-webkit-transition:all .2s linear;transition:all .2s linear;overflow-y:scroll;background-color:#fff}.page.docs aside ul{margin:1em 0 0 4em}.page.docs aside.mobile.visible{left:0}}.page.docs button.nav.mobile{border-radius:10px;border:1px solid #2980b9;padding:.7em 1em;-webkit-transition:all .2s linear;transition:all .2s linear;color:#fff;background-color:#2980b9;cursor:pointer;display:none;position:fixed;top:64px;left:0;padding:.2em .3em;font-size:1.5rem;border-top-left-radius:0;border-bottom-left-radius:0;border-left:none;z-index:4}.page.docs button.nav.mobile:hover{border-radius:10px;border:1px solid #3498db;color:#fff;background-color:#3498db;border-top-left-radius:0;border-bottom-left-radius:0;border-left:none}@media only screen and (max-width:500px){.page.docs button.nav.mobile{display:block}}</style></head><body><div id="react-mount"><div class="page docs" data-reactroot="" data-reactid="1" data-react-checksum="-878288809"><div class="headroom-wrapper" data-reactid="2"><div style="position:relative;top:0;left:0;right:0;z-index:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);" class="headroom headroom--unfixed" data-reactid="3"><header data-reactid="4"><section class="brand" data-reactid="5"><a href="/" data-reactid="6">Waigo.js</a></section><button class="mobile-toggle" data-reactid="7"><i class="menu" data-reactid="8"></i></button><ul class="nav" data-reactid="9"><li class="" data-reactid="10"><a title="Get started" class="" href="/docs/gettingstarted/requirements/" data-reactid="11">Get started</a></li><li class="" data-reactid="12"><a title="Documentation" class="active" href="/docs/introduction/motivation/" data-reactid="13">Docs</a></li><li class="social" data-reactid="14"><a title="Twitter" href="https://twitter.com/waigojs" class="" data-reactid="15"><i class="twitter" data-reactid="16"></i></a></li><li class="social" data-reactid="17"><a title="Github" href="https://github.com/waigo/waigo" class="" data-reactid="18"><i class="github" data-reactid="19"></i></a></li><li class="social" data-reactid="20"><a title="Discuss" href="https://discord.gg/Jf3pGjf" class="" data-reactid="21"><i class="discuss" data-reactid="22"></i></a></li></ul></header></div></div><main data-reactid="23"><button class="nav mobile" title="Toggle nav menu" data-reactid="24"><i class="arrow right" data-reactid="25"></i></button><aside class="" data-reactid="26"><ul data-reactid="27"><li class="" data-reactid="28"><a href="/docs/introduction/" data-reactid="29">Introduction</a><ul data-reactid="30"><li class="" data-reactid="31"><a href="/docs/introduction/motivation/" data-reactid="32">Motivation</a></li><li class="" data-reactid="33"><a href="/docs/introduction/middlewareprimer/" data-reactid="34">Middleware primer</a></li><li class="" data-reactid="35"><a href="/docs/introduction/folderstructure/" data-reactid="36">Folder structure</a></li><li class="" data-reactid="37"><a href="/docs/introduction/codingstandard/" data-reactid="38">Coding standard</a></li></ul></li><li class="" data-reactid="39"><a href="/docs/gettingstarted/" data-reactid="40">Getting Started</a><ul data-reactid="41"><li class="" data-reactid="42"><a href="/docs/gettingstarted/requirements/" data-reactid="43">Requirements</a></li><li class="" data-reactid="44"><a href="/docs/gettingstarted/installation/" data-reactid="45">Installation</a></li><li class="" data-reactid="46"><a href="/docs/gettingstarted/runninghelloworld/" data-reactid="47">Running &quot;Hello World&quot;</a></li><li class="" data-reactid="48"><a href="/docs/gettingstarted/buildworkflowlivereload/" data-reactid="49">Build workflow and Live reload</a></li></ul></li><li class="" data-reactid="50"><a href="/docs/extendandoverride/" data-reactid="51">Extend and Override</a><ul data-reactid="52"><li class="" data-reactid="53"><a href="/docs/extendandoverride/moduleloader/" data-reactid="54">Module Loader</a></li><li class="" data-reactid="55"><a href="/docs/extendandoverride/usingplugins/" data-reactid="56">Using Plugins</a></li><li class="" data-reactid="57"><a href="/docs/extendandoverride/creatingplugins/" data-reactid="58">Creating Plugins</a></li></ul></li><li class="" data-reactid="59"><a href="/docs/commandline/" data-reactid="60">Command-Line (CLI)</a><ul data-reactid="61"><li class="" data-reactid="62"><a href="/docs/commandline/usingthecli/" data-reactid="63">Using the CLI</a></li><li class="" data-reactid="64"><a href="/docs/commandline/creatingcustomcommands/" data-reactid="65">Creating custom commands</a></li></ul></li><li class="" data-reactid="66"><a href="/docs/appconfiguration/" data-reactid="67">App configuration</a><ul data-reactid="68"><li class="" data-reactid="69"><a href="/docs/appconfiguration/appobject/" data-reactid="70">App object</a></li><li class="" data-reactid="71"><a href="/docs/appconfiguration/configuration/" data-reactid="72">Configuration</a></li><li class="" data-reactid="73"><a href="/docs/appconfiguration/startupsteps/" data-reactid="74">Startup steps</a></li><li class="" data-reactid="75"><a href="/docs/appconfiguration/shutdownsteps/" data-reactid="76">Shutdown steps</a></li></ul></li><li class="" data-reactid="77"><a href="/docs/logging/" data-reactid="78">Logging</a><ul data-reactid="79"><li class="" data-reactid="80"><a href="/docs/logging/howtouse/" data-reactid="81">How to use</a></li><li class="" data-reactid="82"><a href="/docs/logging/subcategories/" data-reactid="83">Sub-categories</a></li></ul></li><li class="" data-reactid="84"><a href="/docs/events/" data-reactid="85">Events</a></li><li class="" data-reactid="86"><a href="/docs/errorhandling/" data-reactid="87">Error handling</a><ul data-reactid="88"><li class="" data-reactid="89"><a href="/docs/errorhandling/builtinerrorclasses/" data-reactid="90">Built-in Error classes</a></li><li class="" data-reactid="91"><a href="/docs/errorhandling/creatingyourown/" data-reactid="92">Creating your own</a></li><li class="" data-reactid="93"><a href="/docs/errorhandling/errormiddleware/" data-reactid="94">Error middleware</a></li></ul></li><li class="" data-reactid="95"><a href="/docs/middleware/" data-reactid="96">Middleware</a><ul data-reactid="97"><li class="" data-reactid="98"><a href="/docs/middleware/defining/" data-reactid="99">Defining</a></li><li class="" data-reactid="100"><a href="/docs/middleware/configuring/" data-reactid="101">Configuring</a></li><li class="" data-reactid="102"><a href="/docs/middleware/commonmiddleware/" data-reactid="103">Common middleware</a></li></ul></li><li class="" data-reactid="104"><a href="/docs/controllers/" data-reactid="105">Controllers</a></li><li class="" data-reactid="106"><a href="/docs/databaseandmodels/" data-reactid="107">Database and Models</a><ul data-reactid="108"><li class="" data-reactid="109"><a href="/docs/databaseandmodels/databaseconnections/" data-reactid="110">Database connections</a></li><li class="" data-reactid="111"><a href="/docs/databaseandmodels/overviewofmodels/" data-reactid="112">Overview of models</a></li><li class="" data-reactid="113"><a href="/docs/databaseandmodels/definingandusingmodels/" data-reactid="114">Defining and using models</a></li><li class="" data-reactid="115"><a href="/docs/databaseandmodels/builtinmodels/" data-reactid="116">Built-in models</a></li><li class="" data-reactid="117"><a href="/docs/databaseandmodels/reactiveupdates/" data-reactid="118">Reactive updates</a></li></ul></li><li class="" data-reactid="119"><a href="/docs/routing/" data-reactid="120">Routing</a><ul data-reactid="121"><li class="" data-reactid="122"><a href="/docs/routing/howtouse/" data-reactid="123">How to use</a></li><li class="" data-reactid="124"><a href="/docs/routing/generatingurls/" data-reactid="125">Generating URLs</a></li></ul></li><li class="" data-reactid="126"><a href="/docs/renderingoutput/" data-reactid="127">Rendering output</a><ul data-reactid="128"><li class="" data-reactid="129"><a href="/docs/renderingoutput/enabling/" data-reactid="130">Enabling</a></li><li class="" data-reactid="131"><a href="/docs/renderingoutput/renderingmethods/" data-reactid="132">Rendering methods</a></li><li class="" data-reactid="133"><a href="/docs/renderingoutput/jsonoutput/" data-reactid="134">JSON output</a></li><li class="" data-reactid="135"><a href="/docs/renderingoutput/settingoutputformat/" data-reactid="136">Setting the output format</a></li><li class="" data-reactid="137"><a href="/docs/renderingoutput/customformats/" data-reactid="138">Custom formats</a></li></ul></li><li class="" data-reactid="139"><a href="/docs/viewtemplates/" data-reactid="140">View templates</a><ul data-reactid="141"><li class="" data-reactid="142"><a href="/docs/viewtemplates/templatedata/" data-reactid="143">Template data</a></li><li class="" data-reactid="144"><a href="/docs/viewtemplates/contextlevelandappleveldata/" data-reactid="145">Context-level and app-level data</a></li></ul></li><li class="" data-reactid="146"><a href="/docs/staticresources/" data-reactid="147">Static resources</a><ul data-reactid="148"><li class="" data-reactid="149"><a href="/docs/staticresources/collationofstaticresources/" data-reactid="150">Collation of static resources</a></li><li class="" data-reactid="151"><a href="/docs/staticresources/requestmiddleware/" data-reactid="152">Request middleware</a></li><li class="" data-reactid="153"><a href="/docs/staticresources/generatingurlpaths/" data-reactid="154">Generating URL paths</a></li></ul></li><li class="" data-reactid="155"><a href="/docs/sessions/" data-reactid="156">Sessions</a></li><li class="" data-reactid="157"><a href="/docs/scaling/" data-reactid="158">Scaling</a><ul data-reactid="159"><li class="" data-reactid="160"><a href="/docs/scaling/multiprocessclustering/" data-reactid="161">Multi-process clustering</a></li></ul></li><li class="" data-reactid="162"><a href="/docs/bestpractices/" data-reactid="163">Best practices</a></li></ul></aside><section class="content" data-reactid="164"><div data-reactid="165"><div data-reactid="166"><h1 data-reactid="167"><!-- react-text: 168 -->What is Waigo?<!-- /react-text --></h1><!-- react-text: 169 -->
<!-- /react-text --><p data-reactid="170"><!-- react-text: 171 -->Waigo is a Node.js framework for building <!-- /react-text --><strong data-reactid="172"><!-- react-text: 173 -->reactive<!-- /react-text --></strong><!-- react-text: 174 -->, <!-- /react-text --><strong data-reactid="175"><!-- react-text: 176 -->scalable<!-- /react-text --></strong><!-- react-text: 177 --> and
<!-- /react-text --><strong data-reactid="178"><!-- react-text: 179 -->maintainable<!-- /react-text --></strong><!-- react-text: 180 --> web application back-ends.<!-- /react-text --></p><!-- react-text: 181 -->
<!-- /react-text --><p data-reactid="182"><!-- react-text: 183 -->Quick overview:<!-- /react-text --></p><!-- react-text: 184 -->
<!-- /react-text --><ul data-reactid="185"><!-- react-text: 186 -->
<!-- /react-text --><li data-reactid="187"><!-- react-text: 188 -->Based on <!-- /react-text --><a href="http://koajs.com/" data-reactid="189"><!-- react-text: 190 -->koa<!-- /react-text --></a><!-- react-text: 191 -->, uses promises and ES6 generators - no callbacks<!-- /react-text --></li><!-- react-text: 192 -->
<!-- /react-text --><li data-reactid="193"><!-- react-text: 194 -->Front-end agnostic - build whatever kind of front-end you want<!-- /react-text --></li><!-- react-text: 195 -->
<!-- /react-text --><li data-reactid="196"><a href="/docs/#reactive-data/" data-reactid="197">Reactive data</a><!-- react-text: 198 --> model layer<!-- /react-text --></li><!-- react-text: 199 -->
<!-- /react-text --><li data-reactid="200"><!-- react-text: 201 -->Easily build REST/JSON APIs using <!-- /react-text --><a href="/docs/#views-and-output-formats/" data-reactid="202">output formats</a></li><!-- react-text: 203 -->
<!-- /react-text --><li data-reactid="204"><!-- react-text: 205 -->Flexible routing with <!-- /react-text --><a href="/docs/#routing/" data-reactid="206">per-route</a><!-- react-text: 207 --> and <!-- /react-text --><a href="/docs/#routing/" data-reactid="208">per-http-method</a><!-- react-text: 209 --> middleware customisation<!-- /react-text --></li><!-- react-text: 210 -->
<!-- /react-text --><li data-reactid="211"><!-- react-text: 212 -->Built-in <!-- /react-text --><a href="/docs/#user-accounts/" data-reactid="213">user account</a><!-- react-text: 214 --> management + <!-- /react-text --><a href="/docs/#oauth/" data-reactid="215">OAuth</a><!-- react-text: 216 --> support<!-- /react-text --></li><!-- react-text: 217 -->
<!-- /react-text --><li data-reactid="218"><!-- react-text: 219 -->Flexible user <!-- /react-text --><a href="/docs/#access-control/" data-reactid="220">access control</a><!-- react-text: 221 --> list with reactive updates<!-- /react-text --></li><!-- react-text: 222 -->
<!-- /react-text --><li data-reactid="223"><!-- react-text: 224 -->Easily build <!-- /react-text --><a href="/docs/#forms/" data-reactid="225">forms</a><!-- react-text: 226 --> and process submissions with customizable validation<!-- /react-text --></li><!-- react-text: 227 -->
<!-- /react-text --><li data-reactid="228"><!-- react-text: 229 -->Built-in <!-- /react-text --><a href="/docs/#cron/" data-reactid="230">cron job</a><!-- react-text: 231 --> functionality<!-- /react-text --></li><!-- react-text: 232 -->
<!-- /react-text --><li data-reactid="233"><!-- react-text: 234 -->Ready-made <!-- /react-text --><a href="/docs/#admin-dashboard/" data-reactid="235">admin dashboard</a><!-- react-text: 236 --> which is fully customizable<!-- /react-text --></li><!-- react-text: 237 -->
<!-- /react-text --><li data-reactid="238"><!-- react-text: 239 -->Command-line interface for <!-- /react-text --><a href="/docs/#getting-started/" data-reactid="240">easy setup</a></li><!-- react-text: 241 -->
<!-- /react-text --><li data-reactid="242"><a href="/docs/#extend-and-override/" data-reactid="243">Extend</a><!-- react-text: 244 --> or override <!-- /react-text --><em data-reactid="245"><!-- react-text: 246 -->any<!-- /react-text --></em><!-- react-text: 247 --> part of the core framework<!-- /react-text --></li><!-- react-text: 248 -->
<!-- /react-text --><li data-reactid="249"><a href="/docs/#scalable-clustering/" data-reactid="250">Scalability built-in</a><!-- react-text: 251 --> with Node.js clustering<!-- /react-text --></li><!-- react-text: 252 -->
<!-- /react-text --><li data-reactid="253"><!-- react-text: 254 -->Bundle up functionality into re-usable <!-- /react-text --><a href="/docs/#plugins/" data-reactid="255">plugins</a></li><!-- react-text: 256 -->
<!-- /react-text --><li data-reactid="257"><!-- react-text: 258 -->And much, much more…keep reading!<!-- /react-text --></li><!-- react-text: 259 -->
<!-- /react-text --></ul><!-- react-text: 260 -->
<!-- /react-text --><h1 data-reactid="261"><!-- react-text: 262 -->Why should I use Waigo?<!-- /react-text --></h1><!-- react-text: 263 -->
<!-- /react-text --><p data-reactid="264"><!-- react-text: 265 -->Waigo provides you with a sensible directory layout for your Koa app and a clean architecture. It also comes with a bunch of basic boilerplate features that almost every site needs.<!-- /react-text --></p><!-- react-text: 266 -->
<!-- /react-text --><p data-reactid="267"><!-- react-text: 268 -->But the best part is that you don’t have to use anything you don’t want to. Almost every part of Waigo can be <!-- /react-text --><strong data-reactid="269"><!-- react-text: 270 -->cleanly<!-- /react-text --></strong><!-- react-text: 271 --> <!-- /react-text --><a href="/docs/#extend-and-override/" data-reactid="272">extended and overridden</a><!-- react-text: 273 --> within your app. Waigo gets out of your way when you need it to.<!-- /react-text --></p><!-- react-text: 274 -->
<!-- /react-text --><p data-reactid="275"><!-- react-text: 276 -->In addition to this, if you do build some functionality you wish to share between different Waigo projects you can make it re-usable by bundling it up as a <!-- /react-text --><a href="/docs/#plugins/" data-reactid="277">plugin</a><!-- react-text: 278 -->. Check out the <!-- /react-text --><a href="https://www.npmjs.org/browse/keyword/waigo" data-reactid="279"><!-- react-text: 280 -->current list of plugins<!-- /react-text --></a><!-- react-text: 281 --> to see what’s already available.<!-- /react-text --></p><!-- react-text: 282 -->
<!-- /react-text --><h1 data-reactid="283"><!-- react-text: 284 -->Getting started<!-- /react-text --></h1><!-- react-text: 285 -->
<!-- /react-text --><h2 data-reactid="286"><!-- react-text: 287 -->Installation<!-- /react-text --></h2><!-- react-text: 288 -->
<!-- /react-text --><p data-reactid="289"><!-- react-text: 290 -->Waigo requires <!-- /react-text --><strong data-reactid="291"><!-- react-text: 292 -->Node.js v4 or above<!-- /react-text --></strong><!-- react-text: 293 --> and <!-- /react-text --><strong data-reactid="294"><!-- react-text: 295 -->RethinkDB<!-- /react-text --></strong><!-- react-text: 296 --> (this is the default supported database). Install these on your system with the default settings.<!-- /react-text --></p><!-- react-text: 297 -->
<!-- /react-text --><p data-reactid="298"><!-- react-text: 299 -->Waigo comes with a <!-- /react-text --><a href="/docs/#command-line/" data-reactid="300">command-line interface</a><!-- react-text: 301 --> (CLI). It’s best to install Waigo as a global NPM module so that you can easily use this tool.<!-- /react-text --></p><!-- react-text: 302 -->
<!-- /react-text --><pre data-reactid="303"><code class="language-bash hljs" data-reactid="304"><!-- react-text: 305 -->$ npm install -g waigo
<!-- /react-text --></code></pre><!-- react-text: 306 -->
<!-- /react-text --><h2 data-reactid="307"><!-- react-text: 308 -->Running it<!-- /react-text --></h2><!-- react-text: 309 -->
<!-- /react-text --><p data-reactid="310"><!-- react-text: 311 -->If your app folder is located at e.g. <!-- /react-text --><code data-reactid="312"><!-- react-text: 313 -->/dev/myapp<!-- /react-text --></code><!-- react-text: 314 --> then Waigo will by
default assume that the source code for your app will be located in a
<!-- /react-text --><code data-reactid="315"><!-- react-text: 316 -->src<!-- /react-text --></code><!-- react-text: 317 --> subfolder, i.e. at <!-- /react-text --><code data-reactid="318"><!-- react-text: 319 -->/dev/myapp/src<!-- /react-text --></code><!-- react-text: 320 -->.<!-- /react-text --></p><!-- react-text: 321 -->
<!-- /react-text --><p data-reactid="322"><!-- react-text: 323 -->Inside your app folder run the following command:<!-- /react-text --></p><!-- react-text: 324 -->
<!-- /react-text --><pre data-reactid="325"><code class="language-bash hljs" data-reactid="326"><!-- react-text: 327 -->$ waigo init

[waigo-cli] NPM install waigo
[waigo-cli] NPM install co
... 
[waigo-cli] Creating: start-app.js
[waigo-cli] Creating: src/views/index.pug
<!-- /react-text --></code></pre><!-- react-text: 328 -->
<!-- /react-text --><p data-reactid="329"><!-- react-text: 330 -->You can now start your application by running:<!-- /react-text --></p><!-- react-text: 331 -->
<!-- /react-text --><pre data-reactid="332"><code class="language-bash hljs" data-reactid="333"><!-- react-text: 334 -->$ ./start-app.js
<!-- /react-text --></code></pre><!-- react-text: 335 -->
<!-- /react-text --><p data-reactid="336"><!-- react-text: 337 -->You will see something like:<!-- /react-text --></p><!-- react-text: 338 -->
<!-- /react-text --><pre data-reactid="339"><code class="language-bash hljs" data-reactid="340"><!-- react-text: 341 -->...
(RamMacbookPro.local-78163) [2016-04-06 11:01:41.450] [INFO] [app] - Startup complete
<!-- /react-text --></code></pre><!-- react-text: 342 -->
<!-- /react-text --><h2 data-reactid="343"><!-- react-text: 344 -->Code conventions<!-- /react-text --></h2><!-- react-text: 345 -->
<!-- /react-text --><p data-reactid="346"><!-- react-text: 347 -->When building your Waigo app keep in mind the following conventions:<!-- /react-text --></p><!-- react-text: 348 -->
<!-- /react-text --><ul data-reactid="349"><!-- react-text: 350 -->
<!-- /react-text --><li data-reactid="351"><!-- react-text: 352 -->
<!-- /react-text --><p data-reactid="353"><!-- react-text: 354 -->Class fields variables and/or methods prefixed with one or more underscores (e.g. <!-- /react-text --><code data-reactid="355"><!-- react-text: 356 -->_doc<!-- /react-text --></code><!-- react-text: 357 -->) are considered “internal” should not be accessed and/or relied upon externally.<!-- /react-text --></p><!-- react-text: 358 -->
<!-- /react-text --></li><!-- react-text: 359 -->
<!-- /react-text --><li data-reactid="360"><!-- react-text: 361 -->
<!-- /react-text --><p data-reactid="362"><!-- react-text: 363 -->If calling a function which only accepts callbacks wrap it within a Promise and use it in that manner instead. In the same way, don’t write methods which take callbacks - they should either return Promises or be generator functions.<!-- /react-text --></p><!-- react-text: 364 -->
<!-- /react-text --></li><!-- react-text: 365 -->
<!-- /react-text --><li data-reactid="366"><!-- react-text: 367 -->
<!-- /react-text --><p data-reactid="368"><!-- react-text: 369 -->Waigo uses and exposes the <!-- /react-text --><a href="https://lodash.com/docs" data-reactid="370"><!-- react-text: 371 -->lodash<!-- /react-text --></a><!-- react-text: 372 --> utility library so you don’t have to import it separately. Access it using <!-- /react-text --><code data-reactid="373"><!-- react-text: 374 -->require(&#x27;waigo&#x27;)._<!-- /react-text --></code><!-- react-text: 375 -->.<!-- /react-text --></p><!-- react-text: 376 -->
<!-- /react-text --></li><!-- react-text: 377 -->
<!-- /react-text --></ul><!-- react-text: 378 -->
<!-- /react-text --><h1 data-reactid="379"><!-- react-text: 380 -->Extend and Override<!-- /react-text --></h1><!-- react-text: 381 -->
<!-- /react-text --><p data-reactid="382"><!-- react-text: 383 -->In this section we will demonstrate how you can cleanly override almost all the default functionality provided by Waigo.<!-- /react-text --></p><!-- react-text: 384 -->
<!-- /react-text --><p data-reactid="385"><!-- react-text: 386 -->Let’s look at the default controller provided by Waigo, at <!-- /react-text --><code data-reactid="387"><!-- react-text: 388 -->&lt;waigo npm folder&gt;/src/controllers/index.js<!-- /react-text --></code><!-- react-text: 389 -->:<!-- /react-text --></p><!-- react-text: 390 -->
<!-- /react-text --><pre data-reactid="391"><code class="language-javascript hljs" data-reactid="392"><span class="hljs-meta" data-reactid="393"><!-- react-text: 394 -->&quot;use strict&quot;<!-- /react-text --></span><!-- react-text: 395 -->;

<!-- /react-text --><span class="hljs-comment" data-reactid="396"><!-- react-text: 397 -->/**
 * @fileOverview Main controller
 */<!-- /react-text --></span><!-- react-text: 398 -->

exports.main = <!-- /react-text --><span class="hljs-function" data-reactid="399"><span class="hljs-keyword" data-reactid="400"><!-- react-text: 401 -->function<!-- /react-text --></span><!-- react-text: 402 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="403"></span><!-- react-text: 404 -->) <!-- /react-text --></span><!-- react-text: 405 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="406"><!-- react-text: 407 -->yield<!-- /react-text --></span><!-- react-text: 408 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="409"><!-- react-text: 410 -->this<!-- /react-text --></span><!-- react-text: 411 -->.render(<!-- /react-text --><span class="hljs-string" data-reactid="412"><!-- react-text: 413 -->&#x27;index&#x27;<!-- /react-text --></span><!-- react-text: 414 -->);
};
<!-- /react-text --></code></pre><!-- react-text: 415 -->
<!-- /react-text --><p data-reactid="416"><!-- react-text: 417 -->Inside your app folder create <!-- /react-text --><code data-reactid="418"><!-- react-text: 419 -->src/controllers/index.js<!-- /react-text --></code><!-- react-text: 420 -->:<!-- /react-text --></p><!-- react-text: 421 -->
<!-- /react-text --><pre data-reactid="422"><code class="language-javascript hljs" data-reactid="423"><span class="hljs-comment" data-reactid="424"><!-- react-text: 425 -->// file: &lt;app folder&gt;/src/controllers/index.js<!-- /react-text --></span><!-- react-text: 426 -->

exports.main = <!-- /react-text --><span class="hljs-function" data-reactid="427"><span class="hljs-keyword" data-reactid="428"><!-- react-text: 429 -->function<!-- /react-text --></span><!-- react-text: 430 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="431"></span><!-- react-text: 432 -->) <!-- /react-text --></span><!-- react-text: 433 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="434"><!-- react-text: 435 -->this<!-- /react-text --></span><!-- react-text: 436 -->.body = <!-- /react-text --><span class="hljs-string" data-reactid="437"><!-- react-text: 438 -->&#x27;Hello world!&#x27;<!-- /react-text --></span><!-- react-text: 439 -->;
};
<!-- /react-text --></code></pre><!-- react-text: 440 -->
<!-- /react-text --><p data-reactid="441"><!-- react-text: 442 -->Now restart the app and refresh the page in the browser. You should see <!-- /react-text --><em data-reactid="443"><!-- react-text: 444 -->Hello world!<!-- /react-text --></em><!-- react-text: 445 --> printed on screen.<!-- /react-text --></p><!-- react-text: 446 -->
<!-- /react-text --><p data-reactid="447"><!-- react-text: 448 -->In order to understand why this happened we need to understand what Waigo’s module loader is and how it works.<!-- /react-text --></p><!-- react-text: 449 -->
<!-- /react-text --><h2 data-reactid="450"><!-- react-text: 451 -->Module loader<!-- /react-text --></h2><!-- react-text: 452 -->
<!-- /react-text --><p data-reactid="453"><!-- react-text: 454 -->During the startup phase Waigo will index its NPM module folder, <!-- /react-text --><a href="/docs/#plugins/" data-reactid="455">plugin</a><!-- react-text: 456 --> folders and finally your app folder for all <!-- /react-text --><code data-reactid="457"><!-- react-text: 458 -->.js<!-- /react-text --></code><!-- react-text: 459 --> files.<!-- /react-text --></p><!-- react-text: 460 -->
<!-- /react-text --><p data-reactid="461"><!-- react-text: 462 -->When a particular file needs to be loaded at runtime the convention is to call <!-- /react-text --><code data-reactid="463"><!-- react-text: 464 -->waigo.load()<!-- /react-text --></code><!-- react-text: 465 --> with the relative path to the file. In the above example Waigo will internally call <!-- /react-text --><code data-reactid="466"><!-- react-text: 467 -->waigo.load(&quot;controllers/index&quot;)<!-- /react-text --></code><!-- react-text: 468 --> to load the <!-- /react-text --><code data-reactid="469"><!-- react-text: 470 -->index<!-- /react-text --></code><!-- react-text: 471 --> controller. At this point the actual file which gets loaded and returned will be based on the first available location, in order:<!-- /react-text --></p><!-- react-text: 472 -->
<!-- /react-text --><ul data-reactid="473"><!-- react-text: 474 -->
<!-- /react-text --><li data-reactid="475"><code data-reactid="476"><!-- react-text: 477 -->&lt;app folder&gt;/src/controllers/index.js<!-- /react-text --></code></li><!-- react-text: 478 -->
<!-- /react-text --><li data-reactid="479"><code data-reactid="480"><!-- react-text: 481 -->&lt;plugin1 npm module&gt;/src/controllers/index.js<!-- /react-text --></code></li><!-- react-text: 482 -->
<!-- /react-text --><li data-reactid="483"><code data-reactid="484"><!-- react-text: 485 -->&lt;plugin2 npm module&gt;/src/controllers/index.js<!-- /react-text --></code></li><!-- react-text: 486 -->
<!-- /react-text --><li data-reactid="487"><!-- react-text: 488 -->…<!-- /react-text --></li><!-- react-text: 489 -->
<!-- /react-text --><li data-reactid="490"><code data-reactid="491"><!-- react-text: 492 -->&lt;waigo npm module folder&gt;/src/controllers/index.js<!-- /react-text --></code></li><!-- react-text: 493 -->
<!-- /react-text --></ul><!-- react-text: 494 -->
<!-- /react-text --><p data-reactid="495"><!-- react-text: 496 -->This loading mechanism allows you to:<!-- /react-text --></p><!-- react-text: 497 -->
<!-- /react-text --><ol data-reactid="498"><!-- react-text: 499 -->
<!-- /react-text --><li data-reactid="500"><!-- react-text: 501 -->Only load the parts of the framework you will actually use <!-- /react-text --><em data-reactid="502"><!-- react-text: 503 -->(good for
performance)<!-- /react-text --></em><!-- react-text: 504 -->.<!-- /react-text --></li><!-- react-text: 505 -->
<!-- /react-text --><li data-reactid="506"><!-- react-text: 507 -->Override any framework module file with your own version <!-- /react-text --><em data-reactid="508"><!-- react-text: 509 -->(extendability
and customisation)<!-- /react-text --></em><!-- react-text: 510 -->.<!-- /react-text --></li><!-- react-text: 511 -->
<!-- /react-text --></ol><!-- react-text: 512 -->
<!-- /react-text --><p data-reactid="513"><!-- react-text: 514 -->But what if you specifically wanted the version of the <!-- /react-text --><code data-reactid="515"><!-- react-text: 516 -->index<!-- /react-text --></code><!-- react-text: 517 --> conroller provided by the Waigo framework? Just prefix <!-- /react-text --><code data-reactid="518"><!-- react-text: 519 -->waigo:<!-- /react-text --></code><!-- react-text: 520 --> to the module file name:<!-- /react-text --></p><!-- react-text: 521 -->
<!-- /react-text --><pre data-reactid="522"><code class="language-javascript hljs" data-reactid="523"><span class="hljs-comment" data-reactid="524"><!-- react-text: 525 -->// this will load the version of controllers/index.js provided <!-- /react-text --></span><!-- react-text: 526 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="527"><!-- react-text: 528 -->// by Waigo and not the one provided by your app<!-- /react-text --></span><!-- react-text: 529 -->
waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="530"><!-- react-text: 531 -->&#x27;waigo:controllers/index&#x27;<!-- /react-text --></span><!-- react-text: 532 -->);   
<!-- /react-text --></code></pre><!-- react-text: 533 -->
<!-- /react-text --><p data-reactid="534"><!-- react-text: 535 -->If you wish to load the version from within a plugin then simply specify that plugin’s NPM module name as the prefix, e.g:<!-- /react-text --></p><!-- react-text: 536 -->
<!-- /react-text --><pre data-reactid="537"><code class="language-javascript hljs" data-reactid="538"><span class="hljs-comment" data-reactid="539"><!-- react-text: 540 -->// this will load the version of controllers/index.js provided <!-- /react-text --></span><!-- react-text: 541 -->
<!-- /react-text --><span class="hljs-comment" data-reactid="542"><!-- react-text: 543 -->// by plugin1 and not the one provided by your app or Waigo<!-- /react-text --></span><!-- react-text: 544 -->
waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="545"><!-- react-text: 546 -->&#x27;plugin1:controllers/index&#x27;<!-- /react-text --></span><!-- react-text: 547 -->);   
<!-- /react-text --></code></pre><!-- react-text: 548 -->
<!-- /react-text --><p data-reactid="549"><!-- react-text: 550 -->The above selective loading mechanism allows you to <!-- /react-text --><em data-reactid="551"><!-- react-text: 552 -->extend<!-- /react-text --></em><!-- react-text: 553 --> and not simply override. For instance, you could extend the the <!-- /react-text --><code data-reactid="554"><!-- react-text: 555 -->index<!-- /react-text --></code><!-- react-text: 556 --> controller as follows:<!-- /react-text --></p><!-- react-text: 557 -->
<!-- /react-text --><pre data-reactid="558"><code class="language-javascript hljs" data-reactid="559"><span class="hljs-keyword" data-reactid="560"><!-- react-text: 561 -->var<!-- /react-text --></span><!-- react-text: 562 --> waigo = <!-- /react-text --><span class="hljs-built_in" data-reactid="563"><!-- react-text: 564 -->require<!-- /react-text --></span><!-- react-text: 565 -->(<!-- /react-text --><span class="hljs-string" data-reactid="566"><!-- react-text: 567 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 568 -->);

<!-- /react-text --><span class="hljs-comment" data-reactid="569"><!-- react-text: 570 -->// export all methods from Waigo framework index controller<!-- /react-text --></span><!-- react-text: 571 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="572"><!-- react-text: 573 -->module<!-- /react-text --></span><!-- react-text: 574 -->.exports = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="575"><!-- react-text: 576 -->&#x27;waigo:controllers/index&#x27;<!-- /react-text --></span><!-- react-text: 577 -->);    

<!-- /react-text --><span class="hljs-comment" data-reactid="578"><!-- react-text: 579 -->// add more methods<!-- /react-text --></span><!-- react-text: 580 -->
exports.handleSubmission = <!-- /react-text --><span class="hljs-function" data-reactid="581"><span class="hljs-keyword" data-reactid="582"><!-- react-text: 583 -->function<!-- /react-text --></span><!-- react-text: 584 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="585"></span><!-- react-text: 586 -->) <!-- /react-text --></span><!-- react-text: 587 -->{... }
<!-- /react-text --></code></pre><!-- react-text: 588 -->
<!-- /react-text --><p data-reactid="589"><!-- react-text: 590 -->Note that the module loader also scans for <!-- /react-text --><a href="/docs/#views-and-output-formats/" data-reactid="591">view templates</a><!-- react-text: 592 -->, allowing you to re-use view templates provided by the Waigo framework and plugins. However the module loader does not scan the following sub paths within each folder tree:<!-- /react-text --></p><!-- react-text: 593 -->
<!-- /react-text --><ul data-reactid="594"><!-- react-text: 595 -->
<!-- /react-text --><li data-reactid="596"><code data-reactid="597"><!-- react-text: 598 -->src/views/emailTemplates<!-- /react-text --></code><!-- react-text: 599 --> - <!-- /react-text --><a href="/docs/#email-system/" data-reactid="600">mailer</a><!-- react-text: 601 --> templates<!-- /react-text --></li><!-- react-text: 602 -->
<!-- /react-text --><li data-reactid="603"><code data-reactid="604"><!-- react-text: 605 -->src/frontend<!-- /react-text --></code><!-- react-text: 606 --> - all frontend stuff<!-- /react-text --></li><!-- react-text: 607 -->
<!-- /react-text --><li data-reactid="608"><code data-reactid="609"><!-- react-text: 610 -->cli/data<!-- /react-text --></code><!-- react-text: 611 --> - data for use by <!-- /react-text --><a href="/docs/#command-line/" data-reactid="612">cli</a><!-- react-text: 613 --> commands<!-- /react-text --></li><!-- react-text: 614 -->
<!-- /react-text --></ul><!-- react-text: 615 -->
<!-- /react-text --><h2 data-reactid="616"><!-- react-text: 617 -->Plugins<!-- /react-text --></h2><!-- react-text: 618 -->
<!-- /react-text --><p data-reactid="619"><!-- react-text: 620 -->As mentioned earlier, You can make anything you build re-useable by bundling it
up as a plugin. Plugins are just NPM modules and are thus very easy to share with others, and come with all the benefits that are available to normal NPM modules.<!-- /react-text --></p><!-- react-text: 621 -->
<!-- /react-text --><p data-reactid="622"><!-- react-text: 623 -->By separating non-core functionality into plugins (which can then be thoroughly
documented and tested) we encourage code re-use across projects. Plugins help to keep the core Waigo framework more focussed, flexible and increase the overall quality of code in the Waigo ecosystem.<!-- /react-text --></p><!-- react-text: 624 -->
<!-- /react-text --><h3 data-reactid="625"><!-- react-text: 626 -->Loading plugins<!-- /react-text --></h3><!-- react-text: 627 -->
<!-- /react-text --><p data-reactid="628"><!-- react-text: 629 -->Waigo automatically tries to work out what plugins are
available by loading in the <!-- /react-text --><code data-reactid="630"><!-- react-text: 631 -->package.json<!-- /react-text --></code><!-- react-text: 632 --> file. By default it searches the
<!-- /react-text --><code data-reactid="633"><!-- react-text: 634 -->dependencies<!-- /react-text --></code><!-- react-text: 635 -->, <!-- /react-text --><code data-reactid="636"><!-- react-text: 637 -->devDependencies<!-- /react-text --></code><!-- react-text: 638 --> and <!-- /react-text --><code data-reactid="639"><!-- react-text: 640 -->peerDependencies<!-- /react-text --></code><!-- react-text: 641 --> lists for any modules
which are prefixed with <!-- /react-text --><code data-reactid="642"><!-- react-text: 643 -->waigo-<!-- /react-text --></code><!-- react-text: 644 --> and assumes that these are plugins which
should be loaded.<!-- /react-text --></p><!-- react-text: 645 -->
<!-- /react-text --><p data-reactid="646"><!-- react-text: 647 -->However you can override every aspect of this search. The <!-- /react-text --><a href="https://github.com/waigo/waigo/blob/master/src/loader.js" data-reactid="648"><!-- react-text: 649 -->waigo.init()<!-- /react-text --></a><!-- react-text: 650 --> method gives you the available options:<!-- /react-text --></p><!-- react-text: 651 -->
<!-- /react-text --><pre data-reactid="652"><code class="language-javascript hljs" data-reactid="653"><span class="hljs-comment" data-reactid="654"><!-- react-text: 655 -->/**
 * ...
 * @param {Object} [options.plugins] Plugin loading configuration.
 * @param {Array} [options.plugins.names] Plugins to load. If omitted then other options are used to load plugins.
 * @param {Array} [options.plugins.glob] Regexes specifying plugin naming conventions. Default is `waigo-*`.
 * @param {String|Object} [options.plugins.config] JSON config containing names of plugins to load. If a string is given then it assumed to be the path of a Javasript file. Default is to load `package.json`.
 * @param {Array} [options.plugins.configKey] Names of keys in JSON config whose values contain names of plugins. Default is `dependencies, devDependencies, peerDependencies`.
 ...
*/<!-- /react-text --></span><!-- react-text: 656 -->
<!-- /react-text --></code></pre><!-- react-text: 657 -->
<!-- /react-text --><p data-reactid="658"><!-- react-text: 659 -->You can list the desired plugins in a config file of your
choosing and then supply the path to this file. Or you can directly supply a
config <!-- /react-text --><code data-reactid="660"><!-- react-text: 661 -->Object<!-- /react-text --></code><!-- react-text: 662 --> itself. And you can override the plugin naming conventions.<!-- /react-text --></p><!-- react-text: 663 -->
<!-- /react-text --><h3 data-reactid="664"><!-- react-text: 665 -->Example<!-- /react-text --></h3><!-- react-text: 666 -->
<!-- /react-text --><p data-reactid="667"><!-- react-text: 668 -->The <!-- /react-text --><a href="https://www.npmjs.org/package/waigo-sitemap" data-reactid="669"><!-- react-text: 670 -->waigo-sitemap<!-- /react-text --></a><!-- react-text: 671 --> plugin adds a cron job which submits a sitemap for your site to Google and Bing once a day. It provides the following modules files:<!-- /react-text --></p><!-- react-text: 672 -->
<!-- /react-text --><ul data-reactid="673"><!-- react-text: 674 -->
<!-- /react-text --><li data-reactid="675"><code data-reactid="676"><!-- react-text: 677 -->src/support/cronTasks/submitSitemap.js<!-- /react-text --></code></li><!-- react-text: 678 -->
<!-- /react-text --></ul><!-- react-text: 679 -->
<!-- /react-text --><p data-reactid="680"><!-- react-text: 681 -->To get the plugin use <!-- /react-text --><code data-reactid="682"><!-- react-text: 683 -->npm<!-- /react-text --></code><!-- react-text: 684 -->:<!-- /react-text --></p><!-- react-text: 685 -->
<!-- /react-text --><pre data-reactid="686"><code class="language-bash hljs" data-reactid="687"><span class="hljs-comment" data-reactid="688"><!-- react-text: 689 --># --save ensures it gets added as dependency in package.json (so that Waigo will find it)<!-- /react-text --></span><!-- react-text: 690 -->
npm install --save waigo-sitemap 
<!-- /react-text --></code></pre><!-- react-text: 691 -->
<!-- /react-text --><p data-reactid="692"><!-- react-text: 693 -->You can of course override any module file the plugin provides with your own:<!-- /react-text --></p><!-- react-text: 694 -->
<!-- /react-text --><pre data-reactid="695"><code class="language-javascript hljs" data-reactid="696"><span class="hljs-comment" data-reactid="697"><!-- react-text: 698 -->// file: &lt;app folder&gt;/src/support/cronTasks/submitSitemap.js<!-- /react-text --></span><!-- react-text: 699 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="700"><!-- react-text: 701 -->module<!-- /react-text --></span><!-- react-text: 702 -->.exports = {
  schedule: <!-- /react-text --><span class="hljs-string" data-reactid="703"><!-- react-text: 704 -->&#x27;0 0 0 * * *&#x27;<!-- /react-text --></span><!-- react-text: 705 -->,  <!-- /react-text --><span class="hljs-comment" data-reactid="706"><!-- react-text: 707 -->// every day at midnight<!-- /react-text --></span><!-- react-text: 708 -->
  handler: <!-- /react-text --><span class="hljs-function" data-reactid="709"><span class="hljs-keyword" data-reactid="710"><!-- react-text: 711 -->function<!-- /react-text --></span><!-- react-text: 712 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="713"><!-- react-text: 714 -->app<!-- /react-text --></span><!-- react-text: 715 -->) <!-- /react-text --></span><!-- react-text: 716 -->{
  	<!-- /react-text --><span class="hljs-built_in" data-reactid="717"><!-- react-text: 718 -->console<!-- /react-text --></span><!-- react-text: 719 -->.log(<!-- /react-text --><span class="hljs-string" data-reactid="720"><!-- react-text: 721 -->&#x27;do nothing!&#x27;<!-- /react-text --></span><!-- react-text: 722 -->);
  }
};
<!-- /react-text --></code></pre><!-- react-text: 723 -->
<!-- /react-text --><p data-reactid="724"><!-- react-text: 725 -->Calls made to <!-- /react-text --><code data-reactid="726"><!-- react-text: 727 -->waigo.load(&#x27;support/cronTasks/submitSitemap&#x27;)<!-- /react-text --></code><!-- react-text: 728 --> will now load your app version
rather then the plugin version.<!-- /react-text --></p><!-- react-text: 729 -->
<!-- /react-text --><h3 data-reactid="730"><!-- react-text: 731 -->Plugin conflicts<!-- /react-text --></h3><!-- react-text: 732 -->
<!-- /react-text --><p data-reactid="733"><!-- react-text: 734 -->What would happen if you had two plugins which both provided the same
file? in this case the call to <!-- /react-text --><code data-reactid="735"><!-- react-text: 736 -->waigo.init()<!-- /react-text --></code><!-- react-text: 737 --> would fail with an error:<!-- /react-text --></p><!-- react-text: 738 -->
<!-- /react-text --><pre data-reactid="739"><code class="language-bash hljs" data-reactid="740"><!-- react-text: 741 -->Error: Path <!-- /react-text --><span class="hljs-string" data-reactid="742"><!-- react-text: 743 -->&quot;path/to/file&quot;<!-- /react-text --></span><!-- react-text: 744 --> has more than one plugin implementation to choose from: waigo-plugin1, waigo-plugin2, ...
<!-- /react-text --></code></pre><!-- react-text: 745 -->
<!-- /react-text --><p data-reactid="746"><!-- react-text: 747 -->If you need to use both plugins (maybe because they provide other useful
functionality) then pick which plugin’s implementation you want to use by
providing a version of the file within your app folder. For
example, if you wanted Waigo to use the implementation provided by <!-- /react-text --><code data-reactid="748"><!-- react-text: 749 -->waigo- plugin1<!-- /react-text --></code><!-- react-text: 750 --> then you would do:<!-- /react-text --></p><!-- react-text: 751 -->
<!-- /react-text --><pre data-reactid="752"><code class="language-javascript hljs" data-reactid="753"><span class="hljs-comment" data-reactid="754"><!-- react-text: 755 -->// file: &lt;app folder&gt;/path/to/file<!-- /react-text --></span><!-- react-text: 756 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="757"><!-- react-text: 758 -->var<!-- /react-text --></span><!-- react-text: 759 --> waigo = <!-- /react-text --><span class="hljs-built_in" data-reactid="760"><!-- react-text: 761 -->require<!-- /react-text --></span><!-- react-text: 762 -->(<!-- /react-text --><span class="hljs-string" data-reactid="763"><!-- react-text: 764 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 765 -->);

<!-- /react-text --><span class="hljs-comment" data-reactid="766"><!-- react-text: 767 -->// use the implementation from waigo-plugin1<!-- /react-text --></span><!-- react-text: 768 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="769"><!-- react-text: 770 -->module<!-- /react-text --></span><!-- react-text: 771 -->.exports = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="772"><!-- react-text: 773 -->&#x27;waigo-plugin1:path/to/file&#x27;<!-- /react-text --></span><!-- react-text: 774 -->);    
<!-- /react-text --></code></pre><!-- react-text: 775 -->
<!-- /react-text --><h3 data-reactid="776"><!-- react-text: 777 -->Publishing<!-- /react-text --></h3><!-- react-text: 778 -->
<!-- /react-text --><p data-reactid="779"><!-- react-text: 780 -->To create and publish your own plugin to the wider community please follow
these guidelines:<!-- /react-text --></p><!-- react-text: 781 -->
<!-- /react-text --><ul data-reactid="782"><!-- react-text: 783 -->
<!-- /react-text --><li data-reactid="784"><!-- react-text: 785 -->Check to see if what you’ve made is worth putting into a plugin. For instance
it’s very easy to re-use existing <!-- /react-text --><a href="http://koajs.com" data-reactid="786"><!-- react-text: 787 -->koa<!-- /react-text --></a><!-- react-text: 788 --> middleware in Waigo without
needing to create plugins.<!-- /react-text --></li><!-- react-text: 789 -->
<!-- /react-text --><li data-reactid="790"><!-- react-text: 791 -->Ensure your plugin name is prefixed with <!-- /react-text --><code data-reactid="792"><!-- react-text: 793 -->waigo-<!-- /react-text --></code><!-- react-text: 794 --> so that users and Waigo
itself can easily find it and use it.<!-- /react-text --></li><!-- react-text: 795 -->
<!-- /react-text --><li data-reactid="796"><!-- react-text: 797 -->In your plugin’s <!-- /react-text --><code data-reactid="798"><!-- react-text: 799 -->package.json<!-- /react-text --></code><!-- react-text: 800 --> set the <!-- /react-text --><code data-reactid="801"><!-- react-text: 802 -->main<!-- /react-text --></code><!-- react-text: 803 --> key is set to <!-- /react-text --><code data-reactid="804"><!-- react-text: 805 -->index.js<!-- /react-text --></code><!-- react-text: 806 -->. Create a dummy
<!-- /react-text --><code data-reactid="807"><!-- react-text: 808 -->index.js<!-- /react-text --></code><!-- react-text: 809 --> file in your plugin’s root folder. This is needed to be able to load and
use your plugin.<!-- /react-text --></li><!-- react-text: 810 -->
<!-- /react-text --><li data-reactid="811"><!-- react-text: 812 -->Write a good <!-- /react-text --><a href="http://README.md" data-reactid="813"><!-- react-text: 814 -->README.md<!-- /react-text --></a><!-- react-text: 815 --> for your plugin explaining what it’s for and how to use it.<!-- /react-text --></li><!-- react-text: 816 -->
<!-- /react-text --><li data-reactid="817"><!-- react-text: 818 -->Add automated unit tests for your plugin. Look at existing plugins to learn
best practices.<!-- /react-text --></li><!-- react-text: 819 -->
<!-- /react-text --><li data-reactid="820"><!-- react-text: 821 -->In your <!-- /react-text --><code data-reactid="822"><!-- react-text: 823 -->package.json<!-- /react-text --></code><!-- react-text: 824 --> tag your plugin with the <!-- /react-text --><code data-reactid="825"><!-- react-text: 826 -->waigo<!-- /react-text --></code><!-- react-text: 827 --> keyword so that
users can easily search for it.<!-- /react-text --></li><!-- react-text: 828 -->
<!-- /react-text --></ul><!-- react-text: 829 -->
<!-- /react-text --><p data-reactid="830"><!-- react-text: 831 -->To see a list of all available plugins visit
<!-- /react-text --><a href="https://www.npmjs.org/browse/keyword/waigoplugin" data-reactid="832"><!-- react-text: 833 -->https://www.npmjs.org/browse/keyword/waigo<!-- /react-text --></a><!-- react-text: 834 -->.<!-- /react-text --></p><!-- react-text: 835 -->
<!-- /react-text --><h1 data-reactid="836"><!-- react-text: 837 -->Command-line<!-- /react-text --></h1><!-- react-text: 838 -->
<!-- /react-text --><p data-reactid="839"><!-- react-text: 840 -->In the <!-- /react-text --><a href="/docs/#getting-started/" data-reactid="841">Getting Started</a><!-- react-text: 842 --> section you used the Waigo command-line interface (CLI) to get a
working application up and running.<!-- /react-text --></p><!-- react-text: 843 -->
<!-- /react-text --><p data-reactid="844"><!-- react-text: 845 -->Even if you install Waigo globally in order to use the CLI, it’s smart enough to delegate control to your local
installation of Waigo (in your <!-- /react-text --><code data-reactid="846"><!-- react-text: 847 -->node_modules<!-- /react-text --></code><!-- react-text: 848 --> folder) if one is present.<!-- /react-text --></p><!-- react-text: 849 -->
<!-- /react-text --><p data-reactid="850"><!-- react-text: 851 -->The available CLI commands can be seen by typing:<!-- /react-text --></p><!-- react-text: 852 -->
<!-- /react-text --><pre data-reactid="853"><code class="language-bash hljs" data-reactid="854"><!-- react-text: 855 -->$ waigo --help

  Usage: waigo [options] [<!-- /react-text --><span class="hljs-built_in" data-reactid="856"><!-- react-text: 857 -->command<!-- /react-text --></span><!-- react-text: 858 -->]

  Commands:

    init-gulp   Initialise and create a skeleton Gulpfile and associated tasks
    init        Initialise and create a skeleton Waigo app

  Options:

    -h, --help     output usage information
    -V, --version  output the version number
<!-- /react-text --></code></pre><!-- react-text: 859 -->
<!-- /react-text --><p data-reactid="860"><!-- react-text: 861 -->Further help is available for each command. For example to find out what
arguments are possible for the <!-- /react-text --><code data-reactid="862"><!-- react-text: 863 -->init<!-- /react-text --></code><!-- react-text: 864 --> command (which we used in the
<!-- /react-text --><a href="/docs/#hello-world/" data-reactid="865">Hello World</a><!-- react-text: 866 --> example earlier):<!-- /react-text --></p><!-- react-text: 867 -->
<!-- /react-text --><pre data-reactid="868"><code class="language-bash hljs" data-reactid="869"><!-- react-text: 870 -->$ waigo init --help

  Usage: init [options]

  Options:

    -h, --help             output usage information
    ...
<!-- /react-text --></code></pre><!-- react-text: 871 -->
<!-- /react-text --><p data-reactid="872"><!-- react-text: 873 -->The <!-- /react-text --><code data-reactid="874"><!-- react-text: 875 -->&lt;waigo npm folder&gt;/src/cli/data<!-- /react-text --></code><!-- react-text: 876 --> folder contains
any data to be used the CLI commands (e.g. script templates) and does not get
scanned by the Waigo <!-- /react-text --><a href="/docs/#module-loader/" data-reactid="877">module loader</a><!-- react-text: 878 -->.<!-- /react-text --></p><!-- react-text: 879 -->
<!-- /react-text --><h2 data-reactid="880"><!-- react-text: 881 -->Custom commands<!-- /react-text --></h2><!-- react-text: 882 -->
<!-- /react-text --><p data-reactid="883"><!-- react-text: 884 -->Every CLI command is implemented a file within <!-- /react-text --><code data-reactid="885"><!-- react-text: 886 -->&lt;waigo npm folder&gt;/src/cli<!-- /react-text --></code><!-- react-text: 887 -->. If you wish to add your own commands or override the defaults then you must also place your implementations within <!-- /react-text --><code data-reactid="888"><!-- react-text: 889 -->&lt;app folder&gt;/src/cli<!-- /react-text --></code><!-- react-text: 890 -->. The
CLI executable scans this path at startup and loads in all available commands.<!-- /react-text --></p><!-- react-text: 891 -->
<!-- /react-text --><p data-reactid="892"><!-- react-text: 893 -->All CLI commands must be implemented as concrete subclasses of
<!-- /react-text --><a href="https://github.com/waigo/waigo/blob/master/src/support/cliCommand.js" data-reactid="894"><code data-reactid="895"><!-- react-text: 896 -->AbstractCommand<!-- /react-text --></code></a><!-- react-text: 897 -->. This
base class provides a number of useful utility methods for use by actual
commands.<!-- /react-text --></p><!-- react-text: 898 -->
<!-- /react-text --><h1 data-reactid="899"><!-- react-text: 900 -->Configuration<!-- /react-text --></h1><!-- react-text: 901 -->
<!-- /react-text --><p data-reactid="902"><!-- react-text: 903 -->Configuration for your application is loaded during <!-- /react-text --><a href="/docs/#startup/" data-reactid="904">startup</a><!-- react-text: 905 --> and is
always accessible at <!-- /react-text --><code data-reactid="906"><!-- react-text: 907 -->app.config<!-- /react-text --></code><!-- react-text: 908 --> within your backend code and through the <!-- /react-text --><code data-reactid="909"><!-- react-text: 910 -->config<!-- /react-text --></code><!-- react-text: 911 --> variable within your view templates.<!-- /react-text --></p><!-- react-text: 912 -->
<!-- /react-text --><p data-reactid="913"><!-- react-text: 914 -->The <!-- /react-text --><code data-reactid="915"><!-- react-text: 916 -->src/config<!-- /react-text --></code><!-- react-text: 917 --> folder path holds the configuration files.
Each configuration file exports a function which accepts the current
configuration object as a parameter. This object can then be modified:<!-- /react-text --></p><!-- react-text: 918 -->
<!-- /react-text --><pre data-reactid="919"><code class="language-javascript hljs" data-reactid="920"><span class="hljs-built_in" data-reactid="921"><!-- react-text: 922 -->module<!-- /react-text --></span><!-- react-text: 923 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="924"><span class="hljs-keyword" data-reactid="925"><!-- react-text: 926 -->function<!-- /react-text --></span><!-- react-text: 927 -->(<!-- /react-text --><span class="hljs-params" data-reactid="928"><!-- react-text: 929 -->config<!-- /react-text --></span><!-- react-text: 930 -->) <!-- /react-text --></span><!-- react-text: 931 -->{
  <!-- /react-text --><span class="hljs-comment" data-reactid="932"><!-- react-text: 933 -->// modify config in here<!-- /react-text --></span><!-- react-text: 934 -->
};
<!-- /react-text --></code></pre><!-- react-text: 935 -->
<!-- /react-text --><p data-reactid="936"><!-- react-text: 937 -->Each successively loaded configuration file gets passed the same configuration
object. As we’ll see in the next section this makes it easy to customise the
application configuration depending on the mode in which we’re running in -
production, testing, etc.<!-- /react-text --></p><!-- react-text: 938 -->
<!-- /react-text --><h2 data-reactid="939"><!-- react-text: 940 -->File load order<!-- /react-text --></h2><!-- react-text: 941 -->
<!-- /react-text --><p data-reactid="942"><!-- react-text: 943 -->The <!-- /react-text --><code data-reactid="944"><!-- react-text: 945 -->config/index.js<!-- /react-text --></code><!-- react-text: 946 --> file is the configuration loader. It looks for and
loads configuration files in the following order:<!-- /react-text --></p><!-- react-text: 947 -->
<!-- /react-text --><ol data-reactid="948"><!-- react-text: 949 -->
<!-- /react-text --><li data-reactid="950"><code data-reactid="951"><!-- react-text: 952 -->config/base.js<!-- /react-text --></code><!-- react-text: 953 --> - <!-- /react-text --><strong data-reactid="954"><!-- react-text: 955 -->required<!-- /react-text --></strong></li><!-- react-text: 956 -->
<!-- /react-text --><li data-reactid="957"><code data-reactid="958"><!-- react-text: 959 -->config/&lt;NODE_ENV&gt;.js<!-- /react-text --></code></li><!-- react-text: 960 -->
<!-- /react-text --><li data-reactid="961"><code data-reactid="962"><!-- react-text: 963 -->config/&lt;NODE_ENV&gt;.&lt;current user&gt;.js<!-- /react-text --></code></li><!-- react-text: 964 -->
<!-- /react-text --></ol><!-- react-text: 965 -->
<!-- /react-text --><p data-reactid="966"><!-- react-text: 967 -->The <!-- /react-text --><code data-reactid="968"><!-- react-text: 969 -->config/base.js<!-- /react-text --></code><!-- react-text: 970 --> file sets the configuration common to all modes in
which the application may run.<!-- /react-text --></p><!-- react-text: 971 -->
<!-- /react-text --><p data-reactid="972"><!-- react-text: 973 -->The configuration module files following this one are optional. Which ones get
loaded depends on the value of the <!-- /react-text --><code data-reactid="974"><!-- react-text: 975 -->NODE_ENV<!-- /react-text --></code><!-- react-text: 976 --> environment variable. If this is
not set then we assume its value to be <!-- /react-text --><code data-reactid="977"><!-- react-text: 978 -->development<!-- /react-text --></code><!-- react-text: 979 -->.<!-- /react-text --></p><!-- react-text: 980 -->
<!-- /react-text --><p data-reactid="981"><em data-reactid="982"><!-- react-text: 983 -->Note: When running your application in a production environment ensure you
set the <!-- /react-text --><code data-reactid="984"><!-- react-text: 985 -->NODE_ENV<!-- /react-text --></code><!-- react-text: 986 --> environment variable to <!-- /react-text --><code data-reactid="987"><!-- react-text: 988 -->production<!-- /react-text --></code><!-- react-text: 989 --> or something similar.<!-- /react-text --></em></p><!-- react-text: 990 -->
<!-- /react-text --><p data-reactid="991"><!-- react-text: 992 -->The final configuration file which gets loaded is associated with the mode in
which the application is running as well as the id of the user who is
executing the current application. This conveniently allows different users to
further customise the configuration according to their own needs.<!-- /react-text --></p><!-- react-text: 993 -->
<!-- /react-text --><p data-reactid="994"><!-- react-text: 995 -->Let’s look at a concrete example…<!-- /react-text --></p><!-- react-text: 996 -->
<!-- /react-text --><p data-reactid="997"><!-- react-text: 998 -->Let’s say <!-- /react-text --><code data-reactid="999"><!-- react-text: 1000 -->NODE_ENV<!-- /react-text --></code><!-- react-text: 1001 --> is set to <!-- /react-text --><code data-reactid="1002"><!-- react-text: 1003 -->test<!-- /react-text --></code><!-- react-text: 1004 --> mode and that the user id of the process
is <!-- /react-text --><code data-reactid="1005"><!-- react-text: 1006 -->www-data<!-- /react-text --></code><!-- react-text: 1007 -->. The configuration loader will initialise a configuration object and then pass it to each of the following files in the
given order:<!-- /react-text --></p><!-- react-text: 1008 -->
<!-- /react-text --><ol data-reactid="1009"><!-- react-text: 1010 -->
<!-- /react-text --><li data-reactid="1011"><code data-reactid="1012"><!-- react-text: 1013 -->config/base.js<!-- /react-text --></code></li><!-- react-text: 1014 -->
<!-- /react-text --><li data-reactid="1015"><code data-reactid="1016"><!-- react-text: 1017 -->config/test.js<!-- /react-text --></code></li><!-- react-text: 1018 -->
<!-- /react-text --><li data-reactid="1019"><code data-reactid="1020"><!-- react-text: 1021 -->config/test.www-data.js<!-- /react-text --></code></li><!-- react-text: 1022 -->
<!-- /react-text --></ol><!-- react-text: 1023 -->
<!-- /react-text --><p data-reactid="1024"><em data-reactid="1025"><!-- react-text: 1026 -->Note: Once stared the application mode is accessible at <!-- /react-text --><code data-reactid="1027"><!-- react-text: 1028 -->config.user<!-- /react-text --></code><!-- react-text: 1029 -->and the id of the user owning the process at <!-- /react-text --><code data-reactid="1030"><!-- react-text: 1031 -->config.user<!-- /react-text --></code><!-- react-text: 1032 -->.<!-- /react-text --></em></p><!-- react-text: 1033 -->
<!-- /react-text --><h2 data-reactid="1034"><!-- react-text: 1035 -->Re-using framework version<!-- /react-text --></h2><!-- react-text: 1036 -->
<!-- /react-text --><p data-reactid="1037"><!-- react-text: 1038 -->Let’s say we want to provide <!-- /react-text --><code data-reactid="1039"><!-- react-text: 1040 -->config/base.js<!-- /react-text --></code><!-- react-text: 1041 --> in our app but that we want to re-use
some of the configuration provided by Waigo’s version of this file. We can easily do this as follows:<!-- /react-text --></p><!-- react-text: 1042 -->
<!-- /react-text --><pre data-reactid="1043"><code class="language-javascript hljs" data-reactid="1044"><span class="hljs-comment" data-reactid="1045"><!-- react-text: 1046 -->// file: &lt;app folder&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 1047 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1048"><!-- react-text: 1049 -->module<!-- /react-text --></span><!-- react-text: 1050 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1051"><span class="hljs-keyword" data-reactid="1052"><!-- react-text: 1053 -->function<!-- /react-text --></span><!-- react-text: 1054 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1055"><!-- react-text: 1056 -->config<!-- /react-text --></span><!-- react-text: 1057 -->) <!-- /react-text --></span><!-- react-text: 1058 -->{
  <!-- /react-text --><span class="hljs-comment" data-reactid="1059"><!-- react-text: 1060 -->// re-use config/base from framework<!-- /react-text --></span><!-- react-text: 1061 -->
  waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1062"><!-- react-text: 1063 -->&#x27;waigo:config/base&#x27;<!-- /react-text --></span><!-- react-text: 1064 -->)(config);

  <!-- /react-text --><span class="hljs-comment" data-reactid="1065"><!-- react-text: 1066 -->// now we override the necessary bits for our app...<!-- /react-text --></span><!-- react-text: 1067 -->
  config.baseURL = <!-- /react-text --><span class="hljs-string" data-reactid="1068"><!-- react-text: 1069 -->&#x27;http://example.com&#x27;<!-- /react-text --></span><!-- react-text: 1070 -->;
  config.port = <!-- /react-text --><span class="hljs-number" data-reactid="1071"><!-- react-text: 1072 -->9000<!-- /react-text --></span><!-- react-text: 1073 -->;  
};
<!-- /react-text --></code></pre><!-- react-text: 1074 -->
<!-- /react-text --><h1 data-reactid="1075"><!-- react-text: 1076 -->Startup and Shutdown<!-- /react-text --></h1><!-- react-text: 1077 -->
<!-- /react-text --><p data-reactid="1078"><!-- react-text: 1079 -->When the application starts up, Waigo runs the configured startup steps.<!-- /react-text --></p><!-- react-text: 1080 -->
<!-- /react-text --><pre data-reactid="1081"><code class="language-javascript hljs" data-reactid="1082"><span class="hljs-comment" data-reactid="1083"><!-- react-text: 1084 -->// file: &lt;waigo npm module&gt;/src/application.js<!-- /react-text --></span><!-- react-text: 1085 -->

App.start = <!-- /react-text --><span class="hljs-function" data-reactid="1086"><span class="hljs-keyword" data-reactid="1087"><!-- react-text: 1088 -->function<!-- /react-text --></span><!-- react-text: 1089 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="1090"><!-- react-text: 1091 -->...<!-- /react-text --></span><!-- react-text: 1092 -->) <!-- /react-text --></span><!-- react-text: 1093 -->{
  ...

  for (<!-- /react-text --><span class="hljs-keyword" data-reactid="1094"><!-- react-text: 1095 -->let<!-- /react-text --></span><!-- react-text: 1096 --> stepName <!-- /react-text --><span class="hljs-keyword" data-reactid="1097"><!-- react-text: 1098 -->of<!-- /react-text --></span><!-- react-text: 1099 --> app.config.startupSteps) {
    ...
    yield* waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1100"><!-- react-text: 1101 -->&#x27;support/startup/&#x27;<!-- /react-text --></span><!-- react-text: 1102 --> + stepName)(app);
  }
};
<!-- /react-text --></code></pre><!-- react-text: 1103 -->
<!-- /react-text --><p data-reactid="1104"><!-- react-text: 1105 -->Startup modules are responsible for initialising the
various aspects of your application. For example, here is the <!-- /react-text --><code data-reactid="1106"><!-- react-text: 1107 -->middleware<!-- /react-text --></code><!-- react-text: 1108 -->
startup step:<!-- /react-text --></p><!-- react-text: 1109 -->
<!-- /react-text --><pre data-reactid="1110"><code class="language-javascript hljs" data-reactid="1111"><span class="hljs-comment" data-reactid="1112"><!-- react-text: 1113 -->// file: &lt;waigo npm module&gt;/src/support/startup/middleware.js<!-- /react-text --></span><!-- react-text: 1114 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1115"><!-- react-text: 1116 -->module<!-- /react-text --></span><!-- react-text: 1117 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1118"><span class="hljs-keyword" data-reactid="1119"><!-- react-text: 1120 -->function<!-- /react-text --></span><!-- react-text: 1121 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="1122"><!-- react-text: 1123 -->app<!-- /react-text --></span><!-- react-text: 1124 -->) <!-- /react-text --></span><!-- react-text: 1125 -->{
  app.logger.debug(<!-- /react-text --><span class="hljs-string" data-reactid="1126"><!-- react-text: 1127 -->&#x27;Setting up common middleware&#x27;<!-- /react-text --></span><!-- react-text: 1128 -->);

  <!-- /react-text --><span class="hljs-keyword" data-reactid="1129"><!-- react-text: 1130 -->for<!-- /react-text --></span><!-- react-text: 1131 --> (<!-- /react-text --><span class="hljs-keyword" data-reactid="1132"><!-- react-text: 1133 -->let<!-- /react-text --></span><!-- react-text: 1134 --> m <!-- /react-text --><span class="hljs-keyword" data-reactid="1135"><!-- react-text: 1136 -->of<!-- /react-text --></span><!-- react-text: 1137 --> app.config.middleware.ALL._order) {
    app.logger.debug(<!-- /react-text --><span class="hljs-string" data-reactid="1138"><!-- react-text: 1139 -->`Loading middleware: <!-- /react-text --><span class="hljs-subst" data-reactid="1140"><!-- react-text: 1141 -->${m}<!-- /react-text --></span><!-- react-text: 1142 -->`<!-- /react-text --></span><!-- react-text: 1143 -->);

    app.use(waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1144"><!-- react-text: 1145 -->`support/middleware/<!-- /react-text --><span class="hljs-subst" data-reactid="1146"><!-- react-text: 1147 -->${m}<!-- /react-text --></span><!-- react-text: 1148 -->`<!-- /react-text --></span><!-- react-text: 1149 -->)(
      _.get(app.config.middleware.ALL, m, {})
    ));
  }
};
<!-- /react-text --></code></pre><!-- react-text: 1150 -->
<!-- /react-text --><p data-reactid="1151"><!-- react-text: 1152 -->This particular startup step sets up the middleware that will apply to <!-- /react-text --><em data-reactid="1153"><!-- react-text: 1154 -->all<!-- /react-text --></em><!-- react-text: 1155 -->
incoming requests.<!-- /react-text --></p><!-- react-text: 1156 -->
<!-- /react-text --><p data-reactid="1157"><!-- react-text: 1158 -->You set which startup steps get run by editing your config:<!-- /react-text --></p><!-- react-text: 1159 -->
<!-- /react-text --><pre data-reactid="1160"><code class="language-javascript hljs" data-reactid="1161"><span class="hljs-comment" data-reactid="1162"><!-- react-text: 1163 -->// file:	&lt;app folder&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 1164 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1165"><!-- react-text: 1166 -->module<!-- /react-text --></span><!-- react-text: 1167 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1168"><span class="hljs-keyword" data-reactid="1169"><!-- react-text: 1170 -->function<!-- /react-text --></span><!-- react-text: 1171 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1172"><!-- react-text: 1173 -->config<!-- /react-text --></span><!-- react-text: 1174 -->) <!-- /react-text --></span><!-- react-text: 1175 -->{
	...
	config.startupSteps = [
		<!-- /react-text --><span class="hljs-string" data-reactid="1176"><!-- react-text: 1177 -->&#x27;step1&#x27;<!-- /react-text --></span><!-- react-text: 1178 -->,
		<!-- /react-text --><span class="hljs-string" data-reactid="1179"><!-- react-text: 1180 -->&#x27;step2&#x27;<!-- /react-text --></span><!-- react-text: 1181 -->,
		<!-- /react-text --><span class="hljs-string" data-reactid="1182"><!-- react-text: 1183 -->&#x27;step3&#x27;<!-- /react-text --></span><!-- react-text: 1184 -->,
	];	
	...
}
<!-- /react-text --></code></pre><!-- react-text: 1185 -->
<!-- /react-text --><p data-reactid="1186"><!-- react-text: 1187 -->The default startup steps can all be found under the <!-- /react-text --><code data-reactid="1188"><!-- react-text: 1189 -->support/startup<!-- /react-text --></code><!-- react-text: 1190 --> file path
and can all be overridden within your app. And of course, you can add your own
startup steps.<!-- /react-text --></p><!-- react-text: 1191 -->
<!-- /react-text --><p data-reactid="1192"><!-- react-text: 1193 -->For example, lets add a step which simply outputs the current date and time:<!-- /react-text --></p><!-- react-text: 1194 -->
<!-- /react-text --><pre data-reactid="1195"><code class="language-javascript hljs" data-reactid="1196"><span class="hljs-comment" data-reactid="1197"><!-- react-text: 1198 -->// file:  &lt;app folder&gt;/src/support/startup/timeAndDate.js<!-- /react-text --></span><!-- react-text: 1199 -->

mdoule.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1200"><span class="hljs-keyword" data-reactid="1201"><!-- react-text: 1202 -->function<!-- /react-text --></span><!-- react-text: 1203 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="1204"><!-- react-text: 1205 -->app<!-- /react-text --></span><!-- react-text: 1206 -->) <!-- /react-text --></span><!-- react-text: 1207 -->{
  <!-- /react-text --><span class="hljs-built_in" data-reactid="1208"><!-- react-text: 1209 -->console<!-- /react-text --></span><!-- react-text: 1210 -->.log(<!-- /react-text --><span class="hljs-keyword" data-reactid="1211"><!-- react-text: 1212 -->new<!-- /react-text --></span><!-- react-text: 1213 --> <!-- /react-text --><span class="hljs-built_in" data-reactid="1214"><!-- react-text: 1215 -->Date<!-- /react-text --></span><!-- react-text: 1216 -->().toString());
};
<!-- /react-text --></code></pre><!-- react-text: 1217 -->
<!-- /react-text --><p data-reactid="1218"><!-- react-text: 1219 -->We then tell Waigo to load and execute this startup step in <!-- /react-text --><code data-reactid="1220"><!-- react-text: 1221 -->development<!-- /react-text --></code><!-- react-text: 1222 --> mode
by creating/modifying the appropriate configuration file:<!-- /react-text --></p><!-- react-text: 1223 -->
<!-- /react-text --><pre data-reactid="1224"><code class="language-javascript hljs" data-reactid="1225"><span class="hljs-comment" data-reactid="1226"><!-- react-text: 1227 -->// file:  &lt;app folder&gt;/src/config/development.js<!-- /react-text --></span><!-- react-text: 1228 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1229"><!-- react-text: 1230 -->module<!-- /react-text --></span><!-- react-text: 1231 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1232"><span class="hljs-keyword" data-reactid="1233"><!-- react-text: 1234 -->function<!-- /react-text --></span><!-- react-text: 1235 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1236"><!-- react-text: 1237 -->config<!-- /react-text --></span><!-- react-text: 1238 -->) <!-- /react-text --></span><!-- react-text: 1239 -->{
  config.startupSteps = [
    <!-- /react-text --><span class="hljs-string" data-reactid="1240"><!-- react-text: 1241 -->&#x27;logging&#x27;<!-- /react-text --></span><!-- react-text: 1242 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="1243"><!-- react-text: 1244 -->&#x27;middleware&#x27;<!-- /react-text --></span><!-- react-text: 1245 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="1246"><!-- react-text: 1247 -->&#x27;routes&#x27;<!-- /react-text --></span><!-- react-text: 1248 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="1249"><!-- react-text: 1250 -->&#x27;listener&#x27;<!-- /react-text --></span><!-- react-text: 1251 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="1252"><!-- react-text: 1253 -->&#x27;timeAndDate&#x27;<!-- /react-text --></span><!-- react-text: 1254 -->
  ];
};
<!-- /react-text --></code></pre><!-- react-text: 1255 -->
<!-- /react-text --><h2 data-reactid="1256"><!-- react-text: 1257 -->Default steps<!-- /react-text --></h2><!-- react-text: 1258 -->
<!-- /react-text --><p data-reactid="1259"><!-- react-text: 1260 -->The following startup steps come with Waigo:<!-- /react-text --></p><!-- react-text: 1261 -->
<!-- /react-text --><ul data-reactid="1262"><!-- react-text: 1263 -->
<!-- /react-text --><li data-reactid="1264"><code data-reactid="1265"><!-- react-text: 1266 -->database<!-- /react-text --></code><!-- react-text: 1267 -->- This sets up the <!-- /react-text --><a href="/docs/#database-and-models/" data-reactid="1268">database</a><!-- react-text: 1269 --> connection using the configuration found at <!-- /react-text --><code data-reactid="1270"><!-- react-text: 1271 -->app.config.db<!-- /react-text --></code><!-- react-text: 1272 -->.<!-- /react-text --></li><!-- react-text: 1273 -->
<!-- /react-text --><li data-reactid="1274"><code data-reactid="1275"><!-- react-text: 1276 -->models<!-- /react-text --></code><!-- react-text: 1277 --> - This sets up <!-- /react-text --><a href="/docs/#reactive-data/" data-reactid="1278">data model</a><!-- react-text: 1279 --> instances based on files found under <!-- /react-text --><code data-reactid="1280"><!-- react-text: 1281 -->models/<!-- /react-text --></code><!-- react-text: 1282 -->.<!-- /react-text --></li><!-- react-text: 1283 -->
<!-- /react-text --><li data-reactid="1284"><code data-reactid="1285"><!-- react-text: 1286 -->forms<!-- /react-text --></code><!-- react-text: 1287 -->- This sets up convenient accessors for using <!-- /react-text --><a href="/docs/#forms/" data-reactid="1288">forms</a><!-- react-text: 1289 -->.<!-- /react-text --></li><!-- react-text: 1290 -->
<!-- /react-text --><li data-reactid="1291"><code data-reactid="1292"><!-- react-text: 1293 -->activityRecorder<!-- /react-text --></code><!-- react-text: 1294 --> - This sets up convenient accessor for recording activities to the <!-- /react-text --><a href="/docs/#activity-stream/" data-reactid="1295">activity stream</a><!-- react-text: 1296 -->.
application folder.<!-- /react-text --></li><!-- react-text: 1297 -->
<!-- /react-text --><li data-reactid="1298"><code data-reactid="1299"><!-- react-text: 1300 -->acl<!-- /react-text --></code><!-- react-text: 1301 --> - Sets up the <!-- /react-text --><a href="/docs/#access-control/" data-reactid="1302">access control</a><!-- react-text: 1303 --> list.<!-- /react-text --></li><!-- react-text: 1304 -->
<!-- /react-text --><li data-reactid="1305"><code data-reactid="1306"><!-- react-text: 1307 -->middleware<!-- /react-text --></code><!-- react-text: 1308 --> - This sets up the default <!-- /react-text --><a href="/docs/#middleware/" data-reactid="1309">middleware</a><!-- react-text: 1310 --> which gets executed for every request.<!-- /react-text --></li><!-- react-text: 1311 -->
<!-- /react-text --><li data-reactid="1312"><code data-reactid="1313"><!-- react-text: 1314 -->routes<!-- /react-text --></code><!-- react-text: 1315 --> - This maps URL <!-- /react-text --><a href="/docs/#routing/" data-reactid="1316">routes</a><!-- react-text: 1317 --> to their handlers.<!-- /react-text --></li><!-- react-text: 1318 -->
<!-- /react-text --><li data-reactid="1319"><code data-reactid="1320"><!-- react-text: 1321 -->staticResources<!-- /react-text --></code><!-- react-text: 1322 --> - This sets up the static resources folder and copies Waigo framework-level frontend assets into it.<!-- /react-text --></li><!-- react-text: 1323 -->
<!-- /react-text --><li data-reactid="1324"><code data-reactid="1325"><!-- react-text: 1326 -->actionTokens<!-- /react-text --></code><!-- react-text: 1327 --> - This sets up the interface for <!-- /react-text --><a href="/docs/#access-tokens/" data-reactid="1328">action tokens</a><!-- react-text: 1329 -->.<!-- /react-text --></li><!-- react-text: 1330 -->
<!-- /react-text --><li data-reactid="1331"><code data-reactid="1332"><!-- react-text: 1333 -->mailer<!-- /react-text --></code><!-- react-text: 1334 --> - <!-- /react-text --><a href="/docs/#email-system/" data-reactid="1335">Email system</a><!-- react-text: 1336 --> setup.<!-- /react-text --></li><!-- react-text: 1337 -->
<!-- /react-text --><li data-reactid="1338"><code data-reactid="1339"><!-- react-text: 1340 -->cron<!-- /react-text --></code><!-- react-text: 1341 --> - Sets up <!-- /react-text --><a href="/docs/#cron-jobs/" data-reactid="1342">cron jobs</a><!-- react-text: 1343 --> system.<!-- /react-text --></li><!-- react-text: 1344 -->
<!-- /react-text --><li data-reactid="1345"><code data-reactid="1346"><!-- react-text: 1347 -->appTemplateVars<!-- /react-text --></code><!-- react-text: 1348 --> - Ensures useful data (e.g. <!-- /react-text --><code data-reactid="1349"><!-- react-text: 1350 -->app.config<!-- /react-text --></code><!-- react-text: 1351 -->) gets exposed to app view templates.<!-- /react-text --></li><!-- react-text: 1352 -->
<!-- /react-text --><li data-reactid="1353"><code data-reactid="1354"><!-- react-text: 1355 -->listener<!-- /react-text --></code><!-- react-text: 1356 --> - This starts the HTTP server and is usually the last start step to be run.<!-- /react-text --></li><!-- react-text: 1357 -->
<!-- /react-text --></ul><!-- react-text: 1358 -->
<!-- /react-text --><h2 data-reactid="1359"><!-- react-text: 1360 -->Shutdown steps<!-- /react-text --></h2><!-- react-text: 1361 -->
<!-- /react-text --><p data-reactid="1362"><!-- react-text: 1363 -->Similar to startup steps, Waigo also has <!-- /react-text --><em data-reactid="1364"><!-- react-text: 1365 -->shutdown steps<!-- /react-text --></em><!-- react-text: 1366 --> - tasks which
get executed when <!-- /react-text --><code data-reactid="1367"><!-- react-text: 1368 -->waigo.load(&#x27;application&#x27;).shutdown()<!-- /react-text --></code><!-- react-text: 1369 --> is called.<!-- /react-text --></p><!-- react-text: 1370 -->
<!-- /react-text --><p data-reactid="1371"><!-- react-text: 1372 -->Shutdown steps especially useful to have if you’re doing automated tests with a Waigo app and need start and stop an app multiple times.<!-- /react-text --></p><!-- react-text: 1373 -->
<!-- /react-text --><p data-reactid="1374"><!-- react-text: 1375 -->The default shutdown steps can all be found under the <!-- /react-text --><code data-reactid="1376"><!-- react-text: 1377 -->support/shutdown<!-- /react-text --></code><!-- react-text: 1378 --> file path:<!-- /react-text --></p><!-- react-text: 1379 -->
<!-- /react-text --><ul data-reactid="1380"><!-- react-text: 1381 -->
<!-- /react-text --><li data-reactid="1382"><code data-reactid="1383"><!-- react-text: 1384 -->database<!-- /react-text --></code><!-- react-text: 1385 -->- This closes the <!-- /react-text --><a href="/docs/#database-and-models/" data-reactid="1386">database</a><!-- react-text: 1387 --> connection.<!-- /react-text --></li><!-- react-text: 1388 -->
<!-- /react-text --><li data-reactid="1389"><code data-reactid="1390"><!-- react-text: 1391 -->listener<!-- /react-text --></code><!-- react-text: 1392 --> - This stops the HTTP server.<!-- /react-text --></li><!-- react-text: 1393 -->
<!-- /react-text --></ul><!-- react-text: 1394 -->
<!-- /react-text --><h1 data-reactid="1395"><!-- react-text: 1396 -->Routing<!-- /react-text --></h1><!-- react-text: 1397 -->
<!-- /react-text --><p data-reactid="1398"><!-- react-text: 1399 -->Waigo’s router provides a user-friendly mapping syntax as well as per-route and per-sub-route middleware customisation. Routes are specified in files under the <!-- /react-text --><code data-reactid="1400"><!-- react-text: 1401 -->routes/<!-- /react-text --></code><!-- react-text: 1402 --> path and are processed once by the <!-- /react-text --><code data-reactid="1403"><!-- react-text: 1404 -->routes<!-- /react-text --></code><!-- react-text: 1405 --> startup step.<!-- /react-text --></p><!-- react-text: 1406 -->
<!-- /react-text --><p data-reactid="1407"><!-- react-text: 1408 -->An example:<!-- /react-text --></p><!-- react-text: 1409 -->
<!-- /react-text --><pre data-reactid="1410"><code class="language-javascript hljs" data-reactid="1411"><span class="hljs-comment" data-reactid="1412"><!-- react-text: 1413 -->// file: &lt;waigo npm folder&gt;/src/routes/admin.js<!-- /react-text --></span><!-- react-text: 1414 -->
<!-- /react-text --><span class="hljs-meta" data-reactid="1415"><!-- react-text: 1416 -->
&quot;use strict&quot;<!-- /react-text --></span><!-- react-text: 1417 -->;


<!-- /react-text --><span class="hljs-built_in" data-reactid="1418"><!-- react-text: 1419 -->module<!-- /react-text --></span><!-- react-text: 1420 -->.exports = { 
  <!-- /react-text --><span class="hljs-string" data-reactid="1421"><!-- react-text: 1422 -->&#x27;/admin&#x27;<!-- /react-text --></span><!-- react-text: 1423 -->: {
    pre: [
      <!-- /react-text --><span class="hljs-string" data-reactid="1424"><!-- react-text: 1425 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 1426 -->,
      <!-- /react-text --><span class="hljs-string" data-reactid="1427"><!-- react-text: 1428 -->&#x27;admin.index.configureMenu&#x27;<!-- /react-text --></span><!-- react-text: 1429 -->,
    ],

    GET: <!-- /react-text --><span class="hljs-string" data-reactid="1430"><!-- react-text: 1431 -->&#x27;admin.index.main&#x27;<!-- /react-text --></span><!-- react-text: 1432 -->,

    <!-- /react-text --><span class="hljs-string" data-reactid="1433"><!-- react-text: 1434 -->&#x27;/routes&#x27;<!-- /react-text --></span><!-- react-text: 1435 -->: {
      pre: [
        { 
          id: <!-- /react-text --><span class="hljs-string" data-reactid="1436"><!-- react-text: 1437 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 1438 -->, 
          canAccess: <!-- /react-text --><span class="hljs-string" data-reactid="1439"><!-- react-text: 1440 -->&#x27;admin&#x27;<!-- /react-text --></span><!-- react-text: 1441 -->,
        },
      ],

      GET: <!-- /react-text --><span class="hljs-string" data-reactid="1442"><!-- react-text: 1443 -->&#x27;admin.routes.index&#x27;<!-- /react-text --></span><!-- react-text: 1444 -->
    },
    
    ...
	}
};
<!-- /react-text --></code></pre><!-- react-text: 1445 -->
<!-- /react-text --><p data-reactid="1446"><!-- react-text: 1447 -->The above route mapping specifies the following:<!-- /react-text --></p><!-- react-text: 1448 -->
<!-- /react-text --><ul data-reactid="1449"><!-- react-text: 1450 -->
<!-- /react-text --><li data-reactid="1451"><!-- react-text: 1452 -->The base path is <!-- /react-text --><code data-reactid="1453"><!-- react-text: 1454 -->/admin<!-- /react-text --></code></li><!-- react-text: 1455 -->
<!-- /react-text --><li data-reactid="1456"><!-- react-text: 1457 -->The <!-- /react-text --><code data-reactid="1458"><!-- react-text: 1459 -->/admin<!-- /react-text --></code><!-- react-text: 1460 --> path and all of its subpaths will have 2 common middleware applied:
<!-- /react-text --><ul data-reactid="1461"><!-- react-text: 1462 -->
<!-- /react-text --><li data-reactid="1463"><code data-reactid="1464"><!-- react-text: 1465 -->waigo.load(&#x27;support/middleware/assertUser&#x27;)<!-- /react-text --></code><!-- react-text: 1466 -->  - will check that the user is logged in.<!-- /react-text --></li><!-- react-text: 1467 -->
<!-- /react-text --><li data-reactid="1468"><code data-reactid="1469"><!-- react-text: 1470 -->waigo.load(&#x27;controllers/admin/index&#x27;).configureMenu)<!-- /react-text --></code><!-- react-text: 1471 --> - will configure the admin menu for rendering.<!-- /react-text --></li><!-- react-text: 1472 -->
<!-- /react-text --></ul><!-- react-text: 1473 -->
<!-- /react-text --></li><!-- react-text: 1474 -->
<!-- /react-text --><li data-reactid="1475"><code data-reactid="1476"><!-- react-text: 1477 -->GET /admin<!-- /react-text --></code><!-- react-text: 1478 --> will be handled by <!-- /react-text --><code data-reactid="1479"><!-- react-text: 1480 -->waigo.load(&#x27;controllers/admin/index&#x27;).main<!-- /react-text --></code><!-- react-text: 1481 -->.<!-- /react-text --></li><!-- react-text: 1482 -->
<!-- /react-text --><li data-reactid="1483"><!-- react-text: 1484 -->The <!-- /react-text --><code data-reactid="1485"><!-- react-text: 1486 -->/admin/routes<!-- /react-text --></code><!-- react-text: 1487 --> path and all of its subpaths will have 1 common middlware applied:
<!-- /react-text --><ul data-reactid="1488"><!-- react-text: 1489 -->
<!-- /react-text --><li data-reactid="1490"><code data-reactid="1491"><!-- react-text: 1492 -->waigo.load(&#x27;support/middleware/assertUser&#x27;)({canAccess: &#x27;admin&#x27;})<!-- /react-text --></code><!-- react-text: 1493 --> - will check that the user is an admin.<!-- /react-text --></li><!-- react-text: 1494 -->
<!-- /react-text --></ul><!-- react-text: 1495 -->
<!-- /react-text --></li><!-- react-text: 1496 -->
<!-- /react-text --><li data-reactid="1497"><code data-reactid="1498"><!-- react-text: 1499 -->GET /admin/routes<!-- /react-text --></code><!-- react-text: 1500 --> will be handled by  <!-- /react-text --><code data-reactid="1501"><!-- react-text: 1502 -->waigo.load(&#x27;controllers/admin/routes&#x27;).index<!-- /react-text --></code><!-- react-text: 1503 -->.<!-- /react-text --></li><!-- react-text: 1504 -->
<!-- /react-text --></ul><!-- react-text: 1505 -->
<!-- /react-text --><p data-reactid="1506"><!-- react-text: 1507 -->In general, if the middleware name has a period (<!-- /react-text --><code data-reactid="1508"><!-- react-text: 1509 -->.<!-- /react-text --></code><!-- react-text: 1510 -->) within it then it is assumed to
refer to a controller file path and a the name of a method within the controller. Otherwise it is
assumed to be the name of a <!-- /react-text --><a href="/docs/#middleware/" data-reactid="1511">middleware</a><!-- react-text: 1512 --> file.<!-- /react-text --></p><!-- react-text: 1513 -->
<!-- /react-text --><p data-reactid="1514"><!-- react-text: 1515 -->If we wanted to we could also specify a middleware “chain” for a particular individual route and HTTP method, e.g we can rewrite the above route mappings as follows:<!-- /react-text --></p><!-- react-text: 1516 -->
<!-- /react-text --><pre data-reactid="1517"><code class="language-javascript hljs" data-reactid="1518"><span class="hljs-built_in" data-reactid="1519"><!-- react-text: 1520 -->module<!-- /react-text --></span><!-- react-text: 1521 -->.exports = {
  <!-- /react-text --><span class="hljs-string" data-reactid="1522"><!-- react-text: 1523 -->&#x27;/admin&#x27;<!-- /react-text --></span><!-- react-text: 1524 -->: {
    GET: [ <!-- /react-text --><span class="hljs-string" data-reactid="1525"><!-- react-text: 1526 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 1527 -->, <!-- /react-text --><span class="hljs-string" data-reactid="1528"><!-- react-text: 1529 -->&#x27;admin.index.configureMenu&#x27;<!-- /react-text --></span><!-- react-text: 1530 -->, <!-- /react-text --><span class="hljs-string" data-reactid="1531"><!-- react-text: 1532 -->&#x27;admin.index.main&#x27;<!-- /react-text --></span><!-- react-text: 1533 --> ],
    <!-- /react-text --><span class="hljs-string" data-reactid="1534"><!-- react-text: 1535 -->&#x27;/routes&#x27;<!-- /react-text --></span><!-- react-text: 1536 -->: {
      POST: [ <!-- /react-text --><span class="hljs-string" data-reactid="1537"><!-- react-text: 1538 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 1539 -->, <!-- /react-text --><span class="hljs-string" data-reactid="1540"><!-- react-text: 1541 -->&#x27;admin.index.configureMenu&#x27;<!-- /react-text --></span><!-- react-text: 1542 -->, { id: <!-- /react-text --><span class="hljs-string" data-reactid="1543"><!-- react-text: 1544 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 1545 -->, canAccess: <!-- /react-text --><span class="hljs-string" data-reactid="1546"><!-- react-text: 1547 -->&#x27;admin&#x27;<!-- /react-text --></span><!-- react-text: 1548 --> }, <!-- /react-text --><span class="hljs-string" data-reactid="1549"><!-- react-text: 1550 -->&#x27;admin.routes.index&#x27;<!-- /react-text --></span><!-- react-text: 1551 --> ],
    }
  }
};
<!-- /react-text --></code></pre><!-- react-text: 1552 -->
<!-- /react-text --><p data-reactid="1553"><em data-reactid="1554"><!-- react-text: 1555 -->Note: The middleware specified within the route mappings always get executed after the
<!-- /react-text --><a href="/docs/#common-middleware/" data-reactid="1556">common middleware</a><!-- react-text: 1557 -->.<!-- /react-text --></em></p><!-- react-text: 1558 -->
<!-- /react-text --><p data-reactid="1559"><em data-reactid="1560"><!-- react-text: 1561 -->Note: Parameterized and regex routing is also supported. See <!-- /react-text --><a href="https://github.com/koajs/trie-router" data-reactid="1562"><!-- react-text: 1563 -->trie-
router<!-- /react-text --></a><!-- react-text: 1564 --> for more information.<!-- /react-text --></em></p><!-- react-text: 1565 -->
<!-- /react-text --><h1 data-reactid="1566"><!-- react-text: 1567 -->Middleware<!-- /react-text --></h1><!-- react-text: 1568 -->
<!-- /react-text --><p data-reactid="1569"><!-- react-text: 1570 -->Waigo middleware works the same as Koa middleware. All middleware module files
can be found under the <!-- /react-text --><code data-reactid="1571"><!-- react-text: 1572 -->support/middleware<!-- /react-text --></code><!-- react-text: 1573 --> path. Additional middleware provided
by your app and/or plugins should also sit under this path.<!-- /react-text --></p><!-- react-text: 1574 -->
<!-- /react-text --><p data-reactid="1575"><!-- react-text: 1576 -->A middleware module file is expected to export an “initializer” function which,
when called will returns a generator function to add to the Koa middleware
layer. For example:<!-- /react-text --></p><!-- react-text: 1577 -->
<!-- /react-text --><pre data-reactid="1578"><code class="language-javascript hljs" data-reactid="1579"><span class="hljs-comment" data-reactid="1580"><!-- react-text: 1581 -->// file: &lt;app folder&gt;/src/support/middleware/example.js<!-- /react-text --></span><!-- react-text: 1582 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1583"><!-- react-text: 1584 -->module<!-- /react-text --></span><!-- react-text: 1585 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1586"><span class="hljs-keyword" data-reactid="1587"><!-- react-text: 1588 -->function<!-- /react-text --></span><!-- react-text: 1589 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1590"><!-- react-text: 1591 -->options<!-- /react-text --></span><!-- react-text: 1592 -->) <!-- /react-text --></span><!-- react-text: 1593 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="1594"><!-- react-text: 1595 -->return<!-- /react-text --></span><!-- react-text: 1596 --> <!-- /react-text --><span class="hljs-function" data-reactid="1597"><span class="hljs-keyword" data-reactid="1598"><!-- react-text: 1599 -->function<!-- /react-text --></span><!-- react-text: 1600 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="1601"><!-- react-text: 1602 -->next<!-- /react-text --></span><!-- react-text: 1603 -->) <!-- /react-text --></span><!-- react-text: 1604 -->{
    <!-- /react-text --><span class="hljs-comment" data-reactid="1605"><!-- react-text: 1606 -->// do nothing and pass through<!-- /react-text --></span><!-- react-text: 1607 -->
    <!-- /react-text --><span class="hljs-keyword" data-reactid="1608"><!-- react-text: 1609 -->yield<!-- /react-text --></span><!-- react-text: 1610 --> next;
  };
};
<!-- /react-text --></code></pre><!-- react-text: 1611 -->
<!-- /react-text --><p data-reactid="1612"><strong data-reactid="1613"><!-- react-text: 1614 -->Thus, existing koa middleware can easily be used with Waigo with little
extra work.<!-- /react-text --></strong></p><!-- react-text: 1615 -->
<!-- /react-text --><p data-reactid="1616"><!-- react-text: 1617 -->If a given middleware is being initialised during <!-- /react-text --><a href="/docs/#startup-and-shutdown/" data-reactid="1618">startup</a><!-- react-text: 1619 --> (i.e. see below) then
additional options from the <!-- /react-text --><code data-reactid="1620"><!-- react-text: 1621 -->app.config.middleware.ALL<!-- /react-text --></code><!-- react-text: 1622 --> configuration object get
passed to the middleware initializer:<!-- /react-text --></p><!-- react-text: 1623 -->
<!-- /react-text --><pre data-reactid="1624"><code class="language-javascript hljs" data-reactid="1625"><span class="hljs-comment" data-reactid="1626"><!-- react-text: 1627 -->// file: &lt;app folder&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 1628 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="1629"><!-- react-text: 1630 -->module<!-- /react-text --></span><!-- react-text: 1631 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1632"><span class="hljs-keyword" data-reactid="1633"><!-- react-text: 1634 -->function<!-- /react-text --></span><!-- react-text: 1635 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1636"><!-- react-text: 1637 -->config<!-- /react-text --></span><!-- react-text: 1638 -->) <!-- /react-text --></span><!-- react-text: 1639 -->{
  ...
  config.middleware.ALL = {
    <!-- /react-text --><span class="hljs-comment" data-reactid="1640"><!-- react-text: 1641 -->/* Order in which middleware gets run */<!-- /react-text --></span><!-- react-text: 1642 -->
    _order: [
      <!-- /react-text --><span class="hljs-string" data-reactid="1643"><!-- react-text: 1644 -->&#x27;errorHandler&#x27;<!-- /react-text --></span><!-- react-text: 1645 -->,
      <!-- /react-text --><span class="hljs-string" data-reactid="1646"><!-- react-text: 1647 -->&#x27;staticResources&#x27;<!-- /react-text --></span><!-- react-text: 1648 -->,
    ],
    <!-- /react-text --><span class="hljs-comment" data-reactid="1649"><!-- react-text: 1650 -->/* Options for each middleware */<!-- /react-text --></span><!-- react-text: 1651 -->
    errorHandler: {},
    staticResources: {
      <!-- /react-text --><span class="hljs-comment" data-reactid="1652"><!-- react-text: 1653 -->// relative to app folder<!-- /react-text --></span><!-- react-text: 1654 -->
      folder: <!-- /react-text --><span class="hljs-string" data-reactid="1655"><!-- react-text: 1656 -->&#x27;/static&#x27;<!-- /react-text --></span><!-- react-text: 1657 -->,
    },
  };
  ...
}
<!-- /react-text --></code></pre><!-- react-text: 1658 -->
<!-- /react-text --><p data-reactid="1659"><!-- react-text: 1660 -->Given the above configuration, the <!-- /react-text --><code data-reactid="1661"><!-- react-text: 1662 -->staticResources<!-- /react-text --></code><!-- react-text: 1663 --> middleware initializer will get passed the options: <!-- /react-text --><code data-reactid="1664"><!-- react-text: 1665 -->{ folder: &#x27;/static&#x27; }<!-- /react-text --></code><!-- react-text: 1666 -->.<!-- /react-text --></p><!-- react-text: 1667 -->
<!-- /react-text --><h2 data-reactid="1668"><!-- react-text: 1669 -->Common middleware<!-- /react-text --></h2><!-- react-text: 1670 -->
<!-- /react-text --><p data-reactid="1671"><!-- react-text: 1672 -->The <!-- /react-text --><a href="/docs/#configuration/" data-reactid="1673">app configuration</a><!-- react-text: 1674 --> file may specify middleware that applies to all incoming requests. For example:<!-- /react-text --></p><!-- react-text: 1675 -->
<!-- /react-text --><pre data-reactid="1676"><code class="language-javascript hljs" data-reactid="1677"><span class="hljs-comment" data-reactid="1678"><!-- react-text: 1679 -->// file:	&lt;app folder&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 1680 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1681"><!-- react-text: 1682 -->module<!-- /react-text --></span><!-- react-text: 1683 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1684"><span class="hljs-keyword" data-reactid="1685"><!-- react-text: 1686 -->function<!-- /react-text --></span><!-- react-text: 1687 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1688"><!-- react-text: 1689 -->config<!-- /react-text --></span><!-- react-text: 1690 -->) <!-- /react-text --></span><!-- react-text: 1691 -->{
  ...
  config.middleware = {};

  config.middleware.ALL = {
    _order: [
      <!-- /react-text --><span class="hljs-string" data-reactid="1692"><!-- react-text: 1693 -->&#x27;errorHandler&#x27;<!-- /react-text --></span><!-- react-text: 1694 -->,
    ],
  };

  config.middleware.POST = config.middleware.PUT = {
    _order: [
      <!-- /react-text --><span class="hljs-string" data-reactid="1695"><!-- react-text: 1696 -->&#x27;bodyParser&#x27;<!-- /react-text --></span><!-- react-text: 1697 -->,
    ],
    bodyParser: {
      limit: <!-- /react-text --><span class="hljs-string" data-reactid="1698"><!-- react-text: 1699 -->&#x27;16mb&#x27;<!-- /react-text --></span><!-- react-text: 1700 -->,
    },
  };
  ...
};
<!-- /react-text --></code></pre><!-- react-text: 1701 -->
<!-- /react-text --><p data-reactid="1702"><!-- react-text: 1703 -->The above configuration states that:<!-- /react-text --></p><!-- react-text: 1704 -->
<!-- /react-text --><ul data-reactid="1705"><!-- react-text: 1706 -->
<!-- /react-text --><li data-reactid="1707"><!-- react-text: 1708 -->The <!-- /react-text --><code data-reactid="1709"><!-- react-text: 1710 -->errorHandler<!-- /react-text --></code><!-- react-text: 1711 --> middleware will apply to <!-- /react-text --><em data-reactid="1712"><!-- react-text: 1713 -->all<!-- /react-text --></em><!-- react-text: 1714 --> incoming requests.<!-- /react-text --></li><!-- react-text: 1715 -->
<!-- /react-text --><li data-reactid="1716"><!-- react-text: 1717 -->The <!-- /react-text --><code data-reactid="1718"><!-- react-text: 1719 -->bodyParser<!-- /react-text --></code><!-- react-text: 1720 --> middlware will only apply to incoming requests using the <!-- /react-text --><code data-reactid="1721"><!-- react-text: 1722 -->PUT<!-- /react-text --></code><!-- react-text: 1723 --> and <!-- /react-text --><code data-reactid="1724"><!-- react-text: 1725 -->POST<!-- /react-text --></code><!-- react-text: 1726 --> HTTP methods.<!-- /react-text --></li><!-- react-text: 1727 -->
<!-- /react-text --></ul><!-- react-text: 1728 -->
<!-- /react-text --><p data-reactid="1729"><!-- react-text: 1730 -->Once a request has been processed by common middleware the middleware specific to the trigger <!-- /react-text --><a href="/docs/#routing/" data-reactid="1731">route</a><!-- react-text: 1732 --> will be executed.<!-- /react-text --></p><!-- react-text: 1733 -->
<!-- /react-text --><h1 data-reactid="1734"><!-- react-text: 1735 -->Controllers<!-- /react-text --></h1><!-- react-text: 1736 -->
<!-- /react-text --><p data-reactid="1737"><!-- react-text: 1738 -->Controllers in Waigo expose route handling methods which work as they do in koa.
The default <!-- /react-text --><code data-reactid="1739"><!-- react-text: 1740 -->index<!-- /react-text --></code><!-- react-text: 1741 --> controller simply has:<!-- /react-text --></p><!-- react-text: 1742 -->
<!-- /react-text --><pre data-reactid="1743"><code class="language-javascript hljs" data-reactid="1744"><span class="hljs-comment" data-reactid="1745"><!-- react-text: 1746 -->// file: &lt;waigo framework&gt;/src/controllers/index<!-- /react-text --></span><!-- react-text: 1747 -->
<!-- /react-text --><span class="hljs-meta" data-reactid="1748"><!-- react-text: 1749 -->
&quot;use strict&quot;<!-- /react-text --></span><!-- react-text: 1750 -->;

exports.main = <!-- /react-text --><span class="hljs-function" data-reactid="1751"><span class="hljs-keyword" data-reactid="1752"><!-- react-text: 1753 -->function<!-- /react-text --></span><!-- react-text: 1754 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="1755"><!-- react-text: 1756 -->next<!-- /react-text --></span><!-- react-text: 1757 -->) <!-- /react-text --></span><!-- react-text: 1758 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="1759"><!-- react-text: 1760 -->yield<!-- /react-text --></span><!-- react-text: 1761 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="1762"><!-- react-text: 1763 -->this<!-- /react-text --></span><!-- react-text: 1764 -->.render(<!-- /react-text --><span class="hljs-string" data-reactid="1765"><!-- react-text: 1766 -->&#x27;index&#x27;<!-- /react-text --></span><!-- react-text: 1767 -->);
};
<!-- /react-text --></code></pre><!-- react-text: 1768 -->
<!-- /react-text --><p data-reactid="1769"><!-- react-text: 1770 -->A controller must either send some output or pass control to the <!-- /react-text --><code data-reactid="1771"><!-- react-text: 1772 -->next<!-- /react-text --></code><!-- react-text: 1773 -->
middleware in the request chain. The <!-- /react-text --><code data-reactid="1774"><!-- react-text: 1775 -->this.render()<!-- /react-text --></code><!-- react-text: 1776 --> call is provided by the
<!-- /react-text --><a href="/docs/#views-and-output-formats/" data-reactid="1777">output formats</a><!-- react-text: 1778 --> middleware.<!-- /react-text --></p><!-- react-text: 1779 -->
<!-- /react-text --><p data-reactid="1780"><!-- react-text: 1781 -->Controllers can be nested within subfolders within the <!-- /react-text --><code data-reactid="1782"><!-- react-text: 1783 -->controllers<!-- /react-text --></code><!-- react-text: 1784 --> path. For example, Waigo’s default <!-- /react-text --><a href="/docs/#admin-dashboard/" data-reactid="1785">admin dashboard</a><!-- react-text: 1786 --> controllers are located at:<!-- /react-text --></p><!-- react-text: 1787 -->
<!-- /react-text --><ul data-reactid="1788"><!-- react-text: 1789 -->
<!-- /react-text --><li data-reactid="1790"><code data-reactid="1791"><!-- react-text: 1792 -->&lt;waigo npm folder&gt;/src/controllers/admin/index.js<!-- /react-text --></code></li><!-- react-text: 1793 -->
<!-- /react-text --><li data-reactid="1794"><code data-reactid="1795"><!-- react-text: 1796 -->&lt;waigo npm folder&gt;/src/controllers/admin/routes.js<!-- /react-text --></code></li><!-- react-text: 1797 -->
<!-- /react-text --><li data-reactid="1798"><!-- react-text: 1799 -->…<!-- /react-text --></li><!-- react-text: 1800 -->
<!-- /react-text --></ul><!-- react-text: 1801 -->
<!-- /react-text --><p data-reactid="1802"><!-- react-text: 1803 -->So to load the admin <!-- /react-text --><code data-reactid="1804"><!-- react-text: 1805 -->routes<!-- /react-text --></code><!-- react-text: 1806 --> controller:<!-- /react-text --></p><!-- react-text: 1807 -->
<!-- /react-text --><pre data-reactid="1808"><code class="language-javascript hljs" data-reactid="1809"><!-- react-text: 1810 -->waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1811"><!-- react-text: 1812 -->&#x27;controllers/admin/routes&#x27;<!-- /react-text --></span><!-- react-text: 1813 -->);
<!-- /react-text --></code></pre><!-- react-text: 1814 -->
<!-- /react-text --><h1 data-reactid="1815"><!-- react-text: 1816 -->Database and Models<!-- /react-text --></h1><!-- react-text: 1817 -->
<!-- /react-text --><h2 data-reactid="1818"><!-- react-text: 1819 -->Database connection<!-- /react-text --></h2><!-- react-text: 1820 -->
<!-- /react-text --><p data-reactid="1821"><em data-reactid="1822"><!-- react-text: 1823 -->Note: At present only RethinkDB is supported. Mongo support is in the pipeline.<!-- /react-text --></em></p><!-- react-text: 1824 -->
<!-- /react-text --><p data-reactid="1825"><!-- react-text: 1826 -->The <!-- /react-text --><code data-reactid="1827"><!-- react-text: 1828 -->database<!-- /react-text --></code><!-- react-text: 1829 --> <!-- /react-text --><a href="/docs/#startup-and-shutdown/" data-reactid="1830">startup</a><!-- react-text: 1831 --> step is responsible for creating connections to databases. It gets its configuration information from <!-- /react-text --><code data-reactid="1832"><!-- react-text: 1833 -->app.config.db<!-- /react-text --></code><!-- react-text: 1834 -->:<!-- /react-text --></p><!-- react-text: 1835 -->
<!-- /react-text --><pre data-reactid="1836"><code class="language-javascript hljs" data-reactid="1837"><span class="hljs-comment" data-reactid="1838"><!-- react-text: 1839 -->// file: &lt;app folder&gt;/src/config.base.js<!-- /react-text --></span><!-- react-text: 1840 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1841"><!-- react-text: 1842 -->module<!-- /react-text --></span><!-- react-text: 1843 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1844"><span class="hljs-keyword" data-reactid="1845"><!-- react-text: 1846 -->function<!-- /react-text --></span><!-- react-text: 1847 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1848"><!-- react-text: 1849 -->config<!-- /react-text --></span><!-- react-text: 1850 -->) <!-- /react-text --></span><!-- react-text: 1851 -->{
  ...
  config.db = {
    mydb: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="1852"><!-- react-text: 1853 -->&#x27;rethinkdb&#x27;<!-- /react-text --></span><!-- react-text: 1854 -->,
      serverConfig: {
        db: <!-- /react-text --><span class="hljs-string" data-reactid="1855"><!-- react-text: 1856 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 1857 -->,
        servers: [
          {
            host: <!-- /react-text --><span class="hljs-string" data-reactid="1858"><!-- react-text: 1859 -->&#x27;127.0.0.1&#x27;<!-- /react-text --></span><!-- react-text: 1860 -->,
            port: <!-- /react-text --><span class="hljs-number" data-reactid="1861"><!-- react-text: 1862 -->28015<!-- /react-text --></span><!-- react-text: 1863 -->,
          }
        ],
      }
    }
  };
  ...
};
<!-- /react-text --></code></pre><!-- react-text: 1864 -->
<!-- /react-text --><p data-reactid="1865"><!-- react-text: 1866 -->The above configuration tells Waigo to create a connection called <!-- /react-text --><code data-reactid="1867"><!-- react-text: 1868 -->mydb<!-- /react-text --></code><!-- react-text: 1869 --> to a RethinkDB database named <!-- /react-text --><code data-reactid="1870"><!-- react-text: 1871 -->waigo<!-- /react-text --></code><!-- react-text: 1872 -->, with a single server to connect to - <!-- /react-text --><code data-reactid="1873"><!-- react-text: 1874 -->127.0.0.1:28015<!-- /react-text --></code><!-- react-text: 1875 -->.<!-- /react-text --></p><!-- react-text: 1876 -->
<!-- /react-text --><p data-reactid="1877"><!-- react-text: 1878 -->Once setup, this database connection will be accessible at <!-- /react-text --><code data-reactid="1879"><!-- react-text: 1880 -->app.dbs.mydb<!-- /react-text --></code><!-- react-text: 1881 -->.<!-- /react-text --></p><!-- react-text: 1882 -->
<!-- /react-text --><p data-reactid="1883"><!-- react-text: 1884 -->It is possible to connect to multiple databases within a single app, e.g:<!-- /react-text --></p><!-- react-text: 1885 -->
<!-- /react-text --><pre data-reactid="1886"><code class="language-javascript hljs" data-reactid="1887"><span class="hljs-comment" data-reactid="1888"><!-- react-text: 1889 -->// file: &lt;app folder&gt;/src/config.base.js<!-- /react-text --></span><!-- react-text: 1890 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="1891"><!-- react-text: 1892 -->module<!-- /react-text --></span><!-- react-text: 1893 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="1894"><span class="hljs-keyword" data-reactid="1895"><!-- react-text: 1896 -->function<!-- /react-text --></span><!-- react-text: 1897 -->(<!-- /react-text --><span class="hljs-params" data-reactid="1898"><!-- react-text: 1899 -->config<!-- /react-text --></span><!-- react-text: 1900 -->) <!-- /react-text --></span><!-- react-text: 1901 -->{
  ...
  config.db = {
    primary: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="1902"><!-- react-text: 1903 -->&#x27;rethinkdb&#x27;<!-- /react-text --></span><!-- react-text: 1904 -->,
      serverConfig: {
        db: <!-- /react-text --><span class="hljs-string" data-reactid="1905"><!-- react-text: 1906 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 1907 -->,
        servers: [
          {
            host: <!-- /react-text --><span class="hljs-string" data-reactid="1908"><!-- react-text: 1909 -->&#x27;127.0.0.1&#x27;<!-- /react-text --></span><!-- react-text: 1910 -->,
            port: <!-- /react-text --><span class="hljs-number" data-reactid="1911"><!-- react-text: 1912 -->28015<!-- /react-text --></span><!-- react-text: 1913 -->,
          }
        ],
      }
    },
    secondary: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="1914"><!-- react-text: 1915 -->&#x27;rethinkdb&#x27;<!-- /react-text --></span><!-- react-text: 1916 -->,
      serverConfig: {
        db: <!-- /react-text --><span class="hljs-string" data-reactid="1917"><!-- react-text: 1918 -->&#x27;logs&#x27;<!-- /react-text --></span><!-- react-text: 1919 -->,
        servers: [
          {
            host: <!-- /react-text --><span class="hljs-string" data-reactid="1920"><!-- react-text: 1921 -->&#x27;127.0.0.1&#x27;<!-- /react-text --></span><!-- react-text: 1922 -->,
            port: <!-- /react-text --><span class="hljs-number" data-reactid="1923"><!-- react-text: 1924 -->28016<!-- /react-text --></span><!-- react-text: 1925 -->,
          }
        ],
      }
    }        
  };
  ...
};
<!-- /react-text --></code></pre><!-- react-text: 1926 -->
<!-- /react-text --><p data-reactid="1927"><!-- react-text: 1928 -->Regardless of the no. of database connections specified, the first connection is always considered to be the main one, and will be made accessible at <!-- /react-text --><code data-reactid="1929"><!-- react-text: 1930 -->app.db<!-- /react-text --></code><!-- react-text: 1931 --> (i.e. <!-- /react-text --><code data-reactid="1932"><!-- react-text: 1933 -->app.db === app.dbs.primary<!-- /react-text --></code><!-- react-text: 1934 --> in the above example).<!-- /react-text --></p><!-- react-text: 1935 -->
<!-- /react-text --><h2 data-reactid="1936"><!-- react-text: 1937 -->Models<!-- /react-text --></h2><!-- react-text: 1938 -->
<!-- /react-text --><p data-reactid="1939"><!-- react-text: 1940 -->A model is an interface between your Waigo app and a datasource - usually this means a database table. What this means is that the other parts of your app (e.g. controllers) should never be accessing the database directly.<!-- /react-text --></p><!-- react-text: 1941 -->
<!-- /react-text --><p data-reactid="1942"><!-- react-text: 1943 -->By encapsulating database access within models you gain the ability to control all database access through the model’s interface and can even change the underlying datasource in future without affecting the rest of your app.<!-- /react-text --></p><!-- react-text: 1944 -->
<!-- /react-text --><p data-reactid="1945"><!-- react-text: 1946 -->The Waigo model architecture is effectively that of an <!-- /react-text --><em data-reactid="1947"><!-- react-text: 1948 -->Object Document Mapper (ODM)<!-- /react-text --></em><!-- react-text: 1949 -->. - it maps objects to documents within the database.<!-- /react-text --></p><!-- react-text: 1950 -->
<!-- /react-text --><h3 data-reactid="1951"><!-- react-text: 1952 -->Using models<!-- /react-text --></h3><!-- react-text: 1953 -->
<!-- /react-text --><p data-reactid="1954"><!-- react-text: 1955 -->To illustrate how models can be used, let’s create an example <!-- /react-text --><code data-reactid="1956"><!-- react-text: 1957 -->User<!-- /react-text --></code><!-- react-text: 1958 --> model for representing users. In this example every user has a usernamd and password and a timestamp indicating the last time they logged in.<!-- /react-text --></p><!-- react-text: 1959 -->
<!-- /react-text --><pre data-reactid="1960"><code class="language-javascript hljs" data-reactid="1961"><span class="hljs-comment" data-reactid="1962"><!-- react-text: 1963 -->// file:	&lt;app folder&gt;/src/models/user/model.js<!-- /react-text --></span><!-- react-text: 1964 -->
<!-- /react-text --><span class="hljs-meta" data-reactid="1965"><!-- react-text: 1966 -->
&quot;use strict&quot;<!-- /react-text --></span><!-- react-text: 1967 -->;

<!-- /react-text --><span class="hljs-keyword" data-reactid="1968"><!-- react-text: 1969 -->const<!-- /react-text --></span><!-- react-text: 1970 --> waigo = global.waigo,
  _ = waigo._,
  Q = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1971"><!-- react-text: 1972 -->&#x27;support/promise&#x27;<!-- /react-text --></span><!-- react-text: 1973 -->),
  errors = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1974"><!-- react-text: 1975 -->&#x27;support/errors&#x27;<!-- /react-text --></span><!-- react-text: 1976 -->),
  RethinkDbModel = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="1977"><!-- react-text: 1978 -->&#x27;support/models/model&#x27;<!-- /react-text --></span><!-- react-text: 1979 -->).RethinkDbModel;


<!-- /react-text --><span class="hljs-keyword" data-reactid="1980"><!-- react-text: 1981 -->const<!-- /react-text --></span><!-- react-text: 1982 --> TABLE_DEF = {
  schema: {
    username: { 
      type: <!-- /react-text --><span class="hljs-built_in" data-reactid="1983"><!-- react-text: 1984 -->String<!-- /react-text --></span><!-- react-text: 1985 -->, 
      required: <!-- /react-text --><span class="hljs-literal" data-reactid="1986"><!-- react-text: 1987 -->true<!-- /react-text --></span><!-- react-text: 1988 -->,
    },
    password: { 
      type: <!-- /react-text --><span class="hljs-built_in" data-reactid="1989"><!-- react-text: 1990 -->String<!-- /react-text --></span><!-- react-text: 1991 -->, 
      required: <!-- /react-text --><span class="hljs-literal" data-reactid="1992"><!-- react-text: 1993 -->true<!-- /react-text --></span><!-- react-text: 1994 -->,
    },
    lastLogin: { 
      type: <!-- /react-text --><span class="hljs-built_in" data-reactid="1995"><!-- react-text: 1996 -->Date<!-- /react-text --></span><!-- react-text: 1997 -->, 
      required: <!-- /react-text --><span class="hljs-literal" data-reactid="1998"><!-- react-text: 1999 -->false<!-- /react-text --></span><!-- react-text: 2000 -->,
    },
  },
  virtuals: {
    hasLoggedInBefore: {
      get: <!-- /react-text --><span class="hljs-function" data-reactid="2001"><span class="hljs-keyword" data-reactid="2002"><!-- react-text: 2003 -->function<!-- /react-text --></span><!-- react-text: 2004 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2005"></span><!-- react-text: 2006 -->) <!-- /react-text --></span><!-- react-text: 2007 -->{
        <!-- /react-text --><span class="hljs-keyword" data-reactid="2008"><!-- react-text: 2009 -->return<!-- /react-text --></span><!-- react-text: 2010 --> !!<!-- /react-text --><span class="hljs-keyword" data-reactid="2011"><!-- react-text: 2012 -->this<!-- /react-text --></span><!-- react-text: 2013 -->.lastLogin;
      }
    }
  },
  indexes: [
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="2014"><!-- react-text: 2015 -->&#x27;username&#x27;<!-- /react-text --></span><!-- react-text: 2016 -->,
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="2017"><!-- react-text: 2018 -->&#x27;lastLogin&#x27;<!-- /react-text --></span><!-- react-text: 2019 -->,
    },
  ]
};

<!-- /react-text --><span class="hljs-keyword" data-reactid="2020"><!-- react-text: 2021 -->const<!-- /react-text --></span><!-- react-text: 2022 --> DOC_METHODS = {
  isPasswordCorrect: <!-- /react-text --><span class="hljs-function" data-reactid="2023"><span class="hljs-keyword" data-reactid="2024"><!-- react-text: 2025 -->function<!-- /react-text --></span><!-- react-text: 2026 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2027"><!-- react-text: 2028 -->password<!-- /react-text --></span><!-- react-text: 2029 -->) <!-- /react-text --></span><!-- react-text: 2030 -->{
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2031"><!-- react-text: 2032 -->return<!-- /react-text --></span><!-- react-text: 2033 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2034"><!-- react-text: 2035 -->this<!-- /react-text --></span><!-- react-text: 2036 -->.password === password;
  },
  login: <!-- /react-text --><span class="hljs-function" data-reactid="2037"><span class="hljs-keyword" data-reactid="2038"><!-- react-text: 2039 -->function<!-- /react-text --></span><!-- react-text: 2040 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2041"><!-- react-text: 2042 -->context<!-- /react-text --></span><!-- react-text: 2043 -->) <!-- /react-text --></span><!-- react-text: 2044 -->{
    <!-- /react-text --><span class="hljs-comment" data-reactid="2045"><!-- react-text: 2046 -->// update last-login timestamp<!-- /react-text --></span><!-- react-text: 2047 -->
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2048"><!-- react-text: 2049 -->this<!-- /react-text --></span><!-- react-text: 2050 -->.lastLogin = <!-- /react-text --><span class="hljs-keyword" data-reactid="2051"><!-- react-text: 2052 -->new<!-- /react-text --></span><!-- react-text: 2053 --> <!-- /react-text --><span class="hljs-built_in" data-reactid="2054"><!-- react-text: 2055 -->Date<!-- /react-text --></span><!-- react-text: 2056 -->();
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2057"><!-- react-text: 2058 -->yield<!-- /react-text --></span><!-- react-text: 2059 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2060"><!-- react-text: 2061 -->this<!-- /react-text --></span><!-- react-text: 2062 -->.save();
  },
};

<!-- /react-text --><span class="hljs-class" data-reactid="2063"><span class="hljs-keyword" data-reactid="2064"><!-- react-text: 2065 -->class<!-- /react-text --></span><!-- react-text: 2066 --> <!-- /react-text --><span class="hljs-title" data-reactid="2067"><!-- react-text: 2068 -->Model<!-- /react-text --></span><!-- react-text: 2069 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2070"><!-- react-text: 2071 -->extends<!-- /react-text --></span><!-- react-text: 2072 --> <!-- /react-text --><span class="hljs-title" data-reactid="2073"><!-- react-text: 2074 -->RethinkDbModel<!-- /react-text --></span><!-- react-text: 2075 --> <!-- /react-text --></span><!-- react-text: 2076 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2077"><!-- react-text: 2078 -->constructor<!-- /react-text --></span><!-- react-text: 2079 --> (app) {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2080"><!-- react-text: 2081 -->super<!-- /react-text --></span><!-- react-text: 2082 -->(app, app.db, {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="2083"><!-- react-text: 2084 -->&quot;User&quot;<!-- /react-text --></span><!-- react-text: 2085 -->,
      def: TABLE_DEF,
      docMethods: DOC_METHODS,
    });
  }

  * getByUsername (username) {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2086"><!-- react-text: 2087 -->let<!-- /react-text --></span><!-- react-text: 2088 --> ret = <!-- /react-text --><span class="hljs-keyword" data-reactid="2089"><!-- react-text: 2090 -->yield<!-- /react-text --></span><!-- react-text: 2091 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2092"><!-- react-text: 2093 -->this<!-- /react-text --></span><!-- react-text: 2094 -->._qry().filter(<!-- /react-text --><span class="hljs-function" data-reactid="2095"><span class="hljs-keyword" data-reactid="2096"><!-- react-text: 2097 -->function<!-- /react-text --></span><!-- react-text: 2098 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2099"><!-- react-text: 2100 -->user<!-- /react-text --></span><!-- react-text: 2101 -->) <!-- /react-text --></span><!-- react-text: 2102 -->{
      <!-- /react-text --><span class="hljs-keyword" data-reactid="2103"><!-- react-text: 2104 -->return<!-- /react-text --></span><!-- react-text: 2105 --> user(<!-- /react-text --><span class="hljs-string" data-reactid="2106"><!-- react-text: 2107 -->&#x27;username&#x27;<!-- /react-text --></span><!-- react-text: 2108 -->).eq(username);
    }).run();

    <!-- /react-text --><span class="hljs-keyword" data-reactid="2109"><!-- react-text: 2110 -->return<!-- /react-text --></span><!-- react-text: 2111 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2112"><!-- react-text: 2113 -->this<!-- /react-text --></span><!-- react-text: 2114 -->._wrap(_.get(ret, <!-- /react-text --><span class="hljs-string" data-reactid="2115"><!-- react-text: 2116 -->&#x27;0&#x27;<!-- /react-text --></span><!-- react-text: 2117 -->));
  }

  * register (username, password) {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2118"><!-- react-text: 2119 -->let<!-- /react-text --></span><!-- react-text: 2120 --> user = <!-- /react-text --><span class="hljs-keyword" data-reactid="2121"><!-- react-text: 2122 -->yield<!-- /react-text --></span><!-- react-text: 2123 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2124"><!-- react-text: 2125 -->this<!-- /react-text --></span><!-- react-text: 2126 -->._insert({
      username: username,
      password: password,
    });

    <!-- /react-text --><span class="hljs-keyword" data-reactid="2127"><!-- react-text: 2128 -->if<!-- /react-text --></span><!-- react-text: 2129 --> (!user) {
      <!-- /react-text --><span class="hljs-keyword" data-reactid="2130"><!-- react-text: 2131 -->throw<!-- /react-text --></span><!-- react-text: 2132 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2133"><!-- react-text: 2134 -->new<!-- /react-text --></span><!-- react-text: 2135 --> <!-- /react-text --><span class="hljs-built_in" data-reactid="2136"><!-- react-text: 2137 -->Error<!-- /react-text --></span><!-- react-text: 2138 -->(<!-- /react-text --><span class="hljs-string" data-reactid="2139"><!-- react-text: 2140 -->&#x27;Error creating new user: &#x27;<!-- /react-text --></span><!-- react-text: 2141 --> + username);
    }

    <!-- /react-text --><span class="hljs-keyword" data-reactid="2142"><!-- react-text: 2143 -->return<!-- /react-text --></span><!-- react-text: 2144 --> user;
  }
}

<!-- /react-text --><span class="hljs-built_in" data-reactid="2145"><!-- react-text: 2146 -->module<!-- /react-text --></span><!-- react-text: 2147 -->.exports = Model;
<!-- /react-text --></code></pre><!-- react-text: 2148 -->
<!-- /react-text --><p data-reactid="2149"><em data-reactid="2150"><!-- react-text: 2151 -->Note: The code example above is explained in the <!-- /react-text --><a href="/docs/#defining-a-model/" data-reactid="2152">Defining a model</a><!-- react-text: 2153 --> section.<!-- /react-text --></em></p><!-- react-text: 2154 -->
<!-- /react-text --><p data-reactid="2155"><!-- react-text: 2156 -->The above model will be instantiated once and then made accessible at <!-- /react-text --><code data-reactid="2157"><!-- react-text: 2158 -->app.models.User<!-- /react-text --></code><!-- react-text: 2159 -->. The name of the model is determined by its filepath. E.g. if the file was instead located at <!-- /react-text --><code data-reactid="2160"><!-- react-text: 2161 -->&lt;app folder&gt;/src/models/bee/model.js<!-- /react-text --></code><!-- react-text: 2162 --> then it would be <!-- /react-text --><code data-reactid="2163"><!-- react-text: 2164 -->app.models.Bee<!-- /react-text --></code><!-- react-text: 2165 -->.<!-- /react-text --></p><!-- react-text: 2166 -->
<!-- /react-text --><p data-reactid="2167"><!-- react-text: 2168 -->To register a new user:<!-- /react-text --></p><!-- react-text: 2169 -->
<!-- /react-text --><pre data-reactid="2170"><code class="language-javascript hljs" data-reactid="2171"><span class="hljs-keyword" data-reactid="2172"><!-- react-text: 2173 -->let<!-- /react-text --></span><!-- react-text: 2174 --> user =  app.models.User.register(<!-- /react-text --><span class="hljs-string" data-reactid="2175"><!-- react-text: 2176 -->&#x27;username&#x27;<!-- /react-text --></span><!-- react-text: 2177 -->, <!-- /react-text --><span class="hljs-string" data-reactid="2178"><!-- react-text: 2179 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 2180 -->);
<!-- /react-text --></code></pre><!-- react-text: 2181 -->
<!-- /react-text --><p data-reactid="2182"><!-- react-text: 2183 -->The returned result is an instance of a <!-- /react-text --><code data-reactid="2184"><!-- react-text: 2185 -->User<!-- /react-text --></code><!-- react-text: 2186 --> “document”, i.e. it is an object which encapsulates a single row within the backend database table.<!-- /react-text --></p><!-- react-text: 2187 -->
<!-- /react-text --><p data-reactid="2188"><!-- react-text: 2189 -->We can now access this document’s fields quite easily:<!-- /react-text --></p><!-- react-text: 2190 -->
<!-- /react-text --><pre data-reactid="2191"><code class="language-javascript hljs" data-reactid="2192"><span class="hljs-built_in" data-reactid="2193"><!-- react-text: 2194 -->console<!-- /react-text --></span><!-- react-text: 2195 -->.log( user.username );
<!-- /react-text --><span class="hljs-built_in" data-reactid="2196"><!-- react-text: 2197 -->console<!-- /react-text --></span><!-- react-text: 2198 -->.log( user.password );
<!-- /react-text --><span class="hljs-built_in" data-reactid="2199"><!-- react-text: 2200 -->console<!-- /react-text --></span><!-- react-text: 2201 -->.log( user.lastLogin );
<!-- /react-text --><span class="hljs-built_in" data-reactid="2202"><!-- react-text: 2203 -->console<!-- /react-text --></span><!-- react-text: 2204 -->.log( user.hasLoggedInBefore );
<!-- /react-text --></code></pre><!-- react-text: 2205 -->
<!-- /react-text --><p data-reactid="2206"><!-- react-text: 2207 -->We can check for a password match:<!-- /react-text --></p><!-- react-text: 2208 -->
<!-- /react-text --><pre data-reactid="2209"><code class="language-javascript hljs" data-reactid="2210"><span class="hljs-built_in" data-reactid="2211"><!-- react-text: 2212 -->console<!-- /react-text --></span><!-- react-text: 2213 -->.log( <!-- /react-text --><span class="hljs-keyword" data-reactid="2214"><!-- react-text: 2215 -->yield<!-- /react-text --></span><!-- react-text: 2216 --> user.isPasswordCorrect(<!-- /react-text --><span class="hljs-string" data-reactid="2217"><!-- react-text: 2218 -->&#x27;user entered passwd&#x27;<!-- /react-text --></span><!-- react-text: 2219 -->);
<!-- /react-text --></code></pre><!-- react-text: 2220 -->
<!-- /react-text --><p data-reactid="2221"><!-- react-text: 2222 -->We can also call <!-- /react-text --><code data-reactid="2223"><!-- react-text: 2224 -->login()<!-- /react-text --></code><!-- react-text: 2225 --> to update the login timestamp:<!-- /react-text --></p><!-- react-text: 2226 -->
<!-- /react-text --><pre data-reactid="2227"><code class="language-javascript hljs" data-reactid="2228"><span class="hljs-comment" data-reactid="2229"><!-- react-text: 2230 -->// user.hasLoggedInBefore === false<!-- /react-text --></span><!-- react-text: 2231 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="2232"><!-- react-text: 2233 -->yield<!-- /react-text --></span><!-- react-text: 2234 --> user.login();
<!-- /react-text --><span class="hljs-comment" data-reactid="2235"><!-- react-text: 2236 -->// user.hasLoggedInBefore === true<!-- /react-text --></span><!-- react-text: 2237 -->
<!-- /react-text --></code></pre><!-- react-text: 2238 -->
<!-- /react-text --><p data-reactid="2239"><!-- react-text: 2240 -->Back to the Model. We can fetch a user by id:<!-- /react-text --></p><!-- react-text: 2241 -->
<!-- /react-text --><pre data-reactid="2242"><code class="language-javascript hljs" data-reactid="2243"><span class="hljs-keyword" data-reactid="2244"><!-- react-text: 2245 -->let<!-- /react-text --></span><!-- react-text: 2246 --> user = <!-- /react-text --><span class="hljs-keyword" data-reactid="2247"><!-- react-text: 2248 -->yield<!-- /react-text --></span><!-- react-text: 2249 --> app.models.User.getById(<!-- /react-text --><span class="hljs-string" data-reactid="2250"><!-- react-text: 2251 -->&#x27;user id&#x27;<!-- /react-text --></span><!-- react-text: 2252 -->);
<!-- /react-text --></code></pre><!-- react-text: 2253 -->
<!-- /react-text --><p data-reactid="2254"><em data-reactid="2255"><!-- react-text: 2256 -->Note: The <!-- /react-text --><code data-reactid="2257"><!-- react-text: 2258 -->getById()<!-- /react-text --></code><!-- react-text: 2259 --> is automatically available on all models.<!-- /react-text --></em></p><!-- react-text: 2260 -->
<!-- /react-text --><p data-reactid="2261"><!-- react-text: 2262 -->We can also get a user by username:<!-- /react-text --></p><!-- react-text: 2263 -->
<!-- /react-text --><pre data-reactid="2264"><code class="language-javascript hljs" data-reactid="2265"><span class="hljs-keyword" data-reactid="2266"><!-- react-text: 2267 -->let<!-- /react-text --></span><!-- react-text: 2268 --> user = <!-- /react-text --><span class="hljs-keyword" data-reactid="2269"><!-- react-text: 2270 -->yield<!-- /react-text --></span><!-- react-text: 2271 --> app.models.User.getByUsername(<!-- /react-text --><span class="hljs-string" data-reactid="2272"><!-- react-text: 2273 -->&#x27;username&#x27;<!-- /react-text --></span><!-- react-text: 2274 -->);
<!-- /react-text --></code></pre><!-- react-text: 2275 -->
<!-- /react-text --><p data-reactid="2276"><!-- react-text: 2277 -->Now let’s go through the above model and explain how it all fits together to give you this API.<!-- /react-text --></p><!-- react-text: 2278 -->
<!-- /react-text --><h3 data-reactid="2279"><!-- react-text: 2280 -->Defining a model<!-- /react-text --></h3><!-- react-text: 2281 -->
<!-- /react-text --><p data-reactid="2282"><!-- react-text: 2283 -->Ever Model consists of a database schema, database indexes, model methods, and document methods.<!-- /react-text --></p><!-- react-text: 2284 -->
<!-- /react-text --><p data-reactid="2285"><!-- react-text: 2286 -->Our <!-- /react-text --><code data-reactid="2287"><!-- react-text: 2288 -->Model<!-- /react-text --></code><!-- react-text: 2289 --> class extends <!-- /react-text --><code data-reactid="2290"><!-- react-text: 2291 -->RethinkDBModel<!-- /react-text --></code><!-- react-text: 2292 --> to indiciate that this Model is backed by a RethinkDB table.<!-- /react-text --></p><!-- react-text: 2293 -->
<!-- /react-text --><p data-reactid="2294"><!-- react-text: 2295 -->The <!-- /react-text --><code data-reactid="2296"><!-- react-text: 2297 -->super()<!-- /react-text --></code><!-- react-text: 2298 --> call in the constructor specifies that the model is to be used with the default database (<!-- /react-text --><code data-reactid="2299"><!-- react-text: 2300 -->app.db<!-- /react-text --></code><!-- react-text: 2301 -->) and that the RethinkDB table is to be named <!-- /react-text --><code data-reactid="2302"><!-- react-text: 2303 -->User<!-- /react-text --></code><!-- react-text: 2304 -->.<!-- /react-text --></p><!-- react-text: 2305 -->
<!-- /react-text --><p data-reactid="2306"><!-- react-text: 2307 -->We then pass in <!-- /react-text --><code data-reactid="2308"><!-- react-text: 2309 -->TABLE_DEF<!-- /react-text --></code><!-- react-text: 2310 --> which consists of the schema for the RethinkDB table, indexes we want RethinkDB to maintain, and finally any required “virtual” fields (see below).<!-- /react-text --></p><!-- react-text: 2311 -->
<!-- /react-text --><p data-reactid="2312"><!-- react-text: 2313 -->The schema specifies three fields for the database table - <!-- /react-text --><code data-reactid="2314"><!-- react-text: 2315 -->username<!-- /react-text --></code><!-- react-text: 2316 -->, <!-- /react-text --><code data-reactid="2317"><!-- react-text: 2318 -->password<!-- /react-text --></code><!-- react-text: 2319 --> and <!-- /react-text --><code data-reactid="2320"><!-- react-text: 2321 -->lastLogin<!-- /react-text --></code><!-- react-text: 2322 --> - with the first two fields being mandatory for any new rows that are to be inserted into the table.<!-- /react-text --></p><!-- react-text: 2323 -->
<!-- /react-text --><p data-reactid="2324"><!-- react-text: 2325 -->We’ve asked for two indexes - one on the <!-- /react-text --><code data-reactid="2326"><!-- react-text: 2327 -->username<!-- /react-text --></code><!-- react-text: 2328 --> field and one on the <!-- /react-text --><code data-reactid="2329"><!-- react-text: 2330 -->lastLogin<!-- /react-text --></code><!-- react-text: 2331 --> field.<!-- /react-text --></p><!-- react-text: 2332 -->
<!-- /react-text --><p data-reactid="2333"><!-- react-text: 2334 -->If we wish to explicitly set which field should be the primary key for the database table we can specify it using the <!-- /react-text --><code data-reactid="2335"><!-- react-text: 2336 -->pk<!-- /react-text --></code><!-- react-text: 2337 --> parameter, e.g:<!-- /react-text --></p><!-- react-text: 2338 -->
<!-- /react-text --><pre data-reactid="2339"><code class="language-javascript hljs" data-reactid="2340"><span class="hljs-keyword" data-reactid="2341"><!-- react-text: 2342 -->super<!-- /react-text --></span><!-- react-text: 2343 -->(app, app.db, {
  name: <!-- /react-text --><span class="hljs-string" data-reactid="2344"><!-- react-text: 2345 -->&quot;User&quot;<!-- /react-text --></span><!-- react-text: 2346 -->,
  pk: <!-- /react-text --><span class="hljs-string" data-reactid="2347"><!-- react-text: 2348 -->&#x27;username&#x27;<!-- /react-text --></span><!-- react-text: 2349 -->,	<!-- /react-text --><span class="hljs-comment" data-reactid="2350"><!-- react-text: 2351 -->// username field is now the primary key<!-- /react-text --></span><!-- react-text: 2352 -->
  def: TABLE_DEF,
  docMethods: DOC_METHODS,
});
<!-- /react-text --></code></pre><!-- react-text: 2353 -->
<!-- /react-text --><p data-reactid="2354"><em data-reactid="2355"><!-- react-text: 2356 -->Note: More complex compound indexes are supported - check out Waigo’s built-in models for real examples.<!-- /react-text --></em></p><!-- react-text: 2357 -->
<!-- /react-text --><p data-reactid="2358"><strong data-reactid="2359"><!-- react-text: 2360 -->Model methods<!-- /react-text --></strong></p><!-- react-text: 2361 -->
<!-- /react-text --><p data-reactid="2362"><!-- react-text: 2363 -->Model methods are the methods available on the model itself. The <!-- /react-text --><code data-reactid="2364"><!-- react-text: 2365 -->getById()<!-- /react-text --></code><!-- react-text: 2366 --> method is automatically available to on model instances. Beyond that a model must define its own additional methods within the <!-- /react-text --><code data-reactid="2367"><!-- react-text: 2368 -->Model<!-- /react-text --></code><!-- react-text: 2369 --> class itself.<!-- /react-text --></p><!-- react-text: 2370 -->
<!-- /react-text --><p data-reactid="2371"><!-- react-text: 2372 -->In our example model we have defined two: <!-- /react-text --><code data-reactid="2373"><!-- react-text: 2374 -->getByUsername<!-- /react-text --></code><!-- react-text: 2375 --> and <!-- /react-text --><code data-reactid="2376"><!-- react-text: 2377 -->register<!-- /react-text --></code><!-- react-text: 2378 -->.<!-- /react-text --></p><!-- react-text: 2379 -->
<!-- /react-text --><p data-reactid="2380"><!-- react-text: 2381 -->You’ll notice that within our example we call a couple of internal methods: <!-- /react-text --><code data-reactid="2382"><!-- react-text: 2383 -->_qry()<!-- /react-text --></code><!-- react-text: 2384 --> and <!-- /react-text --><code data-reactid="2385"><!-- react-text: 2386 -->_insert()<!-- /react-text --></code><!-- react-text: 2387 -->. These are provided by the <!-- /react-text --><code data-reactid="2388"><!-- react-text: 2389 -->RethinkDBModel<!-- /react-text --></code><!-- react-text: 2390 --> base class and perform the actual work of talking to the database and processing results.<!-- /react-text --></p><!-- react-text: 2391 -->
<!-- /react-text --><p data-reactid="2392"><!-- react-text: 2393 -->The available internal methods are:<!-- /react-text --></p><!-- react-text: 2394 -->
<!-- /react-text --><ul data-reactid="2395"><!-- react-text: 2396 -->
<!-- /react-text --><li data-reactid="2397"><code data-reactid="2398"><!-- react-text: 2399 -->_qry()<!-- /react-text --></code><!-- react-text: 2400 --> - construct a RethinkDB query object - basically <!-- /react-text --><code data-reactid="2401"><!-- react-text: 2402 -->r.table(&#x27;table name&#x27;)<!-- /react-text --></code><!-- react-text: 2403 -->.<!-- /react-text --></li><!-- react-text: 2404 -->
<!-- /react-text --><li data-reactid="2405"><code data-reactid="2406"><!-- react-text: 2407 -->_insert()<!-- /react-text --></code><!-- react-text: 2408 --> - insert a new record and return a document instance.<!-- /react-text --></li><!-- react-text: 2409 -->
<!-- /react-text --><li data-reactid="2410"><code data-reactid="2411"><!-- react-text: 2412 -->_update()<!-- /react-text --></code><!-- react-text: 2413 --> - update a record.<!-- /react-text --></li><!-- react-text: 2414 -->
<!-- /react-text --><li data-reactid="2415"><code data-reactid="2416"><!-- react-text: 2417 -->_remove()<!-- /react-text --></code><!-- react-text: 2418 --> - remove a record.<!-- /react-text --></li><!-- react-text: 2419 -->
<!-- /react-text --><li data-reactid="2420"><code data-reactid="2421"><!-- react-text: 2422 -->_get()<!-- /react-text --></code><!-- react-text: 2423 --> - equivalent to RethinkDb’s <!-- /react-text --><a href="https://www.rethinkdb.com/api/javascript/#get" data-reactid="2424"><!-- react-text: 2425 -->get()<!-- /react-text --></a><!-- react-text: 2426 -->.<!-- /react-text --></li><!-- react-text: 2427 -->
<!-- /react-text --><li data-reactid="2428"><code data-reactid="2429"><!-- react-text: 2430 -->_getAll()<!-- /react-text --></code><!-- react-text: 2431 --> - equivalent to RethinkDb’s <!-- /react-text --><a href="https://www.rethinkdb.com/api/javascript/#getAll" data-reactid="2432"><!-- react-text: 2433 -->get()<!-- /react-text --></a><!-- react-text: 2434 -->.<!-- /react-text --></li><!-- react-text: 2435 -->
<!-- /react-text --><li data-reactid="2436"><code data-reactid="2437"><!-- react-text: 2438 -->_wrap()<!-- /react-text --></code><!-- react-text: 2439 --> - process query results array (or single result object) by encapsulating each raw query result in a document instance.<!-- /react-text --></li><!-- react-text: 2440 -->
<!-- /react-text --><li data-reactid="2441"><code data-reactid="2442"><!-- react-text: 2443 -->_createDoc()<!-- /react-text --></code><!-- react-text: 2444 --> - encapsulate given raw query result in a document instance (this gets called by <!-- /react-text --><code data-reactid="2445"><!-- react-text: 2446 -->_wrap()<!-- /react-text --></code><!-- react-text: 2447 -->).<!-- /react-text --></li><!-- react-text: 2448 -->
<!-- /react-text --></ul><!-- react-text: 2449 -->
<!-- /react-text --><p data-reactid="2450"><!-- react-text: 2451 -->These internal methods give you all the tools you need to build out model and document methods.<!-- /react-text --></p><!-- react-text: 2452 -->
<!-- /react-text --><p data-reactid="2453"><strong data-reactid="2454"><!-- react-text: 2455 -->Document methods<!-- /react-text --></strong></p><!-- react-text: 2456 -->
<!-- /react-text --><p data-reactid="2457"><!-- react-text: 2458 -->Document methods are the methods available on an instance of a “document” returned by the model.<!-- /react-text --></p><!-- react-text: 2459 -->
<!-- /react-text --><p data-reactid="2460"><strong data-reactid="2461"><!-- react-text: 2462 -->Virtual fields<!-- /react-text --></strong></p><!-- react-text: 2463 -->
<!-- /react-text --><p data-reactid="2464"><!-- react-text: 2465 -->Virtual fields are fields which appear in the Model’s interface as normal fields but which aren’t actually stored in the database. They’re essentially another way of doing model instance methods.<!-- /react-text --></p><!-- react-text: 2466 -->
<!-- /react-text --><p data-reactid="2467"><!-- react-text: 2468 -->The <!-- /react-text --><code data-reactid="2469"><!-- react-text: 2470 -->TABLE_DEF<!-- /react-text --></code><!-- react-text: 2471 --> constant defines the database schema, database indexes and <!-- /react-text --><em data-reactid="2472"><!-- react-text: 2473 -->virtual<!-- /react-text --></em><!-- react-text: 2474 --> fields.<!-- /react-text --></p><!-- react-text: 2475 -->
<!-- /react-text --><h3 data-reactid="2476"><!-- react-text: 2477 -->Using a model<!-- /react-text --></h3><!-- react-text: 2478 -->
<!-- /react-text --><h3 data-reactid="2479"><!-- react-text: 2480 -->Built-in models<!-- /react-text --></h3><!-- react-text: 2481 -->
<!-- /react-text --><p data-reactid="2482"><!-- react-text: 2483 -->At present Waigo comes with 4 built-in models:<!-- /react-text --></p><!-- react-text: 2484 -->
<!-- /react-text --><ul data-reactid="2485"><!-- react-text: 2486 -->
<!-- /react-text --><li data-reactid="2487"><code data-reactid="2488"><!-- react-text: 2489 -->User<!-- /react-text --></code><!-- react-text: 2490 --> - represents a <!-- /react-text --><a href="/docs/#user-accounts/" data-reactid="2491">user account</a><!-- react-text: 2492 -->.<!-- /react-text --></li><!-- react-text: 2493 -->
<!-- /react-text --><li data-reactid="2494"><code data-reactid="2495"><!-- react-text: 2496 -->Activity<!-- /react-text --></code><!-- react-text: 2497 --> - represents an event in the <!-- /react-text --><a href="/docs/#activity-stream/" data-reactid="2498">activity stream</a><!-- react-text: 2499 -->.<!-- /react-text --></li><!-- react-text: 2500 -->
<!-- /react-text --><li data-reactid="2501"><code data-reactid="2502"><!-- react-text: 2503 -->Acl<!-- /react-text --></code><!-- react-text: 2504 --> - represents an entry in the <!-- /react-text --><a href="/docs/#access-control/" data-reactid="2505">access control list</a><!-- react-text: 2506 -->.<!-- /react-text --></li><!-- react-text: 2507 -->
<!-- /react-text --><li data-reactid="2508"><code data-reactid="2509"><!-- react-text: 2510 -->Cron<!-- /react-text --></code><!-- react-text: 2511 --> - represents a scheduled <!-- /react-text --><a href="/docs/#cron-jobs/" data-reactid="2512">cron job</a><!-- react-text: 2513 -->.<!-- /react-text --></li><!-- react-text: 2514 -->
<!-- /react-text --></ul><!-- react-text: 2515 -->
<!-- /react-text --><p data-reactid="2516"><!-- react-text: 2517 -->If you look at the <!-- /react-text --><a href="https://github.com/waigo/waigo/tree/master/src/models/user" data-reactid="2518"><!-- react-text: 2519 -->source code for the User model<!-- /react-text --></a><!-- react-text: 2520 --> you will notice that the <!-- /react-text --><code data-reactid="2521"><!-- react-text: 2522 -->model.js<!-- /react-text --></code><!-- react-text: 2523 --> file is not monolothic. Instead, the configuration has been split out across several files:<!-- /react-text --></p><!-- react-text: 2524 -->
<!-- /react-text --><ul data-reactid="2525"><!-- react-text: 2526 -->
<!-- /react-text --><li data-reactid="2527"><code data-reactid="2528"><!-- react-text: 2529 -->adminConfig.js<!-- /react-text --></code></li><!-- react-text: 2530 -->
<!-- /react-text --><li data-reactid="2531"><code data-reactid="2532"><!-- react-text: 2533 -->tableDef.js<!-- /react-text --></code></li><!-- react-text: 2534 -->
<!-- /react-text --><li data-reactid="2535"><code data-reactid="2536"><!-- react-text: 2537 -->docMethods.js<!-- /react-text --></code></li><!-- react-text: 2538 -->
<!-- /react-text --></ul><!-- react-text: 2539 -->
<!-- /react-text --><p data-reactid="2540"><!-- react-text: 2541 -->As with everything else in Waigo you can choose to extend or replace these models with your own, or use a completely different model layer of your choosing.<!-- /react-text --></p><!-- react-text: 2542 -->
<!-- /react-text --><h2 data-reactid="2543"><!-- react-text: 2544 -->Reactive data<!-- /react-text --></h2><!-- react-text: 2545 -->
<!-- /react-text --><h1 data-reactid="2546"><!-- react-text: 2547 -->Sessions<!-- /react-text --></h1><!-- react-text: 2548 -->
<!-- /react-text --><p data-reactid="2549"><!-- react-text: 2550 -->You can access session data using <!-- /react-text --><code data-reactid="2551"><!-- react-text: 2552 -->this.session<!-- /react-text --></code><!-- react-text: 2553 -->:<!-- /react-text --></p><!-- react-text: 2554 -->
<!-- /react-text --><pre data-reactid="2555"><code class="language-javascript hljs" data-reactid="2556"><span class="hljs-comment" data-reactid="2557"><!-- react-text: 2558 -->// file: some controller<!-- /react-text --></span><!-- react-text: 2559 -->

exports.index = <!-- /react-text --><span class="hljs-function" data-reactid="2560"><span class="hljs-keyword" data-reactid="2561"><!-- react-text: 2562 -->function<!-- /react-text --></span><!-- react-text: 2563 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2564"><!-- react-text: 2565 -->next<!-- /react-text --></span><!-- react-text: 2566 -->) <!-- /react-text --></span><!-- react-text: 2567 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2568"><!-- react-text: 2569 -->yield<!-- /react-text --></span><!-- react-text: 2570 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2571"><!-- react-text: 2572 -->this<!-- /react-text --></span><!-- react-text: 2573 -->.render(<!-- /react-text --><span class="hljs-string" data-reactid="2574"><!-- react-text: 2575 -->&#x27;index&#x27;<!-- /react-text --></span><!-- react-text: 2576 -->, {
    name: <!-- /react-text --><span class="hljs-keyword" data-reactid="2577"><!-- react-text: 2578 -->this<!-- /react-text --></span><!-- react-text: 2579 -->.session.userName
  });
};
<!-- /react-text --></code></pre><!-- react-text: 2580 -->
<!-- /react-text --><p data-reactid="2581"><!-- react-text: 2582 -->To delete a session simply use <!-- /react-text --><code data-reactid="2583"><!-- react-text: 2584 -->this.session = null<!-- /react-text --></code><!-- react-text: 2585 -->.<!-- /react-text --></p><!-- react-text: 2586 -->
<!-- /react-text --><p data-reactid="2587"><!-- react-text: 2588 -->Sessions are created and loaded by the <!-- /react-text --><code data-reactid="2589"><!-- react-text: 2590 -->sessions<!-- /react-text --></code><!-- react-text: 2591 --> middleware, which internally
uses <!-- /react-text --><a href="https://github.com/hiddentao/koa-session-store" data-reactid="2592"><!-- react-text: 2593 -->koa-session-store<!-- /react-text --></a><!-- react-text: 2594 --> to
allow for pluggable session storage layers.<!-- /react-text --></p><!-- react-text: 2595 -->
<!-- /react-text --><p data-reactid="2596"><!-- react-text: 2597 -->The default session middleware configuration looks as follows:<!-- /react-text --></p><!-- react-text: 2598 -->
<!-- /react-text --><pre data-reactid="2599"><code class="language-javascript hljs" data-reactid="2600"><span class="hljs-comment" data-reactid="2601"><!-- react-text: 2602 -->// file: &lt;waigo framework&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 2603 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="2604"><!-- react-text: 2605 -->module<!-- /react-text --></span><!-- react-text: 2606 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="2607"><span class="hljs-keyword" data-reactid="2608"><!-- react-text: 2609 -->function<!-- /react-text --></span><!-- react-text: 2610 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2611"><!-- react-text: 2612 -->config<!-- /react-text --></span><!-- react-text: 2613 -->) <!-- /react-text --></span><!-- react-text: 2614 -->{
  ...

  config.middleware.options.sessions = {
    <!-- /react-text --><span class="hljs-comment" data-reactid="2615"><!-- react-text: 2616 -->// cookie signing keys - these are used for signing cookies (using Keygrip) and should be set for your app<!-- /react-text --></span><!-- react-text: 2617 -->
    keys: [<!-- /react-text --><span class="hljs-string" data-reactid="2618"><!-- react-text: 2619 -->&#x27;use&#x27;<!-- /react-text --></span><!-- react-text: 2620 -->, <!-- /react-text --><span class="hljs-string" data-reactid="2621"><!-- react-text: 2622 -->&#x27;your&#x27;<!-- /react-text --></span><!-- react-text: 2623 -->, <!-- /react-text --><span class="hljs-string" data-reactid="2624"><!-- react-text: 2625 -->&#x27;own&#x27;<!-- /react-text --></span><!-- react-text: 2626 -->],
    <!-- /react-text --><span class="hljs-comment" data-reactid="2627"><!-- react-text: 2628 -->// session cookie name<!-- /react-text --></span><!-- react-text: 2629 -->
    name: <!-- /react-text --><span class="hljs-string" data-reactid="2630"><!-- react-text: 2631 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 2632 -->,
    <!-- /react-text --><span class="hljs-comment" data-reactid="2633"><!-- react-text: 2634 -->// session storage<!-- /react-text --></span><!-- react-text: 2635 -->
    store: {
      <!-- /react-text --><span class="hljs-comment" data-reactid="2636"><!-- react-text: 2637 -->// session store type<!-- /react-text --></span><!-- react-text: 2638 -->
      type: <!-- /react-text --><span class="hljs-string" data-reactid="2639"><!-- react-text: 2640 -->&#x27;cookie&#x27;<!-- /react-text --></span><!-- react-text: 2641 -->,
      <!-- /react-text --><span class="hljs-comment" data-reactid="2642"><!-- react-text: 2643 -->// session store config<!-- /react-text --></span><!-- react-text: 2644 -->
      config: {
        <!-- /react-text --><span class="hljs-comment" data-reactid="2645"><!-- react-text: 2646 -->// nothing needed for cookie sessions<!-- /react-text --></span><!-- react-text: 2647 -->
      }
    },
    <!-- /react-text --><span class="hljs-comment" data-reactid="2648"><!-- react-text: 2649 -->// session cookie options<!-- /react-text --></span><!-- react-text: 2650 -->
    cookie: {
      <!-- /react-text --><span class="hljs-comment" data-reactid="2651"><!-- react-text: 2652 -->// cookie expires in...<!-- /react-text --></span><!-- react-text: 2653 -->
      validForDays: <!-- /react-text --><span class="hljs-number" data-reactid="2654"><!-- react-text: 2655 -->7<!-- /react-text --></span><!-- react-text: 2656 -->,
      <!-- /react-text --><span class="hljs-comment" data-reactid="2657"><!-- react-text: 2658 -->// cookie valid for url path...<!-- /react-text --></span><!-- react-text: 2659 -->
      path: <!-- /react-text --><span class="hljs-string" data-reactid="2660"><!-- react-text: 2661 -->&#x27;/&#x27;<!-- /react-text --></span><!-- react-text: 2662 -->
    }
  };
<!-- /react-text --></code></pre><!-- react-text: 2663 -->
<!-- /react-text --><p data-reactid="2664"><!-- react-text: 2665 -->By default session data is stored in the session cookie itself. There are other
session storage plugins available for use, for example:<!-- /react-text --></p><!-- react-text: 2666 -->
<!-- /react-text --><ul data-reactid="2667"><!-- react-text: 2668 -->
<!-- /react-text --><li data-reactid="2669"><a href="https://www.npmjs.org/package/waigo-mongo" data-reactid="2670"><!-- react-text: 2671 -->waigo-mongo<!-- /react-text --></a><!-- react-text: 2672 --> - Store session data in Mongo.<!-- /react-text --></li><!-- react-text: 2673 -->
<!-- /react-text --></ul><!-- react-text: 2674 -->
<!-- /react-text --><h1 data-reactid="2675"><!-- react-text: 2676 -->Views and Output formats<!-- /react-text --></h1><!-- react-text: 2677 -->
<!-- /react-text --><p data-reactid="2678"><!-- react-text: 2679 -->Let’s say you have a controller method which looks like this:<!-- /react-text --></p><!-- react-text: 2680 -->
<!-- /react-text --><pre data-reactid="2681"><code class="language-javascript hljs" data-reactid="2682"><span class="hljs-comment" data-reactid="2683"><!-- react-text: 2684 -->// file: &lt;waigo framework&gt;/src/controllers/main.js<!-- /react-text --></span><!-- react-text: 2685 -->

exports.index = <!-- /react-text --><span class="hljs-function" data-reactid="2686"><span class="hljs-keyword" data-reactid="2687"><!-- react-text: 2688 -->function<!-- /react-text --></span><!-- react-text: 2689 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2690"><!-- react-text: 2691 -->next<!-- /react-text --></span><!-- react-text: 2692 -->) <!-- /react-text --></span><!-- react-text: 2693 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2694"><!-- react-text: 2695 -->yield<!-- /react-text --></span><!-- react-text: 2696 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="2697"><!-- react-text: 2698 -->this<!-- /react-text --></span><!-- react-text: 2699 -->.render(<!-- /react-text --><span class="hljs-string" data-reactid="2700"><!-- react-text: 2701 -->&#x27;index&#x27;<!-- /react-text --></span><!-- react-text: 2702 -->, {
    title: <!-- /react-text --><span class="hljs-string" data-reactid="2703"><!-- react-text: 2704 -->&#x27;Hello Waigo!&#x27;<!-- /react-text --></span><!-- react-text: 2705 -->
  });
};
<!-- /react-text --></code></pre><!-- react-text: 2706 -->
<!-- /react-text --><p data-reactid="2707"><!-- react-text: 2708 -->When this gets executed Waigo will look for and load <!-- /react-text --><code data-reactid="2709"><!-- react-text: 2710 -->&lt;app folder&gt;/views/index.pug<!-- /react-text --></code><!-- react-text: 2711 -->,
pass it to the <!-- /react-text --><a href="/docs/jade-lang.com/" data-reactid="2712">Pug</a><!-- react-text: 2713 --> template engine for rendering, and pass
the result to the client.<!-- /react-text --></p><!-- react-text: 2714 -->
<!-- /react-text --><p data-reactid="2715"><!-- react-text: 2716 -->However, if the incoming request has the <!-- /react-text --><code data-reactid="2717"><!-- react-text: 2718 -->format<!-- /react-text --></code><!-- react-text: 2719 --> query parameter set to &#x27;json’
then the requesting client will see the following output:<!-- /react-text --></p><!-- react-text: 2720 -->
<!-- /react-text --><pre data-reactid="2721"><code class="undefined hljs" data-reactid="2722"><!-- react-text: 2723 -->{
  <!-- /react-text --><span class="hljs-attribute" data-reactid="2724"><!-- react-text: 2725 -->title<!-- /react-text --></span><!-- react-text: 2726 -->: <!-- /react-text --><span class="hljs-string" data-reactid="2727"><!-- react-text: 2728 -->&#x27;Hello Waigo!&#x27;<!-- /react-text --></span><!-- react-text: 2729 -->
}
<!-- /react-text --></code></pre><!-- react-text: 2730 -->
<!-- /react-text --><p data-reactid="2731"><!-- react-text: 2732 -->Why is this?<!-- /react-text --></p><!-- react-text: 2733 -->
<!-- /react-text --><p data-reactid="2734"><!-- react-text: 2735 -->Waigo introduces the concept of ‘output formats’ to make it easy to cater
for different types of clients.<!-- /react-text --></p><!-- react-text: 2736 -->
<!-- /react-text --><p data-reactid="2737"><!-- react-text: 2738 -->Nowadays most web apps often have single-page web versions and/or mobile apps
which need to use a REST API or the equivalent to communicate with the back-end.
By supporting more than one one output format Waigo enables you to serve all of
these different clients using the same route handler.<!-- /react-text --></p><!-- react-text: 2739 -->
<!-- /react-text --><p data-reactid="2740"><!-- react-text: 2741 -->The default output formats configuration is as follows:<!-- /react-text --></p><!-- react-text: 2742 -->
<!-- /react-text --><pre data-reactid="2743"><code class="language-javascript hljs" data-reactid="2744"><span class="hljs-comment" data-reactid="2745"><!-- react-text: 2746 -->// file: &lt;waigo framework&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 2747 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="2748"><!-- react-text: 2749 -->module<!-- /react-text --></span><!-- react-text: 2750 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="2751"><span class="hljs-keyword" data-reactid="2752"><!-- react-text: 2753 -->function<!-- /react-text --></span><!-- react-text: 2754 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2755"><!-- react-text: 2756 -->config<!-- /react-text --></span><!-- react-text: 2757 -->) <!-- /react-text --></span><!-- react-text: 2758 -->{
  ...

  config.middleware.options.outputFormats = {
    <!-- /react-text --><span class="hljs-comment" data-reactid="2759"><!-- react-text: 2760 -->// List of enabled formats along with options to pass to each formatter.<!-- /react-text --></span><!-- react-text: 2761 -->
    formats: {
      html: {
        <!-- /react-text --><span class="hljs-comment" data-reactid="2762"><!-- react-text: 2763 -->// Folder relative to application root folder, in which to look for view templates.<!-- /react-text --></span><!-- react-text: 2764 -->
        folder: <!-- /react-text --><span class="hljs-string" data-reactid="2765"><!-- react-text: 2766 -->&#x27;views&#x27;<!-- /react-text --></span><!-- react-text: 2767 -->,
        <!-- /react-text --><span class="hljs-comment" data-reactid="2768"><!-- react-text: 2769 -->// Default view template filename extension when not explicitly provided.<!-- /react-text --></span><!-- react-text: 2770 -->
        ext: <!-- /react-text --><span class="hljs-string" data-reactid="2771"><!-- react-text: 2772 -->&#x27;pug&#x27;<!-- /react-text --></span><!-- react-text: 2773 -->
        <!-- /react-text --><span class="hljs-comment" data-reactid="2774"><!-- react-text: 2775 -->// Map file extension to rendering engine<!-- /react-text --></span><!-- react-text: 2776 -->
        engine: {
          <!-- /react-text --><span class="hljs-string" data-reactid="2777"><!-- react-text: 2778 -->&#x27;pug&#x27;<!-- /react-text --></span><!-- react-text: 2779 -->: <!-- /react-text --><span class="hljs-string" data-reactid="2780"><!-- react-text: 2781 -->&#x27;pug&#x27;<!-- /react-text --></span><!-- react-text: 2782 -->
        }
      },
      json: {}
    },
    <!-- /react-text --><span class="hljs-comment" data-reactid="2783"><!-- react-text: 2784 -->// Use this URL query parameter to determine output format.<!-- /react-text --></span><!-- react-text: 2785 -->
    paramName: <!-- /react-text --><span class="hljs-string" data-reactid="2786"><!-- react-text: 2787 -->&#x27;format&#x27;<!-- /react-text --></span><!-- react-text: 2788 -->,
    <!-- /react-text --><span class="hljs-comment" data-reactid="2789"><!-- react-text: 2790 -->// Default format, in case URL query parameter which determines output format isn&#x27;t provided.<!-- /react-text --></span><!-- react-text: 2791 -->
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2792"><!-- react-text: 2793 -->default<!-- /react-text --></span><!-- react-text: 2794 -->: <!-- /react-text --><span class="hljs-string" data-reactid="2795"><!-- react-text: 2796 -->&#x27;html&#x27;<!-- /react-text --></span><!-- react-text: 2797 -->
  };
<!-- /react-text --></code></pre><!-- react-text: 2798 -->
<!-- /react-text --><p data-reactid="2799"><!-- react-text: 2800 -->HTML and JSON output formats are supported by default, with the
specific format chosen via the <!-- /react-text --><code data-reactid="2801"><!-- react-text: 2802 -->format<!-- /react-text --></code><!-- react-text: 2803 --> URL query parameter. The actual
implementations of each output format can be found in the
<!-- /react-text --><code data-reactid="2804"><!-- react-text: 2805 -->support/outputFormats<!-- /react-text --></code><!-- react-text: 2806 --> module file path.<!-- /react-text --></p><!-- react-text: 2807 -->
<!-- /react-text --><p data-reactid="2808"><!-- react-text: 2809 -->The <!-- /react-text --><code data-reactid="2810"><!-- react-text: 2811 -->outputFormats<!-- /react-text --></code><!-- react-text: 2812 --> middleware sets up the output format for every request. It
also adds the <!-- /react-text --><code data-reactid="2813"><!-- react-text: 2814 -->this.render()<!-- /react-text --></code><!-- react-text: 2815 --> method you saw being used earlier in the default
controller.<!-- /react-text --></p><!-- react-text: 2816 -->
<!-- /react-text --><p data-reactid="2817"><strong data-reactid="2818"><!-- react-text: 2819 -->Tip: In order to make effective use of output formats, ensure all the data
needed by your view templates is generated before you render the template.
This will make it easier for you to switch between differnet output formats as
and when needed without having to generate data separately for each different
format.<!-- /react-text --></strong></p><!-- react-text: 2820 -->
<!-- /react-text --><h2 data-reactid="2821"><!-- react-text: 2822 -->Custom formats<!-- /react-text --></h2><!-- react-text: 2823 -->
<!-- /react-text --><p data-reactid="2824"><!-- react-text: 2825 -->You can easily add your own custom output formats. For example, let’s say you
wanted to add an XML output format. You would first create an implementation for
your output format:<!-- /react-text --></p><!-- react-text: 2826 -->
<!-- /react-text --><pre data-reactid="2827"><code class="language-javascript hljs" data-reactid="2828"><span class="hljs-comment" data-reactid="2829"><!-- react-text: 2830 -->// file: &lt;app folder&gt;/src/outputFormats/xml.js<!-- /react-text --></span><!-- react-text: 2831 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="2832"><!-- react-text: 2833 -->var<!-- /react-text --></span><!-- react-text: 2834 --> xml_renderer = ...

exports.create = <!-- /react-text --><span class="hljs-function" data-reactid="2835"><span class="hljs-keyword" data-reactid="2836"><!-- react-text: 2837 -->function<!-- /react-text --></span><!-- react-text: 2838 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2839"><!-- react-text: 2840 -->options<!-- /react-text --></span><!-- react-text: 2841 -->) <!-- /react-text --></span><!-- react-text: 2842 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2843"><!-- react-text: 2844 -->var<!-- /react-text --></span><!-- react-text: 2845 --> render = xml_renderer.init(options);    

  <!-- /react-text --><span class="hljs-comment" data-reactid="2846"><!-- react-text: 2847 -->// &#x27;render&#x27; should now equal a generator function which wil return the <!-- /react-text --></span><!-- react-text: 2848 -->
  <!-- /react-text --><span class="hljs-comment" data-reactid="2849"><!-- react-text: 2850 -->// rendered output<!-- /react-text --></span><!-- react-text: 2851 -->

  <!-- /react-text --><span class="hljs-keyword" data-reactid="2852"><!-- react-text: 2853 -->return<!-- /react-text --></span><!-- react-text: 2854 --> {
    render: <!-- /react-text --><span class="hljs-function" data-reactid="2855"><span class="hljs-keyword" data-reactid="2856"><!-- react-text: 2857 -->function<!-- /react-text --></span><!-- react-text: 2858 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2859"><!-- react-text: 2860 -->view, locals<!-- /react-text --></span><!-- react-text: 2861 -->) <!-- /react-text --></span><!-- react-text: 2862 -->{
      <!-- /react-text --><span class="hljs-keyword" data-reactid="2863"><!-- react-text: 2864 -->this<!-- /react-text --></span><!-- react-text: 2865 -->.body = <!-- /react-text --><span class="hljs-keyword" data-reactid="2866"><!-- react-text: 2867 -->yield<!-- /react-text --></span><!-- react-text: 2868 --> render(view, _.extend({}, locals, <!-- /react-text --><span class="hljs-keyword" data-reactid="2869"><!-- react-text: 2870 -->this<!-- /react-text --></span><!-- react-text: 2871 -->.app.locals));
      <!-- /react-text --><span class="hljs-keyword" data-reactid="2872"><!-- react-text: 2873 -->this<!-- /react-text --></span><!-- react-text: 2874 -->.type = <!-- /react-text --><span class="hljs-string" data-reactid="2875"><!-- react-text: 2876 -->&#x27;application/xml&#x27;<!-- /react-text --></span><!-- react-text: 2877 -->;
    }
  };
};
<!-- /react-text --></code></pre><!-- react-text: 2878 -->
<!-- /react-text --><p data-reactid="2879"><!-- react-text: 2880 -->Once this is done and you can enable it by modifying the <!-- /react-text --><code data-reactid="2881"><!-- react-text: 2882 -->outputFormats<!-- /react-text --></code><!-- react-text: 2883 -->
middleware configuration. For example:<!-- /react-text --></p><!-- react-text: 2884 -->
<!-- /react-text --><pre data-reactid="2885"><code class="language-javascript hljs" data-reactid="2886"><span class="hljs-comment" data-reactid="2887"><!-- react-text: 2888 -->// file: &lt;app folder&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 2889 -->
<!-- /react-text --><span class="hljs-built_in" data-reactid="2890"><!-- react-text: 2891 -->module<!-- /react-text --></span><!-- react-text: 2892 -->.exports = {
  ...

  config.middleware.options.outputFormats = {
    ...
    xml: {
      config: {
        <!-- /react-text --><span class="hljs-comment" data-reactid="2893"><!-- react-text: 2894 -->// any initialisation for the XML renderer could go here<!-- /react-text --></span><!-- react-text: 2895 -->
      }
    }
  };
<!-- /react-text --></code></pre><!-- react-text: 2896 -->
<!-- /react-text --><h2 data-reactid="2897"><!-- react-text: 2898 -->View objects<!-- /react-text --></h2><!-- react-text: 2899 -->
<!-- /react-text --><p data-reactid="2900"><em data-reactid="2901"><!-- react-text: 2902 -->View objects<!-- /react-text --></em><!-- react-text: 2903 --> are plain Javascript objects which represent back-end data we
wish to send to the client.<!-- /react-text --></p><!-- react-text: 2904 -->
<!-- /react-text --><p data-reactid="2905"><!-- react-text: 2906 -->Why use them?<!-- /react-text --></p><!-- react-text: 2907 -->
<!-- /react-text --><p data-reactid="2908"><!-- react-text: 2909 -->When sending data back to the client we may want to first modify it, e.g. format
dates, remove parts of the data that the client does not need to see in the
given context, etc.<!-- /react-text --></p><!-- react-text: 2910 -->
<!-- /react-text --><p data-reactid="2911"><!-- react-text: 2912 -->The <!-- /react-text --><code data-reactid="2913"><!-- react-text: 2914 -->this.render()<!-- /react-text --></code><!-- react-text: 2915 --> method provided by the [output formats](#views-and-
output-formats) middleware checks the passed-in template variables to see if
view objects can be generated for them.<!-- /react-text --></p><!-- react-text: 2916 -->
<!-- /react-text --><p data-reactid="2917"><!-- react-text: 2918 -->An object can generate a view object representation of itself if it implements
the <!-- /react-text --><code data-reactid="2919"><!-- react-text: 2920 -->HasViewObject<!-- /react-text --></code><!-- react-text: 2921 --> mixin (see the  <!-- /react-text --><code data-reactid="2922"><!-- react-text: 2923 -->support/mixins<!-- /react-text --></code><!-- react-text: 2924 --> module file). Applying this
mixin to a class requires you to implement a <!-- /react-text --><code data-reactid="2925"><!-- react-text: 2926 -->toViewObject()<!-- /react-text --></code><!-- react-text: 2927 --> generator function
for that class.<!-- /react-text --></p><!-- react-text: 2928 -->
<!-- /react-text --><p data-reactid="2929"><!-- react-text: 2930 -->The <!-- /react-text --><code data-reactid="2931"><!-- react-text: 2932 -->toViewObject()<!-- /react-text --></code><!-- react-text: 2933 --> function takes a single argument - the context for the
current request, allowing you to tailor the view object representation according
to each individual request.<!-- /react-text --></p><!-- react-text: 2934 -->
<!-- /react-text --><p data-reactid="2935"><!-- react-text: 2936 -->For example, let’s say we have a model instance which holds data wish to send to
the client:<!-- /react-text --></p><!-- react-text: 2937 -->
<!-- /react-text --><pre data-reactid="2938"><code class="language-javascript hljs" data-reactid="2939"><span class="hljs-keyword" data-reactid="2940"><!-- react-text: 2941 -->var<!-- /react-text --></span><!-- react-text: 2942 --> waigo = <!-- /react-text --><span class="hljs-built_in" data-reactid="2943"><!-- react-text: 2944 -->require<!-- /react-text --></span><!-- react-text: 2945 -->(<!-- /react-text --><span class="hljs-string" data-reactid="2946"><!-- react-text: 2947 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 2948 -->),
  mixins = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="2949"><!-- react-text: 2950 -->&#x27;support/mixins&#x27;<!-- /react-text --></span><!-- react-text: 2951 -->);

<!-- /react-text --><span class="hljs-keyword" data-reactid="2952"><!-- react-text: 2953 -->var<!-- /react-text --></span><!-- react-text: 2954 --> Model = <!-- /react-text --><span class="hljs-function" data-reactid="2955"><span class="hljs-keyword" data-reactid="2956"><!-- react-text: 2957 -->function<!-- /react-text --></span><!-- react-text: 2958 -->(<!-- /react-text --><span class="hljs-params" data-reactid="2959"><!-- react-text: 2960 -->name<!-- /react-text --></span><!-- react-text: 2961 -->) <!-- /react-text --></span><!-- react-text: 2962 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2963"><!-- react-text: 2964 -->this<!-- /react-text --></span><!-- react-text: 2965 -->.name = name;
  <!-- /react-text --><span class="hljs-keyword" data-reactid="2966"><!-- react-text: 2967 -->this<!-- /react-text --></span><!-- react-text: 2968 -->.id = <!-- /react-text --><span class="hljs-number" data-reactid="2969"><!-- react-text: 2970 -->234<!-- /react-text --></span><!-- react-text: 2971 -->;
};
mixins.apply(Model, mixins.HasViewObject);

Model.prototype.toViewObject = <!-- /react-text --><span class="hljs-function" data-reactid="2972"><span class="hljs-keyword" data-reactid="2973"><!-- react-text: 2974 -->function<!-- /react-text --></span><!-- react-text: 2975 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="2976"><!-- react-text: 2977 -->ctx<!-- /react-text --></span><!-- react-text: 2978 -->) <!-- /react-text --></span><!-- react-text: 2979 -->{
  <!-- /react-text --><span class="hljs-comment" data-reactid="2980"><!-- react-text: 2981 -->// we will alter the view object representation according to a specific <!-- /react-text --></span><!-- react-text: 2982 -->
  <!-- /react-text --><span class="hljs-comment" data-reactid="2983"><!-- react-text: 2984 -->// request header which gets passed in<!-- /react-text --></span><!-- react-text: 2985 -->
  customKey = ctx.req.header[<!-- /react-text --><span class="hljs-string" data-reactid="2986"><!-- react-text: 2987 -->&#x27;x-custom-key&#x27;<!-- /react-text --></span><!-- react-text: 2988 -->];

  <!-- /react-text --><span class="hljs-keyword" data-reactid="2989"><!-- react-text: 2990 -->if<!-- /react-text --></span><!-- react-text: 2991 --> (<!-- /react-text --><span class="hljs-string" data-reactid="2992"><!-- react-text: 2993 -->&#x27;test&#x27;<!-- /react-text --></span><!-- react-text: 2994 --> === customKey) {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="2995"><!-- react-text: 2996 -->return<!-- /react-text --></span><!-- react-text: 2997 --> {
      name: <!-- /react-text --><span class="hljs-keyword" data-reactid="2998"><!-- react-text: 2999 -->this<!-- /react-text --></span><!-- react-text: 3000 -->.name,
      id: <!-- /react-text --><span class="hljs-keyword" data-reactid="3001"><!-- react-text: 3002 -->this<!-- /react-text --></span><!-- react-text: 3003 -->.id
    };
  } <!-- /react-text --><span class="hljs-keyword" data-reactid="3004"><!-- react-text: 3005 -->else<!-- /react-text --></span><!-- react-text: 3006 --> {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="3007"><!-- react-text: 3008 -->return<!-- /react-text --></span><!-- react-text: 3009 --> {
      name: <!-- /react-text --><span class="hljs-keyword" data-reactid="3010"><!-- react-text: 3011 -->this<!-- /react-text --></span><!-- react-text: 3012 -->.name
    }
  }
};
<!-- /react-text --></code></pre><!-- react-text: 3013 -->
<!-- /react-text --><p data-reactid="3014"><!-- react-text: 3015 -->In our controller we can easily pass this to the output format renderer:<!-- /react-text --></p><!-- react-text: 3016 -->
<!-- /react-text --><pre data-reactid="3017"><code class="language-javascript hljs" data-reactid="3018"><span class="hljs-comment" data-reactid="3019"><!-- react-text: 3020 -->// controllers/main.js<!-- /react-text --></span><!-- react-text: 3021 -->

exports.index = <!-- /react-text --><span class="hljs-function" data-reactid="3022"><span class="hljs-keyword" data-reactid="3023"><!-- react-text: 3024 -->function<!-- /react-text --></span><!-- react-text: 3025 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="3026"></span><!-- react-text: 3027 -->) <!-- /react-text --></span><!-- react-text: 3028 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="3029"><!-- react-text: 3030 -->this<!-- /react-text --></span><!-- react-text: 3031 -->.render(<!-- /react-text --><span class="hljs-string" data-reactid="3032"><!-- react-text: 3033 -->&#x27;index&#x27;<!-- /react-text --></span><!-- react-text: 3034 -->, {
    person: <!-- /react-text --><span class="hljs-keyword" data-reactid="3035"><!-- react-text: 3036 -->new<!-- /react-text --></span><!-- react-text: 3037 --> Model(<!-- /react-text --><span class="hljs-string" data-reactid="3038"><!-- react-text: 3039 -->&#x27;John&#x27;<!-- /react-text --></span><!-- react-text: 3040 -->),
    stats: {
      age: <!-- /react-text --><span class="hljs-number" data-reactid="3041"><!-- react-text: 3042 -->31<!-- /react-text --></span><!-- react-text: 3043 -->,
      score: <!-- /react-text --><span class="hljs-number" data-reactid="3044"><!-- react-text: 3045 -->10<!-- /react-text --></span><!-- react-text: 3046 -->
    }
  });
}
<!-- /react-text --></code></pre><!-- react-text: 3047 -->
<!-- /react-text --><p data-reactid="3048"><!-- react-text: 3049 -->The output (if we requested the JSON output format) will look like:<!-- /react-text --></p><!-- react-text: 3050 -->
<!-- /react-text --><pre data-reactid="3051"><code class="undefined hljs" data-reactid="3052"><!-- react-text: 3053 -->{
  <!-- /react-text --><span class="hljs-attribute" data-reactid="3054"><!-- react-text: 3055 -->person<!-- /react-text --></span><!-- react-text: 3056 -->: {
    name: <!-- /react-text --><span class="hljs-string" data-reactid="3057"><!-- react-text: 3058 -->&#x27;John&#x27;<!-- /react-text --></span><!-- react-text: 3059 -->
  },
  <!-- /react-text --><span class="hljs-selector-tag" data-reactid="3060"><!-- react-text: 3061 -->age<!-- /react-text --></span><!-- react-text: 3062 -->: {
    <!-- /react-text --><span class="hljs-attribute" data-reactid="3063"><!-- react-text: 3064 -->age<!-- /react-text --></span><!-- react-text: 3065 -->: <!-- /react-text --><span class="hljs-number" data-reactid="3066"><!-- react-text: 3067 -->31<!-- /react-text --></span><!-- react-text: 3068 -->,
    score: <!-- /react-text --><span class="hljs-number" data-reactid="3069"><!-- react-text: 3070 -->10<!-- /react-text --></span><!-- react-text: 3071 -->
  }
}
<!-- /react-text --></code></pre><!-- react-text: 3072 -->
<!-- /react-text --><p data-reactid="3073"><!-- react-text: 3074 -->Notice how the renderer didn’t output the <!-- /react-text --><code data-reactid="3075"><!-- react-text: 3076 -->id<!-- /react-text --></code><!-- react-text: 3077 --> attribute of our model instance.
Also notice how the <!-- /react-text --><code data-reactid="3078"><!-- react-text: 3079 -->stats<!-- /react-text --></code><!-- react-text: 3080 --> key-value pair was output  just as it is. If a given
template variable does not implement the <!-- /react-text --><code data-reactid="3081"><!-- react-text: 3082 -->HasViewObject<!-- /react-text --></code><!-- react-text: 3083 --> mixin then it gets
output as it is, unchanged.<!-- /react-text --></p><!-- react-text: 3084 -->
<!-- /react-text --><p data-reactid="3085"><!-- react-text: 3086 -->If we now make the request with the <!-- /react-text --><code data-reactid="3087"><!-- react-text: 3088 -->x-custom-key: test<!-- /react-text --></code><!-- react-text: 3089 --> header set then we will
instead get:<!-- /react-text --></p><!-- react-text: 3090 -->
<!-- /react-text --><pre data-reactid="3091"><code class="language-javascript hljs" data-reactid="3092"><!-- react-text: 3093 -->{
  person: {
    name: <!-- /react-text --><span class="hljs-string" data-reactid="3094"><!-- react-text: 3095 -->&#x27;John&#x27;<!-- /react-text --></span><!-- react-text: 3096 -->,
    id: <!-- /react-text --><span class="hljs-number" data-reactid="3097"><!-- react-text: 3098 -->234<!-- /react-text --></span><!-- react-text: 3099 -->
  },
  age: {
    age: <!-- /react-text --><span class="hljs-number" data-reactid="3100"><!-- react-text: 3101 -->31<!-- /react-text --></span><!-- react-text: 3102 -->,
    score: <!-- /react-text --><span class="hljs-number" data-reactid="3103"><!-- react-text: 3104 -->10<!-- /react-text --></span><!-- react-text: 3105 -->
  }
}
<!-- /react-text --></code></pre><!-- react-text: 3106 -->
<!-- /react-text --><p data-reactid="3107"><!-- react-text: 3108 -->All built-in <!-- /react-text --><a href="/docs/#errors/" data-reactid="3109">error</a><!-- react-text: 3110 --> classes (including form <!-- /react-text --><a href="/docs/#validation/" data-reactid="3111">validation</a><!-- react-text: 3112 -->
errors) implement the <!-- /react-text --><code data-reactid="3113"><!-- react-text: 3114 -->HasViewObject<!-- /react-text --></code><!-- react-text: 3115 --> mixin. In fact, when
the error handler sends an error response to the client it uses the view object
representation of the error.<!-- /react-text --></p><!-- react-text: 3116 -->
<!-- /react-text --><h2 data-reactid="3117"><!-- react-text: 3118 -->Template globals<!-- /react-text --></h2><!-- react-text: 3119 -->
<!-- /react-text --><p data-reactid="3120"><!-- react-text: 3121 -->The HTML output format contains the following rendering code:<!-- /react-text --></p><!-- react-text: 3122 -->
<!-- /react-text --><pre data-reactid="3123"><code class="language-javascript hljs" data-reactid="3124"><span class="hljs-keyword" data-reactid="3125"><!-- react-text: 3126 -->this<!-- /react-text --></span><!-- react-text: 3127 -->.body = <!-- /react-text --><span class="hljs-keyword" data-reactid="3128"><!-- react-text: 3129 -->yield<!-- /react-text --></span><!-- react-text: 3130 --> render(view, _.extend({}, <!-- /react-text --><span class="hljs-keyword" data-reactid="3131"><!-- react-text: 3132 -->this<!-- /react-text --></span><!-- react-text: 3133 -->.app.locals, locals));
<!-- /react-text --></code></pre><!-- react-text: 3134 -->
<!-- /react-text --><p data-reactid="3135"><!-- react-text: 3136 -->The template variables passed to the <!-- /react-text --><code data-reactid="3137"><!-- react-text: 3138 -->render()<!-- /react-text --></code><!-- react-text: 3139 --> method get converted to view
objects and then passed in as <!-- /react-text --><code data-reactid="3140"><!-- react-text: 3141 -->locals<!-- /react-text --></code><!-- react-text: 3142 -->. Notice however, that <!-- /react-text --><code data-reactid="3143"><!-- react-text: 3144 -->this.app.locals<!-- /react-text --></code><!-- react-text: 3145 -->
also gets passed in to the template.<!-- /react-text --></p><!-- react-text: 3146 -->
<!-- /react-text --><p data-reactid="3147"><!-- react-text: 3148 -->This variable is for holding any global template variables or helper functions
which are to be made available to all templates.<!-- /react-text --></p><!-- react-text: 3149 -->
<!-- /react-text --><p data-reactid="3150"><!-- react-text: 3151 -->For example, if you wanted to add a template helper to pretty-print a <!-- /react-text --><code data-reactid="3152"><!-- react-text: 3153 -->Date<!-- /react-text --></code><!-- react-text: 3154 -->
object using the <!-- /react-text --><a href="http://momentjs.com/" data-reactid="3155"><!-- react-text: 3156 -->moment.js<!-- /react-text --></a><!-- react-text: 3157 --> library you could create a
<!-- /react-text --><a href="/docs/#startup/" data-reactid="3158">startup</a><!-- react-text: 3159 --> step to add it:<!-- /react-text --></p><!-- react-text: 3160 -->
<!-- /react-text --><pre data-reactid="3161"><code class="language-javascript hljs" data-reactid="3162"><span class="hljs-comment" data-reactid="3163"><!-- react-text: 3164 -->// file: &lt;app folder&gt;/support/startup/helpers.js<!-- /react-text --></span><!-- react-text: 3165 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="3166"><!-- react-text: 3167 -->var<!-- /react-text --></span><!-- react-text: 3168 --> _ = <!-- /react-text --><span class="hljs-built_in" data-reactid="3169"><!-- react-text: 3170 -->require<!-- /react-text --></span><!-- react-text: 3171 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3172"><!-- react-text: 3173 -->&#x27;lodash&#x27;<!-- /react-text --></span><!-- react-text: 3174 -->), 
  moment = <!-- /react-text --><span class="hljs-built_in" data-reactid="3175"><!-- react-text: 3176 -->require<!-- /react-text --></span><!-- react-text: 3177 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3178"><!-- react-text: 3179 -->&#x27;moment&#x27;<!-- /react-text --></span><!-- react-text: 3180 -->);

<!-- /react-text --><span class="hljs-built_in" data-reactid="3181"><!-- react-text: 3182 -->module<!-- /react-text --></span><!-- react-text: 3183 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="3184"><span class="hljs-keyword" data-reactid="3185"><!-- react-text: 3186 -->function<!-- /react-text --></span><!-- react-text: 3187 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="3188"><!-- react-text: 3189 -->app<!-- /react-text --></span><!-- react-text: 3190 -->) <!-- /react-text --></span><!-- react-text: 3191 -->{
  app.locals = _.extend({}, app.locals, {
    prettyDate: <!-- /react-text --><span class="hljs-function" data-reactid="3192"><span class="hljs-keyword" data-reactid="3193"><!-- react-text: 3194 -->function<!-- /react-text --></span><!-- react-text: 3195 -->(<!-- /react-text --><span class="hljs-params" data-reactid="3196"><!-- react-text: 3197 -->date<!-- /react-text --></span><!-- react-text: 3198 -->) <!-- /react-text --></span><!-- react-text: 3199 -->{
      <!-- /react-text --><span class="hljs-keyword" data-reactid="3200"><!-- react-text: 3201 -->return<!-- /react-text --></span><!-- react-text: 3202 --> moment(date).format(<!-- /react-text --><span class="hljs-string" data-reactid="3203"><!-- react-text: 3204 -->&#x27;dd-mm-yyyy&#x27;<!-- /react-text --></span><!-- react-text: 3205 -->);
    } 
  });
};

<!-- /react-text --><span class="hljs-comment" data-reactid="3206"><!-- react-text: 3207 -->// file: &lt;app folder&gt;/config/base.js<!-- /react-text --></span><!-- react-text: 3208 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="3209"><!-- react-text: 3210 -->module<!-- /react-text --></span><!-- react-text: 3211 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="3212"><span class="hljs-keyword" data-reactid="3213"><!-- react-text: 3214 -->function<!-- /react-text --></span><!-- react-text: 3215 -->(<!-- /react-text --><span class="hljs-params" data-reactid="3216"><!-- react-text: 3217 -->config<!-- /react-text --></span><!-- react-text: 3218 -->) <!-- /react-text --></span><!-- react-text: 3219 -->{
  ...
  config.startupSteps = [
    <!-- /react-text --><span class="hljs-string" data-reactid="3220"><!-- react-text: 3221 -->&#x27;helpers&#x27;<!-- /react-text --></span><!-- react-text: 3222 -->,
    ...
  ];
<!-- /react-text --></code></pre><!-- react-text: 3223 -->
<!-- /react-text --><p data-reactid="3224"><!-- react-text: 3225 -->Within your Jade template the <!-- /react-text --><code data-reactid="3226"><!-- react-text: 3227 -->prettyDate<!-- /react-text --></code><!-- react-text: 3228 --> function would now be available:<!-- /react-text --></p><!-- react-text: 3229 -->
<!-- /react-text --><pre data-reactid="3230"><code class="language-pug hljs" data-reactid="3231"><!-- react-text: 3232 -->#{<!-- /react-text --><span class="ruby" data-reactid="3233"><!-- react-text: 3234 --> prettyDate(mydate) }<!-- /react-text --></span><!-- react-text: 3235 -->
<!-- /react-text --></code></pre><!-- react-text: 3236 -->
<!-- /react-text --><h1 data-reactid="3237"><!-- react-text: 3238 -->Static resources<!-- /react-text --></h1><!-- react-text: 3239 -->
<!-- /react-text --><p data-reactid="3240"><!-- react-text: 3241 -->Waigo uses the <!-- /react-text --><a href="https://github.com/koajs/static" data-reactid="3242"><!-- react-text: 3243 -->koa-static<!-- /react-text --></a><!-- react-text: 3244 --> middleware to serve
up static resources such as  scipts, stylesheets and fonts needed by the front-
end of your web application.  The default configuration for this middleware is:<!-- /react-text --></p><!-- react-text: 3245 -->
<!-- /react-text --><pre data-reactid="3246"><code class="language-javascript hljs" data-reactid="3247"><span class="hljs-comment" data-reactid="3248"><!-- react-text: 3249 -->// &lt;waigo framework&gt;/src/config/base.js<!-- /react-text --></span><!-- react-text: 3250 -->
...
config.middleware.options.staticResources = {
  <!-- /react-text --><span class="hljs-comment" data-reactid="3251"><!-- react-text: 3252 -->// relative to app folder<!-- /react-text --></span><!-- react-text: 3253 -->
  folder: <!-- /react-text --><span class="hljs-string" data-reactid="3254"><!-- react-text: 3255 -->&#x27;../public&#x27;<!-- /react-text --></span><!-- react-text: 3256 -->,
  options: {}
};
...
<!-- /react-text --></code></pre><!-- react-text: 3257 -->
<!-- /react-text --><p data-reactid="3258"><!-- react-text: 3259 -->Thus if your app folder is located at <!-- /react-text --><code data-reactid="3260"><!-- react-text: 3261 -->/var/www/myapp<!-- /react-text --></code><!-- react-text: 3262 --> then static
resources are expected to reside in <!-- /react-text --><code data-reactid="3263"><!-- react-text: 3264 -->/var/www/public<!-- /react-text --></code><!-- react-text: 3265 -->.<!-- /react-text --></p><!-- react-text: 3266 -->
<!-- /react-text --><h1 data-reactid="3267"><!-- react-text: 3268 -->Forms<!-- /react-text --></h1><!-- react-text: 3269 -->
<!-- /react-text --><p data-reactid="3270"><!-- react-text: 3271 -->Forms are treated as first-class citizens in Waigo. Form inputs can be sanitized
and validated and a per-field error report can be generated.<!-- /react-text --></p><!-- react-text: 3272 -->
<!-- /react-text --><p data-reactid="3273"><!-- react-text: 3274 -->Each form uses a unique id; its configuration and input fields are specified in
a file under the <!-- /react-text --><code data-reactid="3275"><!-- react-text: 3276 -->forms/<!-- /react-text --></code><!-- react-text: 3277 --> path, the file name being the id of the form.<!-- /react-text --></p><!-- react-text: 3278 -->
<!-- /react-text --><p data-reactid="3279"><!-- react-text: 3280 -->For example, here is how you might specify a simple signup form:<!-- /react-text --></p><!-- react-text: 3281 -->
<!-- /react-text --><pre data-reactid="3282"><code class="language-javascript hljs" data-reactid="3283"><span class="hljs-comment" data-reactid="3284"><!-- react-text: 3285 -->// file: forms/signup.js<!-- /react-text --></span><!-- react-text: 3286 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="3287"><!-- react-text: 3288 -->module<!-- /react-text --></span><!-- react-text: 3289 -->.exports = {
  fields: [
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3290"><!-- react-text: 3291 -->&#x27;email&#x27;<!-- /react-text --></span><!-- react-text: 3292 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3293"><!-- react-text: 3294 -->&#x27;text&#x27;<!-- /react-text --></span><!-- react-text: 3295 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3296"><!-- react-text: 3297 -->&#x27;Email address&#x27;<!-- /react-text --></span><!-- react-text: 3298 -->
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3299"><!-- react-text: 3300 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3301 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3302"><!-- react-text: 3303 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3304 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3305"><!-- react-text: 3306 -->&#x27;Password&#x27;<!-- /react-text --></span><!-- react-text: 3307 -->
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3308"><!-- react-text: 3309 -->&#x27;confirm_password&#x27;<!-- /react-text --></span><!-- react-text: 3310 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3311"><!-- react-text: 3312 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3313 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3314"><!-- react-text: 3315 -->&#x27;Confirm password&#x27;<!-- /react-text --></span><!-- react-text: 3316 -->
    }
  ]  
};
<!-- /react-text --></code></pre><!-- react-text: 3317 -->
<!-- /react-text --><p data-reactid="3318"><!-- react-text: 3319 -->The field <!-- /react-text --><code data-reactid="3320"><!-- react-text: 3321 -->type<!-- /react-text --></code><!-- react-text: 3322 --> key refers to the name of a module file under the
<!-- /react-text --><code data-reactid="3323"><!-- react-text: 3324 -->support/forms/fields/<!-- /react-text --></code><!-- react-text: 3325 --> path. So for the above form specification Waigo will
expect the following paths to exist:<!-- /react-text --></p><!-- react-text: 3326 -->
<!-- /react-text --><ul data-reactid="3327"><!-- react-text: 3328 -->
<!-- /react-text --><li data-reactid="3329"><code data-reactid="3330"><!-- react-text: 3331 -->support/forms/fields/text<!-- /react-text --></code></li><!-- react-text: 3332 -->
<!-- /react-text --><li data-reactid="3333"><code data-reactid="3334"><!-- react-text: 3335 -->support/forms/fields/password<!-- /react-text --></code></li><!-- react-text: 3336 -->
<!-- /react-text --></ul><!-- react-text: 3337 -->
<!-- /react-text --><p data-reactid="3338"><!-- react-text: 3339 -->All field type classes inherit from the base <!-- /react-text --><code data-reactid="3340"><!-- react-text: 3341 -->Field<!-- /react-text --></code><!-- react-text: 3342 --> class (found in
<!-- /react-text --><code data-reactid="3343"><!-- react-text: 3344 -->support/forms/field<!-- /react-text --></code><!-- react-text: 3345 -->).<!-- /react-text --></p><!-- react-text: 3346 -->
<!-- /react-text --><p data-reactid="3347"><!-- react-text: 3348 -->To create an instance of the above form you would do:<!-- /react-text --></p><!-- react-text: 3349 -->
<!-- /react-text --><pre data-reactid="3350"><code class="language-javascript hljs" data-reactid="3351"><span class="hljs-keyword" data-reactid="3352"><!-- react-text: 3353 -->var<!-- /react-text --></span><!-- react-text: 3354 --> waigo = <!-- /react-text --><span class="hljs-built_in" data-reactid="3355"><!-- react-text: 3356 -->require<!-- /react-text --></span><!-- react-text: 3357 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3358"><!-- react-text: 3359 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 3360 -->),
  Form = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="3361"><!-- react-text: 3362 -->&#x27;support/forms/form&#x27;<!-- /react-text --></span><!-- react-text: 3363 -->).Form;

<!-- /react-text --><span class="hljs-keyword" data-reactid="3364"><!-- react-text: 3365 -->var<!-- /react-text --></span><!-- react-text: 3366 --> form = Form.new(<!-- /react-text --><span class="hljs-string" data-reactid="3367"><!-- react-text: 3368 -->&#x27;signup&#x27;<!-- /react-text --></span><!-- react-text: 3369 -->);
<!-- /react-text --></code></pre><!-- react-text: 3370 -->
<!-- /react-text --><p data-reactid="3371"><!-- react-text: 3372 -->Waigo will automatically look under the <!-- /react-text --><code data-reactid="3373"><!-- react-text: 3374 -->forms/<!-- /react-text --></code><!-- react-text: 3375 --> file path to see if a form
specification for the given id exists. It so it will load in this specification
and return a <!-- /react-text --><code data-reactid="3376"><!-- react-text: 3377 -->Form<!-- /react-text --></code><!-- react-text: 3378 --> instance.<!-- /react-text --></p><!-- react-text: 3379 -->
<!-- /react-text --><p data-reactid="3380"><!-- react-text: 3381 -->A <!-- /react-text --><code data-reactid="3382"><!-- react-text: 3383 -->Form<!-- /react-text --></code><!-- react-text: 3384 --> instance can generate a <!-- /react-text --><a href="/docs/#view-objects/" data-reactid="3385">view object</a><!-- react-text: 3386 --> representation of
itself. It looks  something like:<!-- /react-text --></p><!-- react-text: 3387 -->
<!-- /react-text --><pre data-reactid="3388"><code class="language-javascript hljs" data-reactid="3389"><!-- react-text: 3390 -->{
  <!-- /react-text --><span class="hljs-comment" data-reactid="3391"><!-- react-text: 3392 -->/* form id */<!-- /react-text --></span><!-- react-text: 3393 -->
  id: <!-- /react-text --><span class="hljs-string" data-reactid="3394"><!-- react-text: 3395 -->&quot;uniqueFormId&quot;<!-- /react-text --></span><!-- react-text: 3396 -->,

  <!-- /react-text --><span class="hljs-comment" data-reactid="3397"><!-- react-text: 3398 -->/* fields */<!-- /react-text --></span><!-- react-text: 3399 -->
  fields: {
    title: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3400"><!-- react-text: 3401 -->&quot;text&quot;<!-- /react-text --></span><!-- react-text: 3402 -->,
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3403"><!-- react-text: 3404 -->&quot;title&quot;<!-- /react-text --></span><!-- react-text: 3405 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3406"><!-- react-text: 3407 -->&quot;Title&quot;<!-- /react-text --></span><!-- react-text: 3408 -->,
      value: <!-- /react-text --><span class="hljs-literal" data-reactid="3409"><!-- react-text: 3410 -->null<!-- /react-text --></span><!-- react-text: 3411 -->,
      originalValue: <!-- /react-text --><span class="hljs-literal" data-reactid="3412"><!-- react-text: 3413 -->null<!-- /react-text --></span><!-- react-text: 3414 -->   <!-- /react-text --><span class="hljs-comment" data-reactid="3415"><!-- react-text: 3416 -->/* see &#x27;Dirty checking&#x27; section for explanation */<!-- /react-text --></span><!-- react-text: 3417 -->
    },
    body: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3418"><!-- react-text: 3419 -->&quot;text&quot;<!-- /react-text --></span><!-- react-text: 3420 -->,
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3421"><!-- react-text: 3422 -->&quot;body&quot;<!-- /react-text --></span><!-- react-text: 3423 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3424"><!-- react-text: 3425 -->&quot;Body&quot;<!-- /react-text --></span><!-- react-text: 3426 -->,
      value: <!-- /react-text --><span class="hljs-literal" data-reactid="3427"><!-- react-text: 3428 -->null<!-- /react-text --></span><!-- react-text: 3429 -->,
      originalValue: <!-- /react-text --><span class="hljs-literal" data-reactid="3430"><!-- react-text: 3431 -->null<!-- /react-text --></span><!-- react-text: 3432 -->     
    },
    comment: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3433"><!-- react-text: 3434 -->&quot;text&quot;<!-- /react-text --></span><!-- react-text: 3435 -->,
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3436"><!-- react-text: 3437 -->&quot;comment&quot;<!-- /react-text --></span><!-- react-text: 3438 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3439"><!-- react-text: 3440 -->&quot;Comment&quot;<!-- /react-text --></span><!-- react-text: 3441 -->,
      value: <!-- /react-text --><span class="hljs-literal" data-reactid="3442"><!-- react-text: 3443 -->null<!-- /react-text --></span><!-- react-text: 3444 -->,
      originalValue: <!-- /react-text --><span class="hljs-literal" data-reactid="3445"><!-- react-text: 3446 -->null<!-- /react-text --></span><!-- react-text: 3447 -->     
    }
  },

  <!-- /react-text --><span class="hljs-comment" data-reactid="3448"><!-- react-text: 3449 -->/* the suggested display order for the fields, based on the form spec */<!-- /react-text --></span><!-- react-text: 3450 -->
  order: [
    <!-- /react-text --><span class="hljs-string" data-reactid="3451"><!-- react-text: 3452 -->&quot;title&quot;<!-- /react-text --></span><!-- react-text: 3453 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="3454"><!-- react-text: 3455 -->&quot;body&quot;<!-- /react-text --></span><!-- react-text: 3456 -->,
    <!-- /react-text --><span class="hljs-string" data-reactid="3457"><!-- react-text: 3458 -->&quot;comment&quot;<!-- /react-text --></span><!-- react-text: 3459 -->
  ]
}
<!-- /react-text --></code></pre><!-- react-text: 3460 -->
<!-- /react-text --><h2 data-reactid="3461"><!-- react-text: 3462 -->Internal state<!-- /react-text --></h2><!-- react-text: 3463 -->
<!-- /react-text --><p data-reactid="3464"><!-- react-text: 3465 -->Sometimes we may wish to restore a form to a previous state. The form
architecture allows for this exposing the ability to get and set the form’s
internal state. This state contains the current field values too.<!-- /react-text --></p><!-- react-text: 3466 -->
<!-- /react-text --><pre data-reactid="3467"><code class="language-javascript hljs" data-reactid="3468"><span class="hljs-comment" data-reactid="3469"><!-- react-text: 3470 -->// save the form state<!-- /react-text --></span><!-- react-text: 3471 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="3472"><!-- react-text: 3473 -->var<!-- /react-text --></span><!-- react-text: 3474 --> form = Form.new(<!-- /react-text --><span class="hljs-string" data-reactid="3475"><!-- react-text: 3476 -->&#x27;signup&#x27;<!-- /react-text --></span><!-- react-text: 3477 -->);
<!-- /react-text --><span class="hljs-keyword" data-reactid="3478"><!-- react-text: 3479 -->yield<!-- /react-text --></span><!-- react-text: 3480 --> form.setValues( <!-- /react-text --><span class="hljs-comment" data-reactid="3481"><!-- react-text: 3482 -->/* user input values */<!-- /react-text --></span><!-- react-text: 3483 --> );
<!-- /react-text --><span class="hljs-keyword" data-reactid="3484"><!-- react-text: 3485 -->this<!-- /react-text --></span><!-- react-text: 3486 -->.session.formState = form.state;
...
<!-- /react-text --><span class="hljs-comment" data-reactid="3487"><!-- react-text: 3488 -->// restore the form (and field values) to previous state<!-- /react-text --></span><!-- react-text: 3489 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="3490"><!-- react-text: 3491 -->var<!-- /react-text --></span><!-- react-text: 3492 --> form = Form.new(<!-- /react-text --><span class="hljs-string" data-reactid="3493"><!-- react-text: 3494 -->&#x27;signup&#x27;<!-- /react-text --></span><!-- react-text: 3495 -->);
form.state = <!-- /react-text --><span class="hljs-keyword" data-reactid="3496"><!-- react-text: 3497 -->this<!-- /react-text --></span><!-- react-text: 3498 -->.session.formState;
<!-- /react-text --></code></pre><!-- react-text: 3499 -->
<!-- /react-text --><p data-reactid="3500"><!-- react-text: 3501 -->We can also set the internal state during construction:<!-- /react-text --></p><!-- react-text: 3502 -->
<!-- /react-text --><pre data-reactid="3503"><code class="language-javascript hljs" data-reactid="3504"><span class="hljs-keyword" data-reactid="3505"><!-- react-text: 3506 -->var<!-- /react-text --></span><!-- react-text: 3507 --> form = Form.new(<!-- /react-text --><span class="hljs-string" data-reactid="3508"><!-- react-text: 3509 -->&#x27;signup&#x27;<!-- /react-text --></span><!-- react-text: 3510 -->, <!-- /react-text --><span class="hljs-keyword" data-reactid="3511"><!-- react-text: 3512 -->this<!-- /react-text --></span><!-- react-text: 3513 -->.session.formState);
<!-- /react-text --></code></pre><!-- react-text: 3514 -->
<!-- /react-text --><h2 data-reactid="3515"><!-- react-text: 3516 -->Sanitization<!-- /react-text --></h2><!-- react-text: 3517 -->
<!-- /react-text --><p data-reactid="3518"><!-- react-text: 3519 -->When setting form field values Waigo first sanitizes them. Sanitization is
specified on a per-field basis in the form configuration. Let’s trim all user
input to our signup form:<!-- /react-text --></p><!-- react-text: 3520 -->
<!-- /react-text --><pre data-reactid="3521"><code class="language-javascript hljs" data-reactid="3522"><span class="hljs-comment" data-reactid="3523"><!-- react-text: 3524 -->// file: forms/signup.js<!-- /react-text --></span><!-- react-text: 3525 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="3526"><!-- react-text: 3527 -->module<!-- /react-text --></span><!-- react-text: 3528 -->.exports = {
  fields: [
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3529"><!-- react-text: 3530 -->&#x27;email&#x27;<!-- /react-text --></span><!-- react-text: 3531 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3532"><!-- react-text: 3533 -->&#x27;text&#x27;<!-- /react-text --></span><!-- react-text: 3534 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3535"><!-- react-text: 3536 -->&#x27;Email address&#x27;<!-- /react-text --></span><!-- react-text: 3537 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3538"><!-- react-text: 3539 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3540 --> ]
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3541"><!-- react-text: 3542 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3543 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3544"><!-- react-text: 3545 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3546 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3547"><!-- react-text: 3548 -->&#x27;Password&#x27;<!-- /react-text --></span><!-- react-text: 3549 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3550"><!-- react-text: 3551 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3552 --> ]
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3553"><!-- react-text: 3554 -->&#x27;confirm_password&#x27;<!-- /react-text --></span><!-- react-text: 3555 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3556"><!-- react-text: 3557 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3558 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3559"><!-- react-text: 3560 -->&#x27;Confirm password&#x27;<!-- /react-text --></span><!-- react-text: 3561 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3562"><!-- react-text: 3563 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3564 --> ]
    }
  ]  
};
<!-- /react-text --></code></pre><!-- react-text: 3565 -->
<!-- /react-text --><p data-reactid="3566"><!-- react-text: 3567 -->Each item in the <!-- /react-text --><code data-reactid="3568"><!-- react-text: 3569 -->sanitizers<!-- /react-text --></code><!-- react-text: 3570 --> array refers to the name of a module file under
the <!-- /react-text --><code data-reactid="3571"><!-- react-text: 3572 -->support/forms/sanitizers/<!-- /react-text --></code><!-- react-text: 3573 --> path. So for the above form specification Waigo
will expect the following path to exist:<!-- /react-text --></p><!-- react-text: 3574 -->
<!-- /react-text --><ul data-reactid="3575"><!-- react-text: 3576 -->
<!-- /react-text --><li data-reactid="3577"><code data-reactid="3578"><!-- react-text: 3579 -->support/forms/sanitizers/trim<!-- /react-text --></code></li><!-- react-text: 3580 -->
<!-- /react-text --></ul><!-- react-text: 3581 -->
<!-- /react-text --><p data-reactid="3582"><!-- react-text: 3583 -->A sanitizer module should export a single function which returns a generator
function (this performs the actual sanitization). For example, Waigo’s built-in
<!-- /react-text --><code data-reactid="3584"><!-- react-text: 3585 -->trim<!-- /react-text --></code><!-- react-text: 3586 --> sanitizer looks like this:<!-- /react-text --></p><!-- react-text: 3587 -->
<!-- /react-text --><pre data-reactid="3588"><code class="language-javascript hljs" data-reactid="3589"><span class="hljs-keyword" data-reactid="3590"><!-- react-text: 3591 -->var<!-- /react-text --></span><!-- react-text: 3592 --> validatorSanitizer = <!-- /react-text --><span class="hljs-built_in" data-reactid="3593"><!-- react-text: 3594 -->require<!-- /react-text --></span><!-- react-text: 3595 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3596"><!-- react-text: 3597 -->&#x27;validator&#x27;<!-- /react-text --></span><!-- react-text: 3598 -->);

<!-- /react-text --><span class="hljs-built_in" data-reactid="3599"><!-- react-text: 3600 -->module<!-- /react-text --></span><!-- react-text: 3601 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="3602"><span class="hljs-keyword" data-reactid="3603"><!-- react-text: 3604 -->function<!-- /react-text --></span><!-- react-text: 3605 -->(<!-- /react-text --><span class="hljs-params" data-reactid="3606"></span><!-- react-text: 3607 -->) <!-- /react-text --></span><!-- react-text: 3608 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="3609"><!-- react-text: 3610 -->return<!-- /react-text --></span><!-- react-text: 3611 --> <!-- /react-text --><span class="hljs-function" data-reactid="3612"><span class="hljs-keyword" data-reactid="3613"><!-- react-text: 3614 -->function<!-- /react-text --></span><!-- react-text: 3615 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="3616"><!-- react-text: 3617 -->form, field, value<!-- /react-text --></span><!-- react-text: 3618 -->) <!-- /react-text --></span><!-- react-text: 3619 -->{
    <!-- /react-text --><span class="hljs-keyword" data-reactid="3620"><!-- react-text: 3621 -->return<!-- /react-text --></span><!-- react-text: 3622 --> validatorSanitizer.trim(value);
  }
};

<!-- /react-text --></code></pre><!-- react-text: 3623 -->
<!-- /react-text --><p data-reactid="3624"><!-- react-text: 3625 -->If sanitization fails then a <!-- /react-text --><code data-reactid="3626"><!-- react-text: 3627 -->FieldSanitizationError<!-- /react-text --></code><!-- react-text: 3628 --> error gets thrown
for the field for which it failed.<!-- /react-text --></p><!-- react-text: 3629 -->
<!-- /react-text --><p data-reactid="3630"><!-- react-text: 3631 -->The actual sanitization function gets passed a <!-- /react-text --><code data-reactid="3632"><!-- react-text: 3633 -->Form<!-- /react-text --></code><!-- react-text: 3634 --> and <!-- /react-text --><code data-reactid="3635"><!-- react-text: 3636 -->Field<!-- /react-text --></code><!-- react-text: 3637 --> reference
corresponding to the actual form and field it is operating on. This makes it
possible to build complex sanitizers which can query other fields and the form
itself.<!-- /react-text --></p><!-- react-text: 3638 -->
<!-- /react-text --><p data-reactid="3639"><!-- react-text: 3640 -->Note that you can set field values without sanitization processing:<!-- /react-text --></p><!-- react-text: 3641 -->
<!-- /react-text --><pre data-reactid="3642"><code class="language-javascript hljs" data-reactid="3643"><span class="hljs-comment" data-reactid="3644"><!-- react-text: 3645 -->// without sanitization<!-- /react-text --></span><!-- react-text: 3646 -->
form.fields.email.value = <!-- /react-text --><span class="hljs-string" data-reactid="3647"><!-- react-text: 3648 -->&#x27;me@univers.com&#x27;<!-- /react-text --></span><!-- react-text: 3649 -->;

<!-- /react-text --><span class="hljs-comment" data-reactid="3650"><!-- react-text: 3651 -->// with sanitization (this will set .value after sanitization is complete)<!-- /react-text --></span><!-- react-text: 3652 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="3653"><!-- react-text: 3654 -->yield<!-- /react-text --></span><!-- react-text: 3655 --> form.fields.email.setSanitizedValue(<!-- /react-text --><span class="hljs-string" data-reactid="3656"><!-- react-text: 3657 -->&#x27;ram@hiddentao.com&#x27;<!-- /react-text --></span><!-- react-text: 3658 -->);
<!-- /react-text --></code></pre><!-- react-text: 3659 -->
<!-- /react-text --><p data-reactid="3660"><!-- react-text: 3661 -->Setting values for multiple fields:<!-- /react-text --></p><!-- react-text: 3662 -->
<!-- /react-text --><pre data-reactid="3663"><code class="language-javascript hljs" data-reactid="3664"><span class="hljs-comment" data-reactid="3665"><!-- react-text: 3666 -->// this calls Field.prototype.setSanitizedValue<!-- /react-text --></span><!-- react-text: 3667 -->
<!-- /react-text --><span class="hljs-keyword" data-reactid="3668"><!-- react-text: 3669 -->yield<!-- /react-text --></span><!-- react-text: 3670 --> form.setValues({
  email: <!-- /react-text --><span class="hljs-string" data-reactid="3671"><!-- react-text: 3672 -->&#x27;ram@hiddentao.com&#x27;<!-- /react-text --></span><!-- react-text: 3673 -->,
  password: <!-- /react-text --><span class="hljs-string" data-reactid="3674"><!-- react-text: 3675 -->&#x27;test&#x27;<!-- /react-text --></span><!-- react-text: 3676 -->
});
<!-- /react-text --></code></pre><!-- react-text: 3677 -->
<!-- /react-text --><h2 data-reactid="3678"><!-- react-text: 3679 -->Validation<!-- /react-text --></h2><!-- react-text: 3680 -->
<!-- /react-text --><p data-reactid="3681"><!-- react-text: 3682 -->Once form field values have been set we can validate them by calling
<!-- /react-text --><code data-reactid="3683"><!-- react-text: 3684 -->Form.prototype.validate()<!-- /react-text --></code><!-- react-text: 3685 -->. Validation is specified on a per-field basis in the
form configuration. Let’s validate our signup form:<!-- /react-text --></p><!-- react-text: 3686 -->
<!-- /react-text --><pre data-reactid="3687"><code class="language-javascript hljs" data-reactid="3688"><span class="hljs-comment" data-reactid="3689"><!-- react-text: 3690 -->// file: forms/signup.js<!-- /react-text --></span><!-- react-text: 3691 -->

<!-- /react-text --><span class="hljs-built_in" data-reactid="3692"><!-- react-text: 3693 -->module<!-- /react-text --></span><!-- react-text: 3694 -->.exports = {
  fields: [
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3695"><!-- react-text: 3696 -->&#x27;email&#x27;<!-- /react-text --></span><!-- react-text: 3697 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3698"><!-- react-text: 3699 -->&#x27;text&#x27;<!-- /react-text --></span><!-- react-text: 3700 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3701"><!-- react-text: 3702 -->&#x27;Email address&#x27;<!-- /react-text --></span><!-- react-text: 3703 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3704"><!-- react-text: 3705 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3706 --> ],
      validators: [ <!-- /react-text --><span class="hljs-string" data-reactid="3707"><!-- react-text: 3708 -->&#x27;notEmpty&#x27;<!-- /react-text --></span><!-- react-text: 3709 -->, <!-- /react-text --><span class="hljs-string" data-reactid="3710"><!-- react-text: 3711 -->&#x27;isEmailAddress&#x27;<!-- /react-text --></span><!-- react-text: 3712 --> ]
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3713"><!-- react-text: 3714 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3715 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3716"><!-- react-text: 3717 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3718 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3719"><!-- react-text: 3720 -->&#x27;Password&#x27;<!-- /react-text --></span><!-- react-text: 3721 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3722"><!-- react-text: 3723 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3724 --> ],
      validators: [ <!-- /react-text --><span class="hljs-string" data-reactid="3725"><!-- react-text: 3726 -->&#x27;notEmpty&#x27;<!-- /react-text --></span><!-- react-text: 3727 -->, { id: <!-- /react-text --><span class="hljs-string" data-reactid="3728"><!-- react-text: 3729 -->&#x27;isLength&#x27;<!-- /react-text --></span><!-- react-text: 3730 -->, min: <!-- /react-text --><span class="hljs-number" data-reactid="3731"><!-- react-text: 3732 -->8<!-- /react-text --></span><!-- react-text: 3733 --> } ]
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3734"><!-- react-text: 3735 -->&#x27;confirm_password&#x27;<!-- /react-text --></span><!-- react-text: 3736 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3737"><!-- react-text: 3738 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3739 -->,
      label: <!-- /react-text --><span class="hljs-string" data-reactid="3740"><!-- react-text: 3741 -->&#x27;Confirm password&#x27;<!-- /react-text --></span><!-- react-text: 3742 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3743"><!-- react-text: 3744 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3745 --> ],
      validators: [ { id: <!-- /react-text --><span class="hljs-string" data-reactid="3746"><!-- react-text: 3747 -->&#x27;matchesField&#x27;<!-- /react-text --></span><!-- react-text: 3748 -->, field: <!-- /react-text --><span class="hljs-string" data-reactid="3749"><!-- react-text: 3750 -->&#x27;password&#x27;<!-- /react-text --></span><!-- react-text: 3751 --> } ]
    }
  ]  
};
<!-- /react-text --></code></pre><!-- react-text: 3752 -->
<!-- /react-text --><p data-reactid="3753"><!-- react-text: 3754 -->Each item in the <!-- /react-text --><code data-reactid="3755"><!-- react-text: 3756 -->validators<!-- /react-text --></code><!-- react-text: 3757 --> array refers to the name of a module file under
the <!-- /react-text --><code data-reactid="3758"><!-- react-text: 3759 -->support/forms/validators/<!-- /react-text --></code><!-- react-text: 3760 --> path. When a validator (or even sanitizer) is
specified as an object then its <!-- /react-text --><code data-reactid="3761"><!-- react-text: 3762 -->id<!-- /react-text --></code><!-- react-text: 3763 --> attribute is assumed to be its module file
name. The object itself is assumed to be a set of options to pass to the
module file during initialisation.<!-- /react-text --></p><!-- react-text: 3764 -->
<!-- /react-text --><p data-reactid="3765"><!-- react-text: 3766 -->So for the above form specification Waigo will expect the following paths to exist:<!-- /react-text --></p><!-- react-text: 3767 -->
<!-- /react-text --><ul data-reactid="3768"><!-- react-text: 3769 -->
<!-- /react-text --><li data-reactid="3770"><code data-reactid="3771"><!-- react-text: 3772 -->support/forms/validators/notEmpty<!-- /react-text --></code></li><!-- react-text: 3773 -->
<!-- /react-text --><li data-reactid="3774"><code data-reactid="3775"><!-- react-text: 3776 -->support/forms/validators/isLength<!-- /react-text --></code></li><!-- react-text: 3777 -->
<!-- /react-text --><li data-reactid="3778"><code data-reactid="3779"><!-- react-text: 3780 -->support/forms/validators/matchesField<!-- /react-text --></code></li><!-- react-text: 3781 -->
<!-- /react-text --></ul><!-- react-text: 3782 -->
<!-- /react-text --><p data-reactid="3783"><!-- react-text: 3784 -->A validator module exports a single function which should return a generator
function (this performs the actual validation). For example, Waigo’s built-in
<!-- /react-text --><code data-reactid="3785"><!-- react-text: 3786 -->isEmailAddress<!-- /react-text --></code><!-- react-text: 3787 --> validator looks like this:<!-- /react-text --></p><!-- react-text: 3788 -->
<!-- /react-text --><pre data-reactid="3789"><code class="language-javascript hljs" data-reactid="3790"><span class="hljs-keyword" data-reactid="3791"><!-- react-text: 3792 -->var<!-- /react-text --></span><!-- react-text: 3793 --> validator = <!-- /react-text --><span class="hljs-built_in" data-reactid="3794"><!-- react-text: 3795 -->require<!-- /react-text --></span><!-- react-text: 3796 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3797"><!-- react-text: 3798 -->&#x27;validator&#x27;<!-- /react-text --></span><!-- react-text: 3799 -->);

<!-- /react-text --><span class="hljs-built_in" data-reactid="3800"><!-- react-text: 3801 -->module<!-- /react-text --></span><!-- react-text: 3802 -->.exports = <!-- /react-text --><span class="hljs-function" data-reactid="3803"><span class="hljs-keyword" data-reactid="3804"><!-- react-text: 3805 -->function<!-- /react-text --></span><!-- react-text: 3806 -->(<!-- /react-text --><span class="hljs-params" data-reactid="3807"></span><!-- react-text: 3808 -->) <!-- /react-text --></span><!-- react-text: 3809 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="3810"><!-- react-text: 3811 -->return<!-- /react-text --></span><!-- react-text: 3812 --> <!-- /react-text --><span class="hljs-function" data-reactid="3813"><span class="hljs-keyword" data-reactid="3814"><!-- react-text: 3815 -->function<!-- /react-text --></span><!-- react-text: 3816 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="3817"><!-- react-text: 3818 -->form, field, value<!-- /react-text --></span><!-- react-text: 3819 -->) <!-- /react-text --></span><!-- react-text: 3820 -->{
    <!-- /react-text --><span class="hljs-keyword" data-reactid="3821"><!-- react-text: 3822 -->if<!-- /react-text --></span><!-- react-text: 3823 --> (!validator.isEmail(value)) {
      <!-- /react-text --><span class="hljs-keyword" data-reactid="3824"><!-- react-text: 3825 -->throw<!-- /react-text --></span><!-- react-text: 3826 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="3827"><!-- react-text: 3828 -->new<!-- /react-text --></span><!-- react-text: 3829 --> <!-- /react-text --><span class="hljs-built_in" data-reactid="3830"><!-- react-text: 3831 -->Error<!-- /react-text --></span><!-- react-text: 3832 -->(<!-- /react-text --><span class="hljs-string" data-reactid="3833"><!-- react-text: 3834 -->&#x27;Must be an email address&#x27;<!-- /react-text --></span><!-- react-text: 3835 -->);
    }
  }
};

<!-- /react-text --></code></pre><!-- react-text: 3836 -->
<!-- /react-text --><p data-reactid="3837"><!-- react-text: 3838 -->The actual validation function gets passed a <!-- /react-text --><code data-reactid="3839"><!-- react-text: 3840 -->Form<!-- /react-text --></code><!-- react-text: 3841 --> and <!-- /react-text --><code data-reactid="3842"><!-- react-text: 3843 -->Field<!-- /react-text --></code><!-- react-text: 3844 --> reference
corresponding to the actual form and field it is operating on. This makes it
possible to build complex validators which can query other fields and the form
itself.<!-- /react-text --></p><!-- react-text: 3845 -->
<!-- /react-text --><h2 data-reactid="3846"><!-- react-text: 3847 -->Validation errors<!-- /react-text --></h2><!-- react-text: 3848 -->
<!-- /react-text --><p data-reactid="3849"><!-- react-text: 3850 -->Validaton error reporting is very comprehensive and makes it easy to show the
end-user exactly what failed to validate and why.<!-- /react-text --></p><!-- react-text: 3851 -->
<!-- /react-text --><p data-reactid="3852"><!-- react-text: 3853 -->This is what happens when <!-- /react-text --><code data-reactid="3854"><!-- react-text: 3855 -->Form.prototype.validate()<!-- /react-text --></code><!-- react-text: 3856 --> gets called:<!-- /react-text --></p><!-- react-text: 3857 -->
<!-- /react-text --><ol data-reactid="3858"><!-- react-text: 3859 -->
<!-- /react-text --><li data-reactid="3860"><code data-reactid="3861"><!-- react-text: 3862 -->Field.prototype.validate()<!-- /react-text --></code><!-- react-text: 3863 --> gets called for each field belonging to the form.<!-- /react-text --></li><!-- react-text: 3864 -->
<!-- /react-text --><li data-reactid="3865"><!-- react-text: 3866 -->For each field every validator gets run and all validation errors are
grouped together within a single <!-- /react-text --><code data-reactid="3867"><!-- react-text: 3868 -->FieldValidationError<!-- /react-text --></code><!-- react-text: 3869 --> instance.<!-- /react-text --></li><!-- react-text: 3870 -->
<!-- /react-text --><li data-reactid="3871"><!-- react-text: 3872 -->In <!-- /react-text --><code data-reactid="3873"><!-- react-text: 3874 -->Form.prototype.validate()<!-- /react-text --></code><!-- react-text: 3875 --> all field validation errors are grouped
together within a single <!-- /react-text --><code data-reactid="3876"><!-- react-text: 3877 -->FormValidationError<!-- /react-text --></code><!-- react-text: 3878 --> instance.<!-- /react-text --></li><!-- react-text: 3879 -->
<!-- /react-text --></ol><!-- react-text: 3880 -->
<!-- /react-text --><p data-reactid="3881"><!-- react-text: 3882 -->When sending this error object back to the client it’s view object
representation gets generated and looks something like:<!-- /react-text --></p><!-- react-text: 3883 -->
<!-- /react-text --><pre data-reactid="3884"><code class="language-javascript hljs" data-reactid="3885"><!-- react-text: 3886 -->{
  type: <!-- /react-text --><span class="hljs-string" data-reactid="3887"><!-- react-text: 3888 -->&#x27;FormValidationError&#x27;<!-- /react-text --></span><!-- react-text: 3889 -->,
  msg: <!-- /react-text --><span class="hljs-string" data-reactid="3890"><!-- react-text: 3891 -->&#x27;Form validation failed&#x27;<!-- /react-text --></span><!-- react-text: 3892 -->,
  errors: {
    field1: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3893"><!-- react-text: 3894 -->&#x27;FieldValidationError&#x27;<!-- /react-text --></span><!-- react-text: 3895 -->,
      msg: <!-- /react-text --><span class="hljs-string" data-reactid="3896"><!-- react-text: 3897 -->&#x27;Field validation failed&#x27;<!-- /react-text --></span><!-- react-text: 3898 -->,
      errors: {
        notEmpty: {
          type: <!-- /react-text --><span class="hljs-string" data-reactid="3899"><!-- react-text: 3900 -->&#x27;Error&#x27;<!-- /react-text --></span><!-- react-text: 3901 -->,
          msg: <!-- /react-text --><span class="hljs-string" data-reactid="3902"><!-- react-text: 3903 -->&#x27;Must not be empty&#x27;<!-- /react-text --></span><!-- react-text: 3904 -->
        },
        isEmailAddress: {
          type: <!-- /react-text --><span class="hljs-string" data-reactid="3905"><!-- react-text: 3906 -->&#x27;RuntimeError&#x27;<!-- /react-text --></span><!-- react-text: 3907 -->,
          msg: <!-- /react-text --><span class="hljs-string" data-reactid="3908"><!-- react-text: 3909 -->&#x27;Must be email address&#x27;<!-- /react-text --></span><!-- react-text: 3910 -->
        },
        ...
      }
    },
    ...
  }
}
<!-- /react-text --></code></pre><!-- react-text: 3911 -->
<!-- /react-text --><p data-reactid="3912"><!-- react-text: 3913 -->Sometimes you might not need such detail and may simply wish to display the
specific error messages associated with each field. In such cases set the
following inside your controller, prior to rendering output:<!-- /react-text --></p><!-- react-text: 3914 -->
<!-- /react-text --><pre data-reactid="3915"><code class="language-javascript hljs" data-reactid="3916"><span class="hljs-keyword" data-reactid="3917"><!-- react-text: 3918 -->this<!-- /react-text --></span><!-- react-text: 3919 -->.request.leanErrors = <!-- /react-text --><span class="hljs-literal" data-reactid="3920"><!-- react-text: 3921 -->true<!-- /react-text --></span><!-- react-text: 3922 -->;
<!-- /react-text --></code></pre><!-- react-text: 3923 -->
<!-- /react-text --><p data-reactid="3924"><!-- react-text: 3925 -->The final view object will look like:<!-- /react-text --></p><!-- react-text: 3926 -->
<!-- /react-text --><pre data-reactid="3927"><code class="language-javascript hljs" data-reactid="3928"><!-- react-text: 3929 -->{
  type: <!-- /react-text --><span class="hljs-string" data-reactid="3930"><!-- react-text: 3931 -->&#x27;FormValidationError&#x27;<!-- /react-text --></span><!-- react-text: 3932 -->,
  msg: <!-- /react-text --><span class="hljs-string" data-reactid="3933"><!-- react-text: 3934 -->&#x27;Form validation failed&#x27;<!-- /react-text --></span><!-- react-text: 3935 -->,
  fields: {
    field1: [
      <!-- /react-text --><span class="hljs-string" data-reactid="3936"><!-- react-text: 3937 -->&#x27;Must not be empty&#x27;<!-- /react-text --></span><!-- react-text: 3938 -->,
      <!-- /react-text --><span class="hljs-string" data-reactid="3939"><!-- react-text: 3940 -->&#x27;Must be email address&#x27;<!-- /react-text --></span><!-- react-text: 3941 -->,
      ...
    ],
    ...
  }
}
<!-- /react-text --></code></pre><!-- react-text: 3942 -->
<!-- /react-text --><h2 data-reactid="3943"><!-- react-text: 3944 -->Dirty checking<!-- /react-text --></h2><!-- react-text: 3945 -->
<!-- /react-text --><p data-reactid="3946"><!-- react-text: 3947 -->Form fields have two types of values - <!-- /react-text --><em data-reactid="3948"><!-- react-text: 3949 -->original values<!-- /react-text --></em><!-- react-text: 3950 --> and <!-- /react-text --><em data-reactid="3951"><!-- react-text: 3952 -->current values<!-- /react-text --></em><!-- react-text: 3953 -->.
Sanitization and validation takes place on a form’s current values, and these
are the values input by the user.<!-- /react-text --></p><!-- react-text: 3954 -->
<!-- /react-text --><p data-reactid="3955"><!-- react-text: 3956 -->Original values on the other hand are meant to represent the original
values of the form’s various input fields when the form gets displayed to
the user. You are not forced to set or use original values, but they’re
useful if you wish to check whether the user made any changes to the form.<!-- /react-text --></p><!-- react-text: 3957 -->
<!-- /react-text --><p data-reactid="3958"><!-- react-text: 3959 -->Every <!-- /react-text --><code data-reactid="3960"><!-- react-text: 3961 -->Field<!-- /react-text --></code><!-- react-text: 3962 --> instance exposes an <!-- /react-text --><code data-reactid="3963"><!-- react-text: 3964 -->isDirty()<!-- /react-text --></code><!-- react-text: 3965 --> method to check whether the
current value differs from the original value. Every <!-- /react-text --><code data-reactid="3966"><!-- react-text: 3967 -->Form<!-- /react-text --></code><!-- react-text: 3968 --> instance also
exposes this method, which simply calls through to the same for every one of
its  fields. If even one field is dirty then the form is considered dirty.<!-- /react-text --></p><!-- react-text: 3969 -->
<!-- /react-text --><p data-reactid="3970"><!-- react-text: 3971 -->Let’s see how this works in pracice…<!-- /react-text --></p><!-- react-text: 3972 -->
<!-- /react-text --><p data-reactid="3973"><!-- react-text: 3974 -->Say the user signed up to our site with a name and telephone number. They wish
to edit these details. The form for this:<!-- /react-text --></p><!-- react-text: 3975 -->
<!-- /react-text --><pre data-reactid="3976"><code class="language-javascript hljs" data-reactid="3977"><span class="hljs-comment" data-reactid="3978"><!-- react-text: 3979 -->// file: &lt;app folder&gt;/forms/editProfile.js<!-- /react-text --></span><!-- react-text: 3980 -->

{
  id: <!-- /react-text --><span class="hljs-string" data-reactid="3981"><!-- react-text: 3982 -->&#x27;editProfile&#x27;<!-- /react-text --></span><!-- react-text: 3983 -->,
  fields: [
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3984"><!-- react-text: 3985 -->&#x27;name&#x27;<!-- /react-text --></span><!-- react-text: 3986 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3987"><!-- react-text: 3988 -->&#x27;text&#x27;<!-- /react-text --></span><!-- react-text: 3989 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="3990"><!-- react-text: 3991 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 3992 --> ],
      validators: [ <!-- /react-text --><span class="hljs-string" data-reactid="3993"><!-- react-text: 3994 -->&#x27;notEmpty&#x27;<!-- /react-text --></span><!-- react-text: 3995 --> ]
    },
    {
      name: <!-- /react-text --><span class="hljs-string" data-reactid="3996"><!-- react-text: 3997 -->&#x27;phone&#x27;<!-- /react-text --></span><!-- react-text: 3998 -->,
      type: <!-- /react-text --><span class="hljs-string" data-reactid="3999"><!-- react-text: 4000 -->&#x27;text&#x27;<!-- /react-text --></span><!-- react-text: 4001 -->,
      sanitizers: [ <!-- /react-text --><span class="hljs-string" data-reactid="4002"><!-- react-text: 4003 -->&#x27;trim&#x27;<!-- /react-text --></span><!-- react-text: 4004 --> ],
      validators: [ <!-- /react-text --><span class="hljs-string" data-reactid="4005"><!-- react-text: 4006 -->&#x27;notEmpty&#x27;<!-- /react-text --></span><!-- react-text: 4007 -->, <!-- /react-text --><span class="hljs-string" data-reactid="4008"><!-- react-text: 4009 -->&#x27;isPhoneNumber&#x27;<!-- /react-text --></span><!-- react-text: 4010 --> ]
    }
  ]  
}
<!-- /react-text --></code></pre><!-- react-text: 4011 -->
<!-- /react-text --><p data-reactid="4012"><!-- react-text: 4013 -->When the user submits the form we wish to find out whether they have made any
changes. In the route handler which processes the user submission we might have:<!-- /react-text --></p><!-- react-text: 4014 -->
<!-- /react-text --><pre data-reactid="4015"><code class="language-javascript hljs" data-reactid="4016"><span class="hljs-comment" data-reactid="4017"><!-- react-text: 4018 -->// file: &lt;app folder&gt;/controllers/profile.js<!-- /react-text --></span><!-- react-text: 4019 -->

exports.updateProfile = <!-- /react-text --><span class="hljs-function" data-reactid="4020"><span class="hljs-keyword" data-reactid="4021"><!-- react-text: 4022 -->function<!-- /react-text --></span><!-- react-text: 4023 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="4024"><!-- react-text: 4025 -->next<!-- /react-text --></span><!-- react-text: 4026 -->) <!-- /react-text --></span><!-- react-text: 4027 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="4028"><!-- react-text: 4029 -->var<!-- /react-text --></span><!-- react-text: 4030 --> model = {
    name: <!-- /react-text --><span class="hljs-comment" data-reactid="4031"><!-- react-text: 4032 -->//...existing name...<!-- /react-text --></span><!-- react-text: 4033 -->
    phone: <!-- /react-text --><span class="hljs-comment" data-reactid="4034"><!-- react-text: 4035 -->//...exiting phone number...<!-- /react-text --></span><!-- react-text: 4036 -->
  };  

  <!-- /react-text --><span class="hljs-keyword" data-reactid="4037"><!-- react-text: 4038 -->try<!-- /react-text --></span><!-- react-text: 4039 --> {
    <!-- /react-text --><span class="hljs-keyword" data-reactid="4040"><!-- react-text: 4041 -->var<!-- /react-text --></span><!-- react-text: 4042 --> form = Form.new(<!-- /react-text --><span class="hljs-string" data-reactid="4043"><!-- react-text: 4044 -->&#x27;editProfile&#x27;<!-- /react-text --></span><!-- react-text: 4045 -->);
    <!-- /react-text --><span class="hljs-keyword" data-reactid="4046"><!-- react-text: 4047 -->yield<!-- /react-text --></span><!-- react-text: 4048 --> form.setOriginalValues(model);
    <!-- /react-text --><span class="hljs-keyword" data-reactid="4049"><!-- react-text: 4050 -->yield<!-- /react-text --></span><!-- react-text: 4051 --> form.setValues(<!-- /react-text --><span class="hljs-keyword" data-reactid="4052"><!-- react-text: 4053 -->this<!-- /react-text --></span><!-- react-text: 4054 -->.request.body);
    <!-- /react-text --><span class="hljs-keyword" data-reactid="4055"><!-- react-text: 4056 -->yield<!-- /react-text --></span><!-- react-text: 4057 --> form.validate();

    <!-- /react-text --><span class="hljs-keyword" data-reactid="4058"><!-- react-text: 4059 -->if<!-- /react-text --></span><!-- react-text: 4060 --> (form.isDirty()) {
      <!-- /react-text --><span class="hljs-comment" data-reactid="4061"><!-- react-text: 4062 -->//...update model data and persist...<!-- /react-text --></span><!-- react-text: 4063 -->
    }

    <!-- /react-text --><span class="hljs-keyword" data-reactid="4064"><!-- react-text: 4065 -->this<!-- /react-text --></span><!-- react-text: 4066 -->.response.redirect(<!-- /react-text --><span class="hljs-string" data-reactid="4067"><!-- react-text: 4068 -->&#x27;/profile&#x27;<!-- /react-text --></span><!-- react-text: 4069 -->);
  } <!-- /react-text --><span class="hljs-keyword" data-reactid="4070"><!-- react-text: 4071 -->catch<!-- /react-text --></span><!-- react-text: 4072 --> (err) {
    <!-- /react-text --><span class="hljs-comment" data-reactid="4073"><!-- react-text: 4074 -->//...handle sanitization, validation errors, etc...<!-- /react-text --></span><!-- react-text: 4075 -->
  }
};
<!-- /react-text --></code></pre><!-- react-text: 4076 -->
<!-- /react-text --><p data-reactid="4077"><!-- react-text: 4078 -->In the above controller method we only update the model data and persist it if
if has actually changed. Thus ‘dirty checking’ allows us to be efficient with
updates.<!-- /react-text --></p><!-- react-text: 4079 -->
<!-- /react-text --><h1 data-reactid="4080"><!-- react-text: 4081 -->Access Control<!-- /react-text --></h1><!-- react-text: 4082 -->
<!-- /react-text --><h1 data-reactid="4083"><!-- react-text: 4084 -->Admin dashboard<!-- /react-text --></h1><!-- react-text: 4085 -->
<!-- /react-text --><p data-reactid="4086"><!-- react-text: 4087 -->Waigo comes bundled with a basic administration interface. Once you have the default site running (as explained above) you should be able to visit <!-- /react-text --><code data-reactid="4088"><!-- react-text: 4089 -->/admin<!-- /react-text --></code><!-- react-text: 4090 --> in your browser. You will be prompted to login.<!-- /react-text --></p><!-- react-text: 4091 -->
<!-- /react-text --><p data-reactid="4092"><!-- react-text: 4093 -->Since you’ve just started the server for the first time you don’t yet have any user accounts. So choose to register one.<!-- /react-text --></p><!-- react-text: 4094 -->
<!-- /react-text --><p data-reactid="4095"><strong data-reactid="4096"><!-- react-text: 4097 -->The first user account you register is automatically given admin access rights, so that you can login to the administration interface<!-- /react-text --></strong><!-- react-text: 4098 -->.<!-- /react-text --></p><!-- react-text: 4099 -->
<!-- /react-text --><p data-reactid="4100"><!-- react-text: 4101 -->If you wish to grant admin access to other users in future you will need to <!-- /react-text --><a href="/docs/#access-control/" data-reactid="4102">assign the </a><!-- react-text: 4103 --> to those users manually.<!-- /react-text --></p><!-- react-text: 4104 -->
<!-- /react-text --><p data-reactid="4105"><!-- react-text: 4106 -->Once you’ve gained access to the admin dashboard you will be able to do things like test the app’s routes and enable/disable cron jobs.<!-- /react-text --></p><!-- react-text: 4107 -->
<!-- /react-text --><h2 data-reactid="4108"><!-- react-text: 4109 -->Customization<!-- /react-text --></h2><!-- react-text: 4110 -->
<!-- /react-text --><p data-reactid="4111"><!-- react-text: 4112 -->The admin dashboard layout (and particularly the nav menu) is auto-generated from the admin configuration. If you open up <!-- /react-text --><code data-reactid="4113"><!-- react-text: 4114 -->&lt;waigo npm module&gt;/src/config/base.js<!-- /react-text --></code><!-- react-text: 4115 --> you will see:<!-- /react-text --></p><!-- react-text: 4116 -->
<!-- /react-text --><pre data-reactid="4117"><code class="language-javascript hljs" data-reactid="4118"><!-- react-text: 4119 -->  config.adminMenu = [
    {
      label: <!-- /react-text --><span class="hljs-string" data-reactid="4120"><!-- react-text: 4121 -->&#x27;Dashboard&#x27;<!-- /react-text --></span><!-- react-text: 4122 -->,
      path: <!-- /react-text --><span class="hljs-string" data-reactid="4123"><!-- react-text: 4124 -->&#x27;/admin&#x27;<!-- /react-text --></span><!-- react-text: 4125 -->,
    },
    {
      label: <!-- /react-text --><span class="hljs-string" data-reactid="4126"><!-- react-text: 4127 -->&#x27;Routes&#x27;<!-- /react-text --></span><!-- react-text: 4128 -->,
      path: <!-- /react-text --><span class="hljs-string" data-reactid="4129"><!-- react-text: 4130 -->&#x27;/admin/routes&#x27;<!-- /react-text --></span><!-- react-text: 4131 -->,
      canAccess: <!-- /react-text --><span class="hljs-string" data-reactid="4132"><!-- react-text: 4133 -->&#x27;admin&#x27;<!-- /react-text --></span><!-- react-text: 4134 -->,
    },
    {
      label: <!-- /react-text --><span class="hljs-string" data-reactid="4135"><!-- react-text: 4136 -->&#x27;Cron tasks&#x27;<!-- /react-text --></span><!-- react-text: 4137 -->,
      path: <!-- /react-text --><span class="hljs-string" data-reactid="4138"><!-- react-text: 4139 -->&#x27;/admin/cron&#x27;<!-- /react-text --></span><!-- react-text: 4140 -->,
      canAccess: <!-- /react-text --><span class="hljs-string" data-reactid="4141"><!-- react-text: 4142 -->&#x27;admin&#x27;<!-- /react-text --></span><!-- react-text: 4143 -->,
    },
  ];
<!-- /react-text --></code></pre><!-- react-text: 4144 -->
<!-- /react-text --><p data-reactid="4145"><!-- react-text: 4146 -->Thus you can see how easy it is enable/disable specific modules and/or add your own with their own routing path.<!-- /react-text --></p><!-- react-text: 4147 -->
<!-- /react-text --><p data-reactid="4148"><!-- react-text: 4149 -->Note that if you specify your own URL paths you will need to ensure that they have the correct <!-- /react-text --><a href="/docs/#access-control/" data-reactid="4150">access</a><!-- react-text: 4151 --> permissions set on them. The default admin routes all fall under <!-- /react-text --><code data-reactid="4152"><!-- react-text: 4153 -->/admin<!-- /react-text --></code><!-- react-text: 4154 --> and are restricted to <!-- /react-text --><code data-reactid="4155"><!-- react-text: 4156 -->admin<!-- /react-text --></code><!-- react-text: 4157 --> users only, as you can see if you open up <!-- /react-text --><code data-reactid="4158"><!-- react-text: 4159 -->&lt;waigo npm module&gt;/src/routes/admin.js<!-- /react-text --></code><!-- react-text: 4160 -->:<!-- /react-text --></p><!-- react-text: 4161 -->
<!-- /react-text --><pre data-reactid="4162"><code class="language-javascript hljs" data-reactid="4163"><span class="hljs-built_in" data-reactid="4164"><!-- react-text: 4165 -->module<!-- /react-text --></span><!-- react-text: 4166 -->.exports = { 
  <!-- /react-text --><span class="hljs-string" data-reactid="4167"><!-- react-text: 4168 -->&#x27;/admin&#x27;<!-- /react-text --></span><!-- react-text: 4169 -->: {
    pre: [
      { 
        id: <!-- /react-text --><span class="hljs-string" data-reactid="4170"><!-- react-text: 4171 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 4172 -->, 
        redirectToLogin: <!-- /react-text --><span class="hljs-literal" data-reactid="4173"><!-- react-text: 4174 -->true<!-- /react-text --></span><!-- react-text: 4175 -->,
      },
      <!-- /react-text --><span class="hljs-string" data-reactid="4176"><!-- react-text: 4177 -->&#x27;admin.index.configureMenu&#x27;<!-- /react-text --></span><!-- react-text: 4178 -->,
    ],

    GET: <!-- /react-text --><span class="hljs-string" data-reactid="4179"><!-- react-text: 4180 -->&#x27;admin.index.main&#x27;<!-- /react-text --></span><!-- react-text: 4181 -->,

    <!-- /react-text --><span class="hljs-string" data-reactid="4182"><!-- react-text: 4183 -->&#x27;/routes&#x27;<!-- /react-text --></span><!-- react-text: 4184 -->: {
      pre: [
        { 
          id: <!-- /react-text --><span class="hljs-string" data-reactid="4185"><!-- react-text: 4186 -->&#x27;assertUser&#x27;<!-- /react-text --></span><!-- react-text: 4187 -->, 
          canAccess: <!-- /react-text --><span class="hljs-string" data-reactid="4188"><!-- react-text: 4189 -->&#x27;admin&#x27;<!-- /react-text --></span><!-- react-text: 4190 -->,
        },
      ],

      GET: <!-- /react-text --><span class="hljs-string" data-reactid="4191"><!-- react-text: 4192 -->&#x27;admin.routes.index&#x27;<!-- /react-text --></span><!-- react-text: 4193 -->
    },
...
<!-- /react-text --></code></pre><!-- react-text: 4194 -->
<!-- /react-text --><p data-reactid="4195"><!-- react-text: 4196 -->By overriding this file in your app you can change the admin routing permissions and/or disable admin access altogether.<!-- /react-text --></p><!-- react-text: 4197 -->
<!-- /react-text --><h1 data-reactid="4198"><!-- react-text: 4199 -->Logging<!-- /react-text --></h1><!-- react-text: 4200 -->
<!-- /react-text --><p data-reactid="4201"><!-- react-text: 4202 -->Waigo provides support for <!-- /react-text --><a href="https://github.com/flatiron/winston" data-reactid="4203"><!-- react-text: 4204 -->winston<!-- /react-text --></a><!-- react-text: 4205 --> by
default. The default Winston logging target (see <!-- /react-text --><code data-reactid="4206"><!-- react-text: 4207 -->config/base<!-- /react-text --></code><!-- react-text: 4208 -->) is the console.
All uncaught exceptions and <!-- /react-text --><code data-reactid="4209"><!-- react-text: 4210 -->error<!-- /react-text --></code><!-- react-text: 4211 --> events emitted on the koa app object get
logged in this way.<!-- /react-text --></p><!-- react-text: 4212 -->
<!-- /react-text --><p data-reactid="4213"><!-- react-text: 4214 -->You don’t have to use Winston - you can use any logging library you want. The
<!-- /react-text --><code data-reactid="4215"><!-- react-text: 4216 -->app.config.logging<!-- /react-text --></code><!-- react-text: 4217 --> configuration object both specifies the name of a logger
(to be loaded from the <!-- /react-text --><code data-reactid="4218"><!-- react-text: 4219 -->support/logging<!-- /react-text --></code><!-- react-text: 4220 --> path) and configuration to pass to that
logger.<!-- /react-text --></p><!-- react-text: 4221 -->
<!-- /react-text --><h1 data-reactid="4222"><!-- react-text: 4223 -->Errors<!-- /react-text --></h1><!-- react-text: 4224 -->
<!-- /react-text --><p data-reactid="4225"><!-- react-text: 4226 -->The <!-- /react-text --><code data-reactid="4227"><!-- react-text: 4228 -->support/middleware/errorHandler<!-- /react-text --></code><!-- react-text: 4229 --> middleware is responsible for handling all
errors which get thrown during the request handling process. Errors get logged
through the default logger as well as getting sent back to the client which made
the original request.<!-- /react-text --></p><!-- react-text: 4230 -->
<!-- /react-text --><h2 data-reactid="4231"><!-- react-text: 4232 -->RuntimeError<!-- /react-text --></h2><!-- react-text: 4233 -->
<!-- /react-text --><p data-reactid="4234"><!-- react-text: 4235 -->Waigo provides a base error class - <!-- /react-text --><code data-reactid="4236"><!-- react-text: 4237 -->RuntimeError<!-- /react-text --></code><!-- react-text: 4238 --> - which allows you to set a
HTTP status code along with the error message. This status code is used by the
error handling middleware when sending the final error response to the client:<!-- /react-text --></p><!-- react-text: 4239 -->
<!-- /react-text --><pre data-reactid="4240"><code class="language-javascript hljs" data-reactid="4241"><span class="hljs-comment" data-reactid="4242"><!-- react-text: 4243 -->// file: &lt;app folder&gt;/controllers/main.js<!-- /react-text --></span><!-- react-text: 4244 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="4245"><!-- react-text: 4246 -->var<!-- /react-text --></span><!-- react-text: 4247 --> waigo = <!-- /react-text --><span class="hljs-built_in" data-reactid="4248"><!-- react-text: 4249 -->require<!-- /react-text --></span><!-- react-text: 4250 -->(<!-- /react-text --><span class="hljs-string" data-reactid="4251"><!-- react-text: 4252 -->&#x27;waigo&#x27;<!-- /react-text --></span><!-- react-text: 4253 -->),
  errors = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="4254"><!-- react-text: 4255 -->&#x27;support/errors&#x27;<!-- /react-text --></span><!-- react-text: 4256 -->),
  RuntimeError = errors.RuntimeError;

exports.index = <!-- /react-text --><span class="hljs-function" data-reactid="4257"><span class="hljs-keyword" data-reactid="4258"><!-- react-text: 4259 -->function<!-- /react-text --></span><!-- react-text: 4260 -->*(<!-- /react-text --><span class="hljs-params" data-reactid="4261"><!-- react-text: 4262 -->next<!-- /react-text --></span><!-- react-text: 4263 -->) <!-- /react-text --></span><!-- react-text: 4264 -->{
  <!-- /react-text --><span class="hljs-keyword" data-reactid="4265"><!-- react-text: 4266 -->throw<!-- /react-text --></span><!-- react-text: 4267 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="4268"><!-- react-text: 4269 -->new<!-- /react-text --></span><!-- react-text: 4270 --> RuntimeError(<!-- /react-text --><span class="hljs-string" data-reactid="4271"><!-- react-text: 4272 -->&#x27;oh dear!&#x27;<!-- /react-text --></span><!-- react-text: 4273 -->, <!-- /react-text --><span class="hljs-number" data-reactid="4274"><!-- react-text: 4275 -->400<!-- /react-text --></span><!-- react-text: 4276 -->); <!-- /react-text --><span class="hljs-comment" data-reactid="4277"><!-- react-text: 4278 -->// 400 = bad request<!-- /react-text --></span><!-- react-text: 4279 -->
}
<!-- /react-text --></code></pre><!-- react-text: 4280 -->
<!-- /react-text --><p data-reactid="4281"><strong data-reactid="4282"><!-- react-text: 4283 -->Always try and use <!-- /react-text --><code data-reactid="4284"><!-- react-text: 4285 -->RuntimeError<!-- /react-text --></code><!-- react-text: 4286 --> insted of <!-- /react-text --><code data-reactid="4287"><!-- react-text: 4288 -->Error<!-- /react-text --></code><!-- react-text: 4289 --> as it provides for more
descriptive output.<!-- /react-text --></strong></p><!-- react-text: 4290 -->
<!-- /react-text --><p data-reactid="4291"><!-- react-text: 4292 -->A request handled by the above route handler would result in a HTTP status code
of 400 being returned to the client along with the error message:<!-- /react-text --></p><!-- react-text: 4293 -->
<!-- /react-text --><pre data-reactid="4294"><code class="language-javascript hljs" data-reactid="4295"><!-- react-text: 4296 -->{
  type: RuntimeError,
  msg: <!-- /react-text --><span class="hljs-string" data-reactid="4297"><!-- react-text: 4298 -->&#x27;oh dear!&#x27;<!-- /react-text --></span><!-- react-text: 4299 -->,
  stack: ....stack trace
}
<!-- /react-text --></code></pre><!-- react-text: 4300 -->
<!-- /react-text --><p data-reactid="4301"><em data-reactid="4302"><!-- react-text: 4303 -->Note: Stack traces only get sent to the client if the
<!-- /react-text --><code data-reactid="4304"><!-- react-text: 4305 -->app.config.errorHandler.showStack<!-- /react-text --></code><!-- react-text: 4306 --> flag is turned on.<!-- /react-text --></em></p><!-- react-text: 4307 -->
<!-- /react-text --><h2 data-reactid="4308"><!-- react-text: 4309 -->MultipleError<!-- /react-text --></h2><!-- react-text: 4310 -->
<!-- /react-text --><p data-reactid="4311"><!-- react-text: 4312 -->The <!-- /react-text --><code data-reactid="4313"><!-- react-text: 4314 -->MultipleError<!-- /react-text --></code><!-- react-text: 4315 --> class represents a group of related errors. It inherits from
<!-- /react-text --><code data-reactid="4316"><!-- react-text: 4317 -->RuntimeError<!-- /react-text --></code><!-- react-text: 4318 -->. As well as message and  status code its constructor also accepts
a collection of <!-- /react-text --><code data-reactid="4319"><!-- react-text: 4320 -->Error<!-- /react-text --></code><!-- react-text: 4321 --> objects.<!-- /react-text --></p><!-- react-text: 4322 -->
<!-- /react-text --><p data-reactid="4323"><!-- react-text: 4324 -->The view object representation of a <!-- /react-text --><code data-reactid="4325"><!-- react-text: 4326 -->MultipleError<!-- /react-text --></code><!-- react-text: 4327 --> includes the view object
representations of all of its encapsulated errors. For example, given:<!-- /react-text --></p><!-- react-text: 4328 -->
<!-- /react-text --><pre data-reactid="4329"><code class="language-javascript hljs" data-reactid="4330"><span class="hljs-keyword" data-reactid="4331"><!-- react-text: 4332 -->throw<!-- /react-text --></span><!-- react-text: 4333 --> <!-- /react-text --><span class="hljs-keyword" data-reactid="4334"><!-- react-text: 4335 -->new<!-- /react-text --></span><!-- react-text: 4336 --> MultipleError(<!-- /react-text --><span class="hljs-string" data-reactid="4337"><!-- react-text: 4338 -->&#x27;oh dear!&#x27;<!-- /react-text --></span><!-- react-text: 4339 -->, <!-- /react-text --><span class="hljs-number" data-reactid="4340"><!-- react-text: 4341 -->400<!-- /react-text --></span><!-- react-text: 4342 -->, {
  firstError: <!-- /react-text --><span class="hljs-keyword" data-reactid="4343"><!-- react-text: 4344 -->new<!-- /react-text --></span><!-- react-text: 4345 --> RuntimeError(<!-- /react-text --><span class="hljs-string" data-reactid="4346"><!-- react-text: 4347 -->&#x27;fail1&#x27;<!-- /react-text --></span><!-- react-text: 4348 -->),
  secondError: <!-- /react-text --><span class="hljs-keyword" data-reactid="4349"><!-- react-text: 4350 -->new<!-- /react-text --></span><!-- react-text: 4351 --> <!-- /react-text --><span class="hljs-built_in" data-reactid="4352"><!-- react-text: 4353 -->Error<!-- /react-text --></span><!-- react-text: 4354 -->(<!-- /react-text --><span class="hljs-string" data-reactid="4355"><!-- react-text: 4356 -->&#x27;test&#x27;<!-- /react-text --></span><!-- react-text: 4357 -->)
});
<!-- /react-text --></code></pre><!-- react-text: 4358 -->
<!-- /react-text --><p data-reactid="4359"><!-- react-text: 4360 -->The response to the client would look like:<!-- /react-text --></p><!-- react-text: 4361 -->
<!-- /react-text --><pre data-reactid="4362"><code class="language-javascript hljs" data-reactid="4363"><!-- react-text: 4364 -->{
  type: MultipleError,
  msg: <!-- /react-text --><span class="hljs-string" data-reactid="4365"><!-- react-text: 4366 -->&#x27;oh dear!&#x27;<!-- /react-text --></span><!-- react-text: 4367 -->,
  errors: {
    firstErrror: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="4368"><!-- react-text: 4369 -->&#x27;RuntimeError&#x27;<!-- /react-text --></span><!-- react-text: 4370 -->,
      msg: <!-- /react-text --><span class="hljs-string" data-reactid="4371"><!-- react-text: 4372 -->&#x27;fail1&#x27;<!-- /react-text --></span><!-- react-text: 4373 -->
    },
    secondError: {
      type: <!-- /react-text --><span class="hljs-string" data-reactid="4374"><!-- react-text: 4375 -->&#x27;Error&#x27;<!-- /react-text --></span><!-- react-text: 4376 -->,
      msg: <!-- /react-text --><span class="hljs-string" data-reactid="4377"><!-- react-text: 4378 -->&#x27;test&#x27;<!-- /react-text --></span><!-- react-text: 4379 -->
    } 
  }
}
<!-- /react-text --></code></pre><!-- react-text: 4380 -->
<!-- /react-text --><p data-reactid="4381"><em data-reactid="4382"><!-- react-text: 4383 -->Note: The <!-- /react-text --><a href="/docs/#validation/" data-reactid="4384">form and field validation error</a><!-- react-text: 4385 --> classes inherit from
<!-- /react-text --><code data-reactid="4386"><!-- react-text: 4387 -->MultipleError<!-- /react-text --></code><!-- react-text: 4388 -->.<!-- /react-text --></em></p><!-- react-text: 4389 -->
<!-- /react-text --><h2 data-reactid="4390"><!-- react-text: 4391 -->Custom errors<!-- /react-text --></h2><!-- react-text: 4392 -->
<!-- /react-text --><p data-reactid="4393"><!-- react-text: 4394 -->It is highly recommended that you define and use your own error classes as they
will allow you to better poinpoint the cause of errors. The <!-- /react-text --><code data-reactid="4395"><!-- react-text: 4396 -->support/errors<!-- /react-text --></code><!-- react-text: 4397 -->
module provides functionality to make this easy:<!-- /react-text --></p><!-- react-text: 4398 -->
<!-- /react-text --><pre data-reactid="4399"><code class="language-javascript hljs" data-reactid="4400"><span class="hljs-keyword" data-reactid="4401"><!-- react-text: 4402 -->var<!-- /react-text --></span><!-- react-text: 4403 --> errors = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="4404"><!-- react-text: 4405 -->&#x27;support/errors&#x27;<!-- /react-text --></span><!-- react-text: 4406 -->);

<!-- /react-text --><span class="hljs-keyword" data-reactid="4407"><!-- react-text: 4408 -->var<!-- /react-text --></span><!-- react-text: 4409 --> UserNotFound = errors.define(<!-- /react-text --><span class="hljs-string" data-reactid="4410"><!-- react-text: 4411 -->&#x27;FormValidationError&#x27;<!-- /react-text --></span><!-- react-text: 4412 -->);
<!-- /react-text --><span class="hljs-comment" data-reactid="4413"><!-- react-text: 4414 -->// UserNotFound inherits from RuntimeError<!-- /react-text --></span><!-- react-text: 4415 -->

...

throw UserNotFound(<!-- /react-text --><span class="hljs-string" data-reactid="4416"><!-- react-text: 4417 -->&#x27;...&#x27;<!-- /react-text --></span><!-- react-text: 4418 -->);
<!-- /react-text --></code></pre><!-- react-text: 4419 -->
<!-- /react-text --><p data-reactid="4420"><!-- react-text: 4421 -->The second parameter to the <!-- /react-text --><code data-reactid="4422"><!-- react-text: 4423 -->define()<!-- /react-text --></code><!-- react-text: 4424 --> call is the parent class to inherit
from. A custom error class can even inherit from another one:<!-- /react-text --></p><!-- react-text: 4425 -->
<!-- /react-text --><pre data-reactid="4426"><code class="language-javascript hljs" data-reactid="4427"><span class="hljs-keyword" data-reactid="4428"><!-- react-text: 4429 -->var<!-- /react-text --></span><!-- react-text: 4430 --> errors = waigo.load(<!-- /react-text --><span class="hljs-string" data-reactid="4431"><!-- react-text: 4432 -->&#x27;support/errors&#x27;<!-- /react-text --></span><!-- react-text: 4433 -->);

<!-- /react-text --><span class="hljs-keyword" data-reactid="4434"><!-- react-text: 4435 -->var<!-- /react-text --></span><!-- react-text: 4436 --> ProcessingErrors = errors.define(<!-- /react-text --><span class="hljs-string" data-reactid="4437"><!-- react-text: 4438 -->&#x27;ProcessingErrors&#x27;<!-- /react-text --></span><!-- react-text: 4439 -->, errors.MultipleError);
<!-- /react-text --><span class="hljs-comment" data-reactid="4440"><!-- react-text: 4441 -->// ProcessingErrors inherits from MultipleError<!-- /react-text --></span><!-- react-text: 4442 -->

<!-- /react-text --><span class="hljs-keyword" data-reactid="4443"><!-- react-text: 4444 -->var<!-- /react-text --></span><!-- react-text: 4445 --> ValidationErrors = errors.define(<!-- /react-text --><span class="hljs-string" data-reactid="4446"><!-- react-text: 4447 -->&#x27;ValidationErrors&#x27;<!-- /react-text --></span><!-- react-text: 4448 -->, ProcessingErrors);
<!-- /react-text --><span class="hljs-comment" data-reactid="4449"><!-- react-text: 4450 -->// ValidationErrors inherits from ProcessingErrors<!-- /react-text --></span><!-- react-text: 4451 -->
<!-- /react-text --></code></pre><!-- react-text: 4452 -->
<!-- /react-text --><p data-reactid="4453"><!-- react-text: 4454 -->To find out more about this and how you can configure it check out the <!-- /react-text --><a href="/docs/#scalable-clustering/" data-reactid="4455">Scalable Clustering</a><!-- react-text: 4456 --> section of this guide.<!-- /react-text --></p><!-- react-text: 4457 -->
<!-- /react-text --><h1 data-reactid="4458"><!-- react-text: 4459 -->Scalable clustering<!-- /react-text --></h1><!-- react-text: 4460 -->
<!-- /react-text --><p data-reactid="4461"><!-- react-text: 4462 -->Clustering enables you to better scale your application on a single server by having dividing up your app’s workload amongst multiple processes.<!-- /react-text --></p><!-- react-text: 4463 -->
<!-- /react-text --><p data-reactid="4464"><!-- react-text: 4465 -->Waigo supports <!-- /react-text --><a href="https://nodejs.org/api/cluster.html" data-reactid="4466"><!-- react-text: 4467 -->Node’s built-in clustering<!-- /react-text --></a><!-- react-text: 4468 --> mechanim. By default Waigo will only launch 1 worker process to handle requests. But you can tell it launch more than 1 or as many workers as there as cores in your CPU.<!-- /react-text --></p><!-- react-text: 4469 -->
<!-- /react-text --><p data-reactid="4470"><!-- react-text: 4471 -->For example, to have Waigo launch 2 worker processes:<!-- /react-text --></p><!-- react-text: 4472 -->
<!-- /react-text --><pre data-reactid="4473"><code class="language-bash hljs" data-reactid="4474"><!-- react-text: 4475 -->$ WAIGO_WORKERS=3 ./start-app.js
<!-- /react-text --></code></pre><!-- react-text: 4476 -->
<!-- /react-text --><p data-reactid="4477"><!-- react-text: 4478 -->During the startup phase you may see what look like repeated logs. However, every log line is prefixed with the pid of the specific worker doing the logging:<!-- /react-text --></p><!-- react-text: 4479 -->
<!-- /react-text --><pre data-reactid="4480"><code class="language-bash hljs" data-reactid="4481"><!-- react-text: 4482 -->No. of worker processes: 3
[worker1] started, pid: 78163
[worker2] started, pid: 78164
[worker3] started, pid: 78166
...
(RamMacbookPro.local-78164) [2016-04-06 11:01:41.413] [INFO] [app] - Startup complete
(RamMacbookPro.local-78166) [2016-04-06 11:01:41.438] [INFO] [app] - Startup complete
(RamMacbookPro.local-78163) [2016-04-06 11:01:41.450] [INFO] [app] - Startup complete
<!-- /react-text --></code></pre><!-- react-text: 4483 -->
<!-- /react-text --><p data-reactid="4484"><!-- react-text: 4485 -->You can also tell Waigo to launch as many worker processes as there are CPUs on your machine:<!-- /react-text --></p><!-- react-text: 4486 -->
<!-- /react-text --><pre data-reactid="4487"><code class="language-bash hljs" data-reactid="4488"><!-- react-text: 4489 -->$ WAIGO_WORKERS=MAX_CPUS ./start-app.js
<!-- /react-text --></code></pre><!-- react-text: 4490 -->
<!-- /react-text --><p data-reactid="4491"><!-- react-text: 4492 -->Clustering has implications for how you structure your application. When a frontend client requests a backend resource it does not know which specific worker process will serve it.<!-- /react-text --></p><!-- react-text: 4493 -->
<!-- /react-text --><p data-reactid="4494"><!-- react-text: 4495 -->Thus, <!-- /react-text --><strong data-reactid="4496"><!-- react-text: 4497 -->application-level data should not be stored within the Node.js worker process, but within an externally accessible datasource instead, e.g. the database.<!-- /react-text --></strong></p><!-- react-text: 4498 -->
<!-- /react-text --><p data-reactid="4499"><!-- react-text: 4500 -->If you adhere to this rule you will be able to easily scale your application and even have instances of it running on other servers without there being any problems.<!-- /react-text --></p><!-- react-text: 4501 -->
<!-- /react-text --><h1 data-reactid="4502"><!-- react-text: 4503 -->Debugging<!-- /react-text --></h1><!-- react-text: 4504 -->
<!-- /react-text --><p data-reactid="4505"><!-- react-text: 4506 -->In order to fix a problem it’s sometimes useful to know what’s going on inside the framework.<!-- /react-text --></p><!-- react-text: 4507 -->
<!-- /react-text --><p data-reactid="4508"><!-- react-text: 4509 -->Waigo makes use of the <!-- /react-text --><a href="https://github.com/visionmedia/debug" data-reactid="4510"><!-- react-text: 4511 -->debug<!-- /react-text --></a><!-- react-text: 4512 --> utility
internally in some parts. For instance, to debug the  <!-- /react-text --><a href="/docs/#extend-and-override/" data-reactid="4513">loading system</a><!-- react-text: 4514 -->
run your app with the <!-- /react-text --><code data-reactid="4515"><!-- react-text: 4516 -->DEBUG<!-- /react-text --></code><!-- react-text: 4517 --> environment variable as follows:<!-- /react-text --></p><!-- react-text: 4518 -->
<!-- /react-text --><pre data-reactid="4519"><code class="language-bash hljs" data-reactid="4520"><!-- react-text: 4521 -->$ DEBUG=waigo-loader node --harmony app.js
  waigo-loader Getting plugin names... +0ms
  waigo-loader Plugins to load:  +15ms
  waigo-loader Module <!-- /react-text --><span class="hljs-string" data-reactid="4522"><!-- react-text: 4523 -->&quot;routes&quot;<!-- /react-text --></span><!-- react-text: 4524 --> will be loaded from <!-- /react-text --><span class="hljs-built_in" data-reactid="4525"><!-- react-text: 4526 -->source<!-- /react-text --></span><!-- react-text: 4527 --> <!-- /react-text --><span class="hljs-string" data-reactid="4528"><!-- react-text: 4529 -->&quot;waigo&quot;<!-- /react-text --></span><!-- react-text: 4530 --> +10ms
  waigo-loader Module <!-- /react-text --><span class="hljs-string" data-reactid="4531"><!-- react-text: 4532 -->&quot;server&quot;<!-- /react-text --></span><!-- react-text: 4533 --> will be loaded from <!-- /react-text --><span class="hljs-built_in" data-reactid="4534"><!-- react-text: 4535 -->source<!-- /react-text --></span><!-- react-text: 4536 --> <!-- /react-text --><span class="hljs-string" data-reactid="4537"><!-- react-text: 4538 -->&quot;waigo&quot;<!-- /react-text --></span><!-- react-text: 4539 --> +0ms
  waigo-loader Module <!-- /react-text --><span class="hljs-string" data-reactid="4540"><!-- react-text: 4541 -->&quot;config/base&quot;<!-- /react-text --></span><!-- react-text: 4542 --> will be loaded from <!-- /react-text --><span class="hljs-built_in" data-reactid="4543"><!-- react-text: 4544 -->source<!-- /react-text --></span><!-- react-text: 4545 --> <!-- /react-text --><span class="hljs-string" data-reactid="4546"><!-- react-text: 4547 -->&quot;waigo&quot;<!-- /react-text --></span><!-- react-text: 4548 --> +0ms
  ...
  waigo-loader Loading module <!-- /react-text --><span class="hljs-string" data-reactid="4549"><!-- react-text: 4550 -->&quot;server&quot;<!-- /react-text --></span><!-- react-text: 4551 --> from <!-- /react-text --><span class="hljs-built_in" data-reactid="4552"><!-- react-text: 4553 -->source<!-- /react-text --></span><!-- react-text: 4554 --> <!-- /react-text --><span class="hljs-string" data-reactid="4555"><!-- react-text: 4556 -->&quot;waigo&quot;<!-- /react-text --></span><!-- react-text: 4557 --> +0ms
  ...
<!-- /react-text --></code></pre><!-- react-text: 4558 -->
<!-- /react-text --><h1 data-reactid="4559"><!-- react-text: 4560 -->Roadmap<!-- /react-text --></h1><!-- react-text: 4561 -->
<!-- /react-text --><p data-reactid="4562"><!-- react-text: 4563 -->See the <!-- /react-text --><a href="https://github.com/waigo/waigo/issues" data-reactid="4564"><!-- react-text: 4565 -->Github issue queue<!-- /react-text --></a><!-- react-text: 4566 -->.<!-- /react-text --></p><!-- react-text: 4567 -->
<!-- /react-text --><h1 data-reactid="4568"><!-- react-text: 4569 -->Contributing<!-- /react-text --></h1><!-- react-text: 4570 -->
<!-- /react-text --><p data-reactid="4571"><!-- react-text: 4572 -->Suggestions, bug reports and pull requests are welcome. Please see <!-- /react-text --><a href="https://github.com/waigo/waigo/blob/master/contributing/" data-reactid="4573"><!-- react-text: 4574 -->CONTRIBUTING.md<!-- /react-text --></a><!-- react-text: 4575 --> for guidelines.<!-- /react-text --></p><!-- react-text: 4576 -->
<!-- /react-text --><h1 data-reactid="4577"><!-- react-text: 4578 -->License<!-- /react-text --></h1><!-- react-text: 4579 -->
<!-- /react-text --><p data-reactid="4580"><!-- react-text: 4581 -->MIT - see <!-- /react-text --><a href="https://github.com/waigo/waigo/blob/master/license/" data-reactid="4582"><!-- react-text: 4583 -->LICENSE.md<!-- /react-text --></a></p><!-- react-text: 4584 -->
<!-- /react-text --></div><div class="prev-next" data-reactid="4585"><a class="next" href="/docs/introduction/" data-reactid="4586"><!-- react-text: 4587 -->Introduction<!-- /react-text --><!-- react-text: 4588 --> »<!-- /react-text --></a></div></div></section></main><footer data-reactid="4589"><p class="tagline quoted" data-reactid="4590">Node.js ES6 framework for reactive, data-driven apps and APIs</p><div class="credits" data-reactid="4591"><!-- react-text: 4592 -->Icons made by <!-- /react-text --><a href="http://www.freepik.com" title="Freepik" data-reactid="4593">Freepik</a><!-- react-text: 4594 --> from <!-- /react-text --><a href="http://www.flaticon.com" title="Flaticon" data-reactid="4595">www.flaticon.com</a><!-- react-text: 4596 --> is licensed by <!-- /react-text --><a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank" data-reactid="4597">CC 3.0 BY</a></div><div class="social" data-reactid="4598"><a title="Github" href="https://github.com/waigo/waigo" data-reactid="4599"><i class="github" data-reactid="4600"></i></a><a title="Twitter" href="https://twitter.com/waigojs" data-reactid="4601"><i class="twitter" data-reactid="4602"></i></a><a title="discuss" href="https://discord.gg/Jf3pGjf" data-reactid="4603"><i class="discuss" data-reactid="4604"></i></a></div></footer></div></div><script src="/bundle.js?t=1472455401491"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-11640584-17', 'auto');
            ga('send', 'pageview');
          </script></body></html>